import{a_ as z,b9 as _,b1 as j,bY as ne,b4 as a,bk as le,b0 as re,a$ as ce,bz as ie,b8 as de,bh as ue,ba as u,bb as V,b3 as k,aX as r,b2 as F,aT as c,bi as B,aW as m,bj as me,bf as _e,aY as pe,bD as be,bd as U,aS as C,aV as A,aU as R,bo as fe,bp as ge,be as ye,bw as ve}from"./DzF9i0mN.js";import{_ as ke}from"./KePxBTxk.js";import{a as q}from"./BD0l2zRg.js";import{_ as Ie}from"./C8PTZDF_.js";import{_ as we}from"./DL44xRwP.js";import{_ as xe}from"./DGnbXaoB.js";import"./BFE2X4wh.js";import"./BcFV6CcW.js";(function(){try{var i=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p=new i.Error().stack;p&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[p]="0487c53f-d0a9-4703-82cf-bfa4c691d383",i._sentryDebugIdIdentifier="sentry-dbid-0487c53f-d0a9-4703-82cf-bfa4c691d383")}catch{}})();const he=z({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(i){const p=q(),g=i,s=_(!1);return j(async()=>{try{s.value=!0,await p.lazyFetchClassMetadataById(g.classId)}catch{}finally{s.value=!1}}),(I,T)=>ne(I.$slots,"default",{isLoading:a(s)})}}),Le={key:0,class:"flex justify-between items-center w-full"},Se={class:"flex gap-2 items-center"},Ue={class:"text-sm leading-5"},Ce={class:"flex gap-1"},Te={key:1,class:"max-w-xs truncate"},Fe=z({__name:"index",setup(i){const p=le(),g=re(),{t:s}=ce(),I=ie(),T=q(),{listingList:$,moderatedBookList:D,token:E}=de(I),{lazyFetchClassMetadataById:Y}=T,{fetchBookListing:W,fetchModeratedBookList:X}=I,w=_(""),M=_(!1);ue({title:()=>s("seo_titles.book_listing_management"),ogTitle:()=>s("seo_titles.book_listing_management")});const x=u(()=>[{label:s("bookstore.current_listing"),key:"current"},{label:s("bookstore.viewable_listing"),key:"viewable"}]),y=u({get(){const e=x.value.findIndex(t=>t.key===p.query.tab);return e===-1?0:e},set(e){F(g({query:{tab:x.value[e].key}}),{replace:!0})}}),b=_(""),h=_({column:"pendingAction",direction:"desc"}),f=_(50),l=_(1),G=u(()=>(l.value-1)*f.value+1),H=u(()=>Math.min(l.value*f.value,v.value.length)),v=u(()=>(x.value[y.value].key==="viewable"?D:$).value.map(e=>{var t,o,d;return{classId:e.classId,className:(t=T.getClassMetadataById(e.classId))==null?void 0:t.name,priceInUSD:(o=e.prices)==null?void 0:o[0].price,prices:(d=e.prices)==null?void 0:d.map(N=>N.price),pendingAction:e.pendingNFTCount,sold:e.sold}}).filter(e=>{if(!b.value)return!0;const t=b.value.toLowerCase();return e.classId.toLowerCase().includes(t)||e.className.toLowerCase().includes(t)})),J=u(()=>{const{column:e,direction:t}=h.value;return v.value.sort((o,d)=>o[e]<d[e]?t==="asc"?-1:1:o[e]>d[e]?t==="asc"?1:-1:0)}),K=u(()=>J.value.slice((l.value-1)*f.value,l.value*f.value)),O=u(()=>[{key:"pendingAction",label:s("table.pending_action"),sortable:!0},{key:"className",label:s("table.class_name"),sortable:!0},{key:"priceInUSD",label:s("table.price_in_usd"),sortable:!0},{key:"sold",label:s("table.sold"),sortable:!0},{key:"classId",label:s("bookstore.class_id"),sortable:!0,class:"font-mono"}]);V(M,e=>{e&&(w.value="")}),V(y,()=>{b.value="",l.value=1}),V(f,()=>{l.value=1}),j(async()=>{const e=[W()];E.value&&e.push(X()),await Promise.all(e),new Set($.value.map(o=>o.classId).concat(D.value.map(o=>o.classId))).forEach(o=>Y(o))});async function Q(e){await F(g({name:"my-books-status-classId",params:{classId:e.classId}}))}return(e,t)=>{const o=me,d=_e,N=ke,Z=ve,ee=ye,te=he,ae=Ie,P=be,se=we,oe=xe;return c(),k(oe,{ui:{constrained:""}},{default:r(()=>[a(w)?(c(),k(o,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${a(w)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:t[0]||(t[0]=L=>w.value="")},null,8,["title"])):B("",!0),a(M)?(c(),k(d,{key:1,animation:"carousel"},{indicator:r(()=>t[5]||(t[5]=[pe(" Loading... ")])),_:1})):B("",!0),m(P,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:r(()=>[m(se,{modelValue:a(y),"onUpdate:modelValue":t[4]||(t[4]=L=>U(y)?y.value=L:null),class:"w-full",items:a(x)},{item:r(({item:L})=>[(c(),k(P,{key:L.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:r(()=>[a(v).length>0?(c(),C("div",Le,[R("div",Se,[m(N,{modelValue:a(l),"onUpdate:modelValue":t[1]||(t[1]=n=>U(l)?l.value=n:null),"page-count":a(f),total:a(v).length},null,8,["modelValue","page-count","total"]),R("span",Ue,A(a(s)("table.showing_rows",{from:a(G),to:a(H),total:a(v).length})),1)]),m(Z,{modelValue:a(b),"onUpdate:modelValue":t[2]||(t[2]=n=>U(b)?b.value=n:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:a(s)("table.search_placeholder")},null,8,["modelValue","placeholder"])])):B("",!0)]),default:r(()=>[m(ae,{sort:a(h),"onUpdate:sort":t[3]||(t[3]=n=>U(h)?h.value=n:null),columns:a(O),rows:a(K),onSelect:Q},{"priceInUSD-data":r(({row:n})=>[R("ul",Ce,[(c(!0),C(fe,null,ge(n.prices,S=>(c(),C("li",{key:S},[m(ee,{label:`$${S}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":r(({row:n})=>[m(te,{"class-id":n.classId},{default:r(({isLoading:S})=>[S||!n.className?(c(),k(d,{key:0})):(c(),C("div",Te,A(n.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})}}});export{Fe as default};
