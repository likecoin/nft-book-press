import{n as Te,Q as De,P as Me,a0 as Ne,R as oe,I as Ee,r as s,s as L,x as Be,h as Re,v as Fe,o as _,A as P,w as a,a2 as Oe,a3 as We,a4 as Le,B as o,J as A,d as T,c as K,b as l,a as u,C as f,a5 as ze,a6 as z,a7 as $e,U as je,F as qe,X as Ge,a1 as He,G as Ke,M as Xe,a8 as Ze,_ as Je}from"./7W2dTFM9.js";import{_ as Qe,a as Ye}from"./DcCKZ0gr.js";import{_ as eo}from"./q_AchKhl.js";import{_ as oo}from"./Cr9amE6a.js";import{_ as lo}from"./BHCFj9Va.js";import{j as to,u as ao,p as no,_ as so}from"./BEWBTp-T.js";import{_ as io}from"./CWtRyVT2.js";import{_ as uo}from"./Ce3nixNH.js";import{_ as ro}from"./CiAUNY_4.js";import{_ as mo,a as co,b as po}from"./BhkvOjzb.js";import{u as fo}from"./CbHf2xqi.js";import{u as bo}from"./sSpWtsdi.js";import"./CFvGhW1g.js";import"./CiR6rCLI.js";import"./D4BM82id.js";import"./CD1bk2vG.js";import"./BELORIs0.js";(function(){try{var C=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D=new Error().stack;D&&(C._sentryDebugIds=C._sentryDebugIds||{},C._sentryDebugIds[D]="8d954d8a-f5d1-43bf-9ace-a152bd26f781",C._sentryDebugIdIdentifier="sentry-dbid-8d954d8a-f5d1-43bf-9ace-a152bd26f781")}catch{}})();const vo={class:"flex items-start gap-[12px] w-full px-[12px] mb-[12px]"},yo=["src"],go={class:"flex gap-2"},_o={class:"flex justify-end items-center"},ho={class:"flex justify-between items-center w-full"},wo={key:0,class:"mt-[24px] flex flex-col gap-[12px]"},xo={class:"flex gap-2"},ko={class:"flex justify-end items-center"},Co={class:"grid md:grid-cols-2 gap-4"},Vo=Te({__name:"new",setup(C){const D=De(),X=Me(),le=Ne(),te=fo(),Z=bo(),{wallet:V}=oe(D),{newNFTBookCollection:ae}=le,{getClassMetadataById:ne,lazyFetchClassMetadataById:J}=te,{fetchStripeConnectStatusByWallet:se}=Z,{getStripeConnectStatusByWallet:ie}=oe(Z),ue=Ee(),h=s(""),v=s(!1),re=s({en:"Collection description in English...",zh:"套裝中文描述..."}),de=s("New Book Collection Name"),M=s("新書集名稱"),me=s(""),N=s(""),w=s(""),m=s(""),x=s([]),i=s({price:Oe,stock:We,hasShipping:!1,isPhysicalOnly:!1,isAllowCustomPrice:!0,isUnlisted:!1,deliveryMethod:"auto",autoMemo:"Thank you for your support. It means a lot to me."}),k=s([]),E=s([]),B=s([]),c=s(""),p=s(""),R=s(!0),F=s(!1),O=s(!1),U=s(!1),S=s(""),$=s(!1),j=s(!0),ce=["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"],pe=L(()=>"Submit"),fe=L(()=>[{key:"wallet",label:"Wallet",sortable:!0},{key:"remove",label:"",sortable:!1}]),be=L(()=>E.value.map((n,e)=>({index:e,wallet:n,walletLink:Le(n)}))),ve=L(()=>B.value.map((n,e)=>({index:e,email:n})));to({markdownItConfig(n){n.options.html=!1}}),Be(async()=>{try{if(v.value=!0,V.value){try{await se(V.value)}catch(n){console.error(n)}ie.value(V.value).isReady&&(U.value=!0,S.value=V.value)}}catch(n){console.error(n)}finally{v.value=!1}}),Re(v,n=>{n&&(h.value="")}),Fe({title:"New Book Collection",ogTitle:"New Book Collection"});function ye(n){Number(n.data)===0&&(i.value.isAllowCustomPrice=!0)}function ge(){if(m.value){if(x.value.includes(m.value)){h.value="Class ID already exists";return}if(!m.value.startsWith("0x")){h.value="Invalid Class ID";return}x.value.push(m.value),J(m.value),m.value=""}}function _e(n){k.value=n}function he(){c.value&&(E.value.push(c.value),c.value="")}function we(){p.value&&(B.value.push(p.value),p.value="")}function xe(n){S.value=n,$.value=!0}function ke(n){return{priceInDecimal:Math.round(Number(n.price)*100),stock:Number(n.stock),hasShipping:!!(n.hasShipping||k.value.length),isPhysicalOnly:!!n.isPhysicalOnly,isAllowCustomPrice:!!(n.isAllowCustomPrice??!0),isUnlisted:!!(n.isUnlisted??!1),isAutoDeliver:!n.isPhysicalOnly&&n.deliveryMethod==="auto",autoMemo:n.autoMemo}}function Q(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ce(n){return no.sanitize(n)}async function Ve(){try{if(m.value)throw new Error('Please press "Add" button to add NFT class ID');if(!x.value.length)throw new Error('Please press "Add" button to add NFT class ID');if(c.value)throw new Error('Please press "Add" button to add moderator wallet');if(p.value)throw new Error('Please press "Add" button to add notification email');if(v.value=!0,await Promise.all(x.value.map(async y=>{const r=(await J(y)).nft_meta_collection_id||"";if(!r.includes("nft_book")&&!r.includes("book_nft"))throw new Error("NFT Class not in NFT BOOK meta collection")})),Number(i.value.price)!==0&&i.value.price<z)throw new Error(`Price of each edition must be at least $${z} or $0 (free)`);const n=U.value&&S.value?{[S.value]:100}:null,e=k.value.length?k.value.map(y=>({name:{en:y.name.en,zh:y.name.zh},priceInDecimal:Math.round(Number(y.price)*100),price:Number(y.price)})):void 0,q=ke(i.value);await ae({classIds:x.value,defaultPaymentCurrency:"USD",connectedWallets:n,moderatorWallets:E.value,notificationEmails:B.value,shippingRates:e,name:{en:de.value,zh:M.value},description:{en:Q(me.value),zh:Q(N.value)},image:w.value,hideDownload:F.value,mustClaimToView:R.value,...q}),ue.push({name:"nft-book-store-collection"})}catch(n){const e=n.data||n;console.error(e),h.value=e}finally{$.value=!1,v.value=!1}}function Ue(){return Ve()}return(n,e)=>{const q=Ge,y=He,W=Qe,r=eo,b=Ke,g=Xe,d=oo,Se=lo,G=Ze,H=so,I=Ye,Y=io,Ie=uo,Pe=ro;return _(),P(Pe,null,{default:a(()=>[o(h)?(_(),P(q,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${o(h)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:e[0]||(e[0]=t=>h.value="")},null,8,["title"])):A("",!0),o(v)?(_(),P(y,{key:1,animation:"carousel"},{indicator:a(()=>e[20]||(e[20]=[T(" Loading... ")])),_:1})):A("",!0),o(X).isAuthenticated?(_(),K(qe,{key:2},[l(g,{ui:{body:{base:"space-y-4"}}},{header:a(()=>e[21]||(e[21]=[u("h2",{class:"font-bold font-mono"}," New Book Collection Info ",-1)])),default:a(()=>[l(d,{label:"Books in Collection"},{default:a(()=>[l(g,{ui:{body:{padding:""}}},{default:a(()=>[l(W,{columns:[{key:"classId",label:"Class ID"},{key:"name",label:"Book Name"}],rows:o(x).map((t,Ae)=>{var ee;return{index:Ae,classId:t,name:(ee=o(ne)(t))==null?void 0:ee.name}})},null,8,["rows"]),u("div",vo,[l(r,{modelValue:o(m),"onUpdate:modelValue":e[1]||(e[1]=t=>f(m)?m.value=t:null),class:"font-mono w-full",placeholder:"0x...."},null,8,["modelValue"]),l(b,{onClick:ge},{default:a(()=>e[22]||(e[22]=[T(" Add ")])),_:1})])]),_:1})]),_:1}),l(d,{label:"Total number of packages available for sale"},{default:a(()=>[l(r,{modelValue:o(i).stock,"onUpdate:modelValue":e[2]||(e[2]=t=>o(i).stock=t),type:"number",step:"1",min:0,max:o(ze)},null,8,["modelValue","max"])]),_:1})]),_:1}),l(g,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[23]||(e[23]=[u("h3",{class:"font-bold font-mono"}," Pricing and Availability ",-1)])),default:a(()=>[l(d,{label:`Price(USD) of this collection (Minimal ${o(z)} or $0 (free)) / 版本定價（美金）`},{default:a(()=>[l(r,{modelValue:o(i).price,"onUpdate:modelValue":e[3]||(e[3]=t=>o(i).price=t),type:"number",step:"0.01",min:o(z),onInput:ye},null,8,["modelValue","min"])]),_:1},8,["label"]),l(Se,{modelValue:o(i).deliveryMethod,"onUpdate:modelValue":e[4]||(e[4]=t=>o(i).deliveryMethod=t),disabled:o(i).isPhysicalOnly,legend:"Delivery method of this collection / 自動或手動發書",options:o($e)},null,8,["modelValue","disabled","options"]),o(i).deliveryMethod==="auto"?(_(),P(d,{key:0},{label:a(()=>[e[25]||(e[25]=T(" Memo of this collection / 自動發書留言 ")),l(H,null,{image:a(()=>e[24]||(e[24]=[u("img",{src:mo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(G,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(r,{modelValue:o(i).autoMemo,"onUpdate:modelValue":e[5]||(e[5]=t=>o(i).autoMemo=t)},null,8,["modelValue"])]),_:1})):(_(),P(d,{key:1,label:"Is Physical only good / 只含實體書",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(I,{modelValue:o(i).isPhysicalOnly,"onUpdate:modelValue":e[6]||(e[6]=t=>o(i).isPhysicalOnly=t),name:"isPhysicalOnly",label:"This collection does not contain any digital file/NFT"},null,8,["modelValue"])]),_:1})),l(d,null,{label:a(()=>[e[27]||(e[27]=T(" Allow custom price / 開啟打賞功能 ")),l(H,{"image-style":{width:"300px"}},{image:a(()=>e[26]||(e[26]=[u("img",{src:co,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(G,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(I,{modelValue:o(i).isAllowCustomPrice,"onUpdate:modelValue":e[7]||(e[7]=t=>o(i).isAllowCustomPrice=t),name:"isAllowCustomPrice",label:"Allow user to pay more than defined price"},null,8,["modelValue"])]),_:1}),l(d,{label:"Unlist Edition / 暫時下架"},{default:a(()=>[l(I,{modelValue:o(i).isUnlisted,"onUpdate:modelValue":e[8]||(e[8]=t=>o(i).isUnlisted=t),name:"isUnlisted",label:"Pause selling of this Edition"},null,8,["modelValue"])]),_:1})]),_:1}),l(g,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[28]||(e[28]=[u("h3",{class:"font-bold font-mono"}," Product Information ",-1)])),default:a(()=>[l(d,{ui:{container:"space-y-2 my-[20px]"}},{label:a(()=>[e[30]||(e[30]=T(" 產品名稱（中文） ")),l(H,{"image-style":{width:"250px"}},{image:a(()=>e[29]||(e[29]=[u("img",{src:po,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(G,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(r,{modelValue:o(M),"onUpdate:modelValue":e[9]||(e[9]=t=>f(M)?M.value=t:null),placeholder:"產品中文名字"},null,8,["modelValue"]),e[31]||(e[31]=u("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),l(o(ao),{modelValue:o(N),"onUpdate:modelValue":e[10]||(e[10]=t=>f(N)?N.value=t:null),language:"en-US","editor-id":"zh",placeholder:o(re).zh,toolbars:ce,sanitize:Ce,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder"])]),_:1}),l(d,{label:"Image of this book collection",ui:{container:"space-y-2"}},{default:a(()=>[l(r,{modelValue:o(w),"onUpdate:modelValue":e[11]||(e[11]=t=>f(w)?w.value=t:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),o(w)?(_(),K("img",{key:0,src:o(je)(o(w)),class:"w-1/3"},null,8,yo)):A("",!0)]),_:1}),l(Y,{modelValue:o(i).hasShipping,"onUpdate:modelValue":e[12]||(e[12]=t=>o(i).hasShipping=t),"is-show-physical-goods-checkbox":!0,"is-show-setting-modal-button":!0,"shipping-info":o(k)},null,8,["modelValue","shipping-info"])]),_:1}),l(Ie,{"is-stripe-connect-checked":o(U),"onUpdate:isStripeConnectChecked":e[13]||(e[13]=t=>f(U)?U.value=t:null),"is-using-default-account":o(j),"onUpdate:isUsingDefaultAccount":e[14]||(e[14]=t=>f(j)?j.value=t:null),"stripe-connect-wallet":o(S),"should-disable-setting":o($),"login-address":o(V),onSave:xe},null,8,["is-stripe-connect-checked","is-using-default-account","stripe-connect-wallet","should-disable-setting","login-address"]),l(g,{ui:{header:{base:"flex justify-between items-center"},body:{padding:""}}},{header:a(()=>[e[32]||(e[32]=u("h4",{class:"text-sm font-bold font-mono"}," Email to receive sales notifications / 欲收到銷售通知的電郵 ",-1)),u("div",go,[l(r,{modelValue:o(p),"onUpdate:modelValue":e[15]||(e[15]=t=>f(p)?p.value=t:null),placeholder:"abc@example.com"},null,8,["modelValue"]),l(b,{label:"Add",variant:o(p)?"outline":"solid",color:o(p)?"primary":"gray",disabled:!o(p),onClick:we},null,8,["variant","color","disabled"])])]),default:a(()=>[l(W,{columns:[{key:"email",label:"Email",sortable:!0},{key:"action"}],rows:o(ve)},{"email-data":a(({row:t})=>[l(b,{label:t.email,to:`mailto:${t.email}`,variant:"link",padded:!1},null,8,["label","to"])]),"action-data":a(({row:t})=>[u("div",_o,[l(b,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(B).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["rows"])]),_:1}),l(g,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"12px"}}},{default:a(()=>[u("div",ho,[e[33]||(e[33]=u("h3",{class:"font-bold font-mono"}," Advanced Settings ",-1)),l(b,{color:"gray",variant:"ghost",icon:o(O)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:e[16]||(e[16]=()=>{O.value=!o(O)})},null,8,["icon"])]),o(O)?(_(),K("div",wo,[l(Y,{"is-show-physical-goods-checkbox":!1,"shipping-info":o(k),"is-show-setting-modal-button":!0,onUpdateShippingRates:_e},{header:a(()=>e[34]||(e[34]=[u("span",{class:"text-[14px] text-gray-500"}," (Includes physical good that requires shipping) ",-1)])),_:1},8,["shipping-info"]),l(g,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"",base:"space-y-8"}}},{header:a(()=>[e[35]||(e[35]=u("h4",{class:"text-sm font-bold font-mono"}," Share sales data to wallets / 分享銷售數據給特定地址 ",-1)),u("div",xo,[l(r,{modelValue:o(c),"onUpdate:modelValue":e[17]||(e[17]=t=>f(c)?c.value=t:null),class:"font-mono",placeholder:"0x..."},null,8,["modelValue"]),l(b,{label:"Add",variant:o(c)?"outline":"solid",color:o(c)?"primary":"gray",disabled:!o(c),onClick:he},null,8,["variant","color","disabled"])])]),default:a(()=>[l(W,{columns:o(fe),rows:o(be)},{"wallet-data":a(({row:t})=>[l(b,{class:"font-mono",label:t.wallet,to:t.walletLink,variant:"link",padded:!1},null,8,["label","to"])]),"remove-data":a(({row:t})=>[u("div",ko,[l(b,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(E).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(g,{ui:{body:{base:"space-y-8"}}},{header:a(()=>e[36]||(e[36]=[u("h3",{class:"font-bold font-mono"}," DRM Options / 數位版權管理選項 ",-1)])),default:a(()=>[u("div",Co,[l(d,{label:"Force NFT claim before view",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(I,{modelValue:o(R),"onUpdate:modelValue":e[18]||(e[18]=t=>f(R)?R.value=t:null),name:"mustClaimToView",label:"Must claim NFT to view"},null,8,["modelValue"])]),_:1}),l(d,{label:"Disable File Download",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(I,{modelValue:o(F),"onUpdate:modelValue":e[19]||(e[19]=t=>f(F)?F.value=t:null),name:"hideDownload",label:"Disable Download"},null,8,["modelValue"])]),_:1})])]),_:1})])):A("",!0)]),_:1}),l(b,{label:o(pe),loading:o(v),size:"lg",disabled:o(v),onClick:Ue},null,8,["label","loading","disabled"])],64)):A("",!0)]),_:1})}}}),$o=Je(Vo,[["__scopeId","data-v-4261cac5"]]);export{$o as default};
//# sourceMappingURL=BQqkC_Pu.js.map
