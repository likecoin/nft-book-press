import{bR as ee,bS as q,bT as be,aQ as me,a_ as H,aS as V,aT as u,bW as M,b3 as y,bi as F,bX as O,bo as te,bp as ae,br as se,c1 as ve,c2 as K,ba as m,b9 as $,b1 as oe,b4 as l,bk as ge,b0 as ye,a$ as he,bx as ke,b8 as Be,bh as Ce,bb as Q,aX as I,b2 as Z,aW as z,bj as we,bf as Ie,aY as Pe,bB as Le,bd as D,aV as x,aU as Y,be as Ne}from"./BNJsiGCO.js";import{_ as _e}from"./CVLFrEHa.js";import{a as ne}from"./Cp5MMBuI.js";import{_ as ze}from"./D0pA7fJL.js";import{_ as $e}from"./lsk6-vbx.js";import{_ as Fe}from"./Ch7v__HZ.js";import"./F4jfc6Fi.js";import"./1HIAqB6c.js";import"./B8W-6irr.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},h=new e.Error().stack;h&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[h]="3bdedede-bdec-4f4c-abe5-33fc13042484",e._sentryDebugIdIdentifier="sentry-dbid-3bdedede-bdec-4f4c-abe5-33fc13042484")}catch{}})();const Se={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},N=ee(q.ui.strategy,q.ui.pagination,Se),Ue=ee(q.ui.strategy,q.ui.button,be),Oe=H({components:{UButton:se},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>N.default.size,validator(e){return Object.keys(Ue.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>N.default.activeButton},inactiveButton:{type:Object,default:()=>N.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>N.default.firstButton},lastButton:{type:Object,default:()=>N.default.lastButton},prevButton:{type:Object,default:()=>N.default.prevButton},nextButton:{type:Object,default:()=>N.default.nextButton},divider:{type:String,default:"â€¦"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:h}){const{ui:P,attrs:i}=ve("pagination",K(e,"ui"),N,K(e,"class")),d=m({get(){return e.modelValue},set(n){h("update:modelValue",n)}}),k=m(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(n,r)=>r+1)),g=m(()=>{const n=k.value.length,r=d.value,B=Math.max(e.max,5),c=Math.floor((Math.min(B,n)-5)/2),C=r-c,f=r+c,G=C-1>1,R=f+1<n,t=[];if(n<=B){for(let p=1;p<=n;p++)t.push(p);return t}if(t.push(1),G&&t.push(e.divider),!R){const p=r+c+2-n;for(let w=r-c-p;w<=r-c-1;w++)t.push(w)}for(let p=Math.max(2,C);p<=Math.min(n,f);p++)t.push(p);if(!G){const p=1-(r-c-2);for(let w=r+c+1;w<=r+c+p;w++)t.push(w)}return R&&t.push(e.divider),f<n&&t.push(n),t.length>=3&&t[1]===e.divider&&t[2]===3&&(t[1]=2),t.length>=3&&t[t.length-2]===e.divider&&t[t.length-1]===t.length&&(t[t.length-2]=t.length-1),t}),a=m(()=>d.value>1),_=m(()=>d.value<k.value.length);function S(){a.value&&(d.value=1)}function E(){_.value&&(d.value=k.value.length)}function W(n){typeof n!="string"&&(d.value=n)}function U(){a.value&&d.value--}function T(){_.value&&d.value++}return{ui:P,attrs:i,currentPage:d,pages:k,displayedPages:g,canGoLastOrNext:_,canGoFirstOrPrev:a,onClickPrev:U,onClickNext:T,onClickPage:W,onClickFirst:S,onClickLast:E}}});function Ve(e,h,P,i,d,k){const g=se;return u(),V("div",O({class:e.ui.wrapper},e.attrs),[M(e.$slots,"first",{onClick:e.onClickFirst,canGoFirst:e.canGoFirstOrPrev},()=>{var a;return[e.firstButton&&e.showFirst?(u(),y(g,O({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),M(e.$slots,"prev",{onClick:e.onClickPrev,canGoPrev:e.canGoFirstOrPrev},()=>{var a;return[e.prevButton?(u(),y(g,O({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage-1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),(u(!0),V(te,null,ae(e.displayedPages,(a,_)=>{var S;return u(),y(g,O({key:`${a}-${_}`,to:typeof a=="number"?(S=e.to)==null?void 0:S.call(e,a):null,size:e.size,disabled:e.disabled,label:`${a}`},{ref_for:!0},a===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof a=="string","z-[1]":a===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(a)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),M(e.$slots,"next",{onClick:e.onClickNext,canGoNext:e.canGoLastOrNext},()=>{var a;return[e.nextButton?(u(),y(g,O({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage+1),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),M(e.$slots,"last",{onClick:e.onClickLast,canGoLast:e.canGoLastOrNext},()=>{var a;return[e.lastButton&&e.showLast?(u(),y(g,O({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.pages.length),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]})],16)}const Me=me(Oe,[["render",Ve]]),Te=H({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(e){const h=ne(),P=e,i=$(!1);return oe(async()=>{try{i.value=!0,await h.lazyFetchClassMetadataById(P.classId)}catch{}finally{i.value=!1}}),(d,k)=>M(d.$slots,"default",{isLoading:l(i)})}}),Ge={key:0,class:"flex justify-between items-center w-full"},Re={class:"flex gap-2 items-center"},je={class:"text-sm leading-5"},Ae={class:"flex gap-1"},De={key:1,class:"max-w-xs truncate"},Ze=H({__name:"index",setup(e){const h=ge(),P=ye(),{t:i}=he(),d=ke(),k=ne(),{listingList:g,moderatedBookList:a,token:_}=Be(d),{lazyFetchClassMetadataById:S}=k,{fetchBookListing:E,fetchModeratedBookList:W}=d,U=$(""),T=$(!1);Ce({title:()=>i("seo_titles.book_listing_management"),ogTitle:()=>i("seo_titles.book_listing_management")});const n=m(()=>[{label:i("bookstore.current_listing"),key:"current"},{label:i("bookstore.viewable_listing"),key:"viewable"}]),r=m({get(){const s=n.value.findIndex(o=>o.key===h.query.tab);return s===-1?0:s},set(s){Z(P({query:{tab:n.value[s].key}}),{replace:!0})}}),B=$(""),c=$({column:"pendingAction",direction:"desc"}),C=$(50),f=$(1),G=m(()=>(f.value-1)*C.value+1),R=m(()=>Math.min(f.value*C.value,t.value.length)),t=m(()=>(n.value[r.value].key==="viewable"?a:g).value.map(s=>{var o,b,L;return{classId:s.classId,className:(o=k.getClassMetadataById(s.classId))==null?void 0:o.name,priceInUSD:(b=s.prices)==null?void 0:b[0].price,prices:(L=s.prices)==null?void 0:L.map(X=>X.price),pendingAction:s.pendingNFTCount,sold:s.sold}}).filter(s=>{if(!B.value)return!0;const o=B.value.toLowerCase();return s.classId.toLowerCase().includes(o)||s.className.toLowerCase().includes(o)})),p=m(()=>{const{column:s,direction:o}=c.value;return t.value.sort((b,L)=>b[s]<L[s]?o==="asc"?-1:1:b[s]>L[s]?o==="asc"?1:-1:0)}),w=m(()=>p.value.slice((f.value-1)*C.value,f.value*C.value)),le=m(()=>[{key:"pendingAction",label:i("table.pending_action"),sortable:!0},{key:"className",label:i("table.class_name"),sortable:!0},{key:"priceInUSD",label:i("table.price_in_usd"),sortable:!0},{key:"sold",label:i("table.sold"),sortable:!0},{key:"classId",label:i("bookstore.class_id"),sortable:!0,class:"font-mono"}]);Q(T,s=>{s&&(U.value="")}),Q(r,()=>{B.value="",f.value=1}),Q(C,()=>{f.value=1}),oe(async()=>{const s=[E()];_.value&&s.push(W()),await Promise.all(s),new Set(g.value.map(b=>b.classId).concat(a.value.map(b=>b.classId))).forEach(b=>S(b))});async function ie(s){await Z(P({name:"my-books-status-classId",params:{classId:s.classId}}))}return(s,o)=>{const b=we,L=Ie,X=Me,re=_e,ue=Ne,de=Te,ce=ze,J=Le,fe=$e,pe=Fe;return u(),y(pe,{ui:{constrained:""}},{default:I(()=>[l(U)?(u(),y(b,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${l(U)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:o[0]||(o[0]=j=>U.value="")},null,8,["title"])):F("",!0),l(T)?(u(),y(L,{key:1,animation:"carousel"},{indicator:I(()=>o[5]||(o[5]=[Pe(" Loading... ")])),_:1})):F("",!0),z(J,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:I(()=>[z(fe,{modelValue:l(r),"onUpdate:modelValue":o[4]||(o[4]=j=>D(r)?r.value=j:null),class:"w-full",items:l(n)},{item:I(({item:j})=>[(u(),y(J,{key:j.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:I(()=>[l(t).length>0?(u(),V("div",Ge,[Y("div",Re,[z(X,{modelValue:l(f),"onUpdate:modelValue":o[1]||(o[1]=v=>D(f)?f.value=v:null),"page-count":l(C),total:l(t).length},null,8,["modelValue","page-count","total"]),Y("span",je,x(l(i)("table.showing_rows",{from:l(G),to:l(R),total:l(t).length})),1)]),z(re,{modelValue:l(B),"onUpdate:modelValue":o[2]||(o[2]=v=>D(B)?B.value=v:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:l(i)("table.search_placeholder")},null,8,["modelValue","placeholder"])])):F("",!0)]),default:I(()=>[z(ce,{sort:l(c),"onUpdate:sort":o[3]||(o[3]=v=>D(c)?c.value=v:null),columns:l(le),rows:l(w),onSelect:ie},{"priceInUSD-data":I(({row:v})=>[Y("ul",Ae,[(u(!0),V(te,null,ae(v.prices,A=>(u(),V("li",{key:A},[z(ue,{label:`$${A}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":I(({row:v})=>[z(de,{"class-id":v.classId},{default:I(({isLoading:A})=>[A||!v.className?(u(),y(L,{key:0})):(u(),V("div",De,x(v.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})}}});export{Ze as default};
