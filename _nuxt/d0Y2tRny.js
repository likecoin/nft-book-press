import{a_ as U,b7 as P,a$ as D,bz as L,b8 as w,b9 as x,bb as z,b1 as V,ba as b,b3 as _,aT as u,aX as d,bi as p,b4 as t,bj as j,bA as G,aU as C,aS as W,aW as h,aV as k,bq as q}from"./Bm-IVQXy.js";import{_ as K}from"./QQqPabFv.js";import{_ as M}from"./BuTWThA6.js";import{u as X}from"./BhEP3np7.js";import"./eXK-QAli.js";import"./Aujz5yYv.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new r.Error().stack;l&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[l]="0444c669-23c3-49f7-a106-a572053f6e91",r._sentryDebugIdIdentifier="sentry-dbid-0444c669-23c3-49f7-a106-a572053f6e91")}catch{}})();const F={class:"text-center font-bold font-mono"},H={class:"flex justify-center items-center gap-4"},J=["textContent"],ae=U({__name:"index",setup(r){const{LIKE_CO_API:l}=P().public,{t:s}=D(),y=L(),f=X(),{token:v,wallet:m}=w(y),{getStripeConnectStatusByWallet:T}=w(f),o=x(""),n=x(!1);z(n,e=>{e&&(o.value="")}),V(async()=>{await f.refreshStripeConnectStatus(m.value)});const i=b(()=>T.value(m.value)),c=b(()=>i.value?.isReady),A=b(()=>{if(!i.value?.hasAccount&&!c.value)return s("user_settings.setup_stripe_connect");if(i.value?.hasAccount&&!c.value)return s("user_settings.resume_stripe_connect_setup");if(i.value?.hasAccount&&c.value)return s("user_settings.login_to_stripe")});async function B(){try{n.value=!0,await f.refreshStripeConnectStatus(m.value)}catch(e){o.value=e.toString()}finally{n.value=!1}}async function E(){try{n.value=!0;const a=(await $fetch(`${l}/likernft/book/user/connect/login`,{method:"POST",headers:{authorization:`Bearer ${v.value}`}})).url;if(a)window.open(a);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),o.value=e.toString()}finally{n.value=!1}}async function N(){try{n.value=!0;const a=(await $fetch(`${l}/likernft/book/user/connect/new`,{method:"POST",headers:{authorization:`Bearer ${v.value}`}})).url;if(a)window.open(a);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),o.value=e.toString()}finally{n.value=!1}}async function $(){n.value=!0;try{c.value?await E():await N()}catch(e){console.error(e),o.value=e.toString()}finally{n.value=!1}}return(e,a)=>{const g=j,S=q,I=K,R=G,O=M;return u(),_(O,null,{default:d(()=>[t(o)?(u(),_(g,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${t(o)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:a[0]||(a[0]=Q=>o.value="")},null,8,["title"])):p("",!0),t(c)?p("",!0):(u(),_(g,{key:1,icon:"i-heroicons-exclamation-circle",color:"orange",variant:"soft",title:t(s)("user_settings.stripe_express_notice"),description:t(s)("user_settings.stripe_express_description")},null,8,["title","description"])),t(y).isAuthenticated?(u(),_(R,{key:2,ui:{header:{base:"flex justify-between items-center"},body:{padding:""},footer:{base:"text-center"}}},{header:d(()=>[C("h1",F,k(t(s)("user_settings.stripe_payout_status")),1),h(I,{text:"Refresh Status",popper:{placement:"left"}},{default:d(()=>[h(S,{icon:"i-heroicons-arrow-path",variant:"outline",disabled:t(n),onClick:B},null,8,["disabled"])]),_:1})]),footer:d(()=>[C("div",H,[t(i)?.hasAccount&&t(c)?(u(),W("span",{key:0,class:"text-sm text-gray-500",textContent:k(t(i).email)},null,8,J)):p("",!0),h(S,{label:t(A),size:"md",loading:t(n),disabled:t(n),color:"black",onClick:$},null,8,["label","loading","disabled"])])]),_:1})):p("",!0)]),_:1})}}});export{ae as default};
