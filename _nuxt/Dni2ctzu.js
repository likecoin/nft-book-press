import{a_ as A,b9 as m,b1 as z,bY as ne,b4 as a,bk as le,b0 as re,a$ as ce,bz as ie,b8 as ue,bh as de,ba as i,bb as N,b3 as v,aX as r,b2 as M,aT as u,bi as P,aW as d,bj as me,bf as _e,aY as pe,bD as be,bd as U,aS as V,aV as F,aU as C,bo as fe,bp as ge,be as ye,bw as ve}from"./BVgQfaNN.js";import{_ as ke}from"./bL0EkUd_.js";import{a as j}from"./mJZnu1Sy.js";import{_ as Ie}from"./DkEM-FlO.js";import{_ as we}from"./D2YwAVrx.js";import{_ as xe}from"./B7Q4iAhT.js";import"./BCqzyNmh.js";import"./Ob-Xc3PG.js";(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_=new c.Error().stack;_&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[_]="4f5b4975-c5e2-4cf5-b507-cfe025603410",c._sentryDebugIdIdentifier="sentry-dbid-4f5b4975-c5e2-4cf5-b507-cfe025603410")}catch{}})();const he=A({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(c){const _=j(),f=c,s=m(!1);return z(async()=>{try{s.value=!0,await _.lazyFetchClassMetadataById(f.classId)}catch{}finally{s.value=!1}}),(k,T)=>ne(k.$slots,"default",{isLoading:a(s)})}}),Le={class:"flex justify-between items-center w-full"},Se={class:"flex gap-2 items-center"},Ue={class:"text-sm leading-5"},Ce={class:"flex gap-1"},Te={key:1,class:"max-w-xs truncate"},Fe=A({__name:"index",setup(c){const _=le(),f=re(),{t:s}=ce(),k=ie(),T=j(),{listingList:B,moderatedBookList:R,token:q}=ue(k),{lazyFetchClassMetadataById:E}=T,{fetchBookListing:Y,fetchModeratedBookList:W}=k,I=m(""),$=m(!1);de({title:()=>s("seo_titles.book_listing_management"),ogTitle:()=>s("seo_titles.book_listing_management")});const w=i(()=>[{label:s("bookstore.current_listing"),key:"current"},{label:s("bookstore.viewable_listing"),key:"viewable"}]),g=i({get(){const e=w.value.findIndex(t=>t.key===_.query.tab);return e===-1?0:e},set(e){M(f({query:{tab:w.value[e].key}}),{replace:!0})}}),p=m(""),x=m({column:"pendingAction",direction:"desc"}),b=m(50),l=m(1),X=i(()=>(l.value-1)*b.value+1),G=i(()=>Math.min(l.value*b.value,h.value.length)),h=i(()=>(w.value[g.value].key==="viewable"?R:B).value.map(e=>({classId:e.classId,className:T.getClassMetadataById(e.classId)?.name,priceInUSD:e.prices?.[0].price,prices:e.prices?.map(t=>t.price),pendingAction:e.pendingNFTCount,sold:e.sold})).filter(e=>{if(!p.value)return!0;const t=p.value.toLowerCase();return e.classId.toLowerCase().includes(t)||e.className.toLowerCase().includes(t)})),H=i(()=>{const{column:e,direction:t}=x.value;return h.value.sort((n,y)=>n[e]<y[e]?t==="asc"?-1:1:n[e]>y[e]?t==="asc"?1:-1:0)}),J=i(()=>H.value.slice((l.value-1)*b.value,l.value*b.value)),K=i(()=>[{key:"pendingAction",label:s("table.pending_action"),sortable:!0},{key:"className",label:s("table.class_name"),sortable:!0},{key:"priceInUSD",label:s("table.price_in_usd"),sortable:!0},{key:"sold",label:s("table.sold"),sortable:!0},{key:"classId",label:s("bookstore.class_id"),sortable:!0,class:"font-mono"}]);N($,e=>{e&&(I.value="")}),N(g,()=>{p.value="",l.value=1}),N(b,()=>{l.value=1}),z(async()=>{const e=[Y()];q.value&&e.push(W()),await Promise.all(e),new Set(B.value.map(n=>n.classId).concat(R.value.map(n=>n.classId))).forEach(n=>E(n))});async function O(e){await M(f({name:"my-books-status-classId",params:{classId:e.classId}}))}return(e,t)=>{const n=me,y=_e,Q=ke,Z=ve,ee=ye,te=he,ae=Ie,D=be,se=we,oe=xe;return u(),v(oe,{ui:{constrained:""}},{default:r(()=>[a(I)?(u(),v(n,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${a(I)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:t[0]||(t[0]=L=>I.value="")},null,8,["title"])):P("",!0),a($)?(u(),v(y,{key:1,animation:"carousel"},{indicator:r(()=>[...t[5]||(t[5]=[pe(" Loading... ",-1)])]),_:1})):P("",!0),d(D,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:r(()=>[d(se,{modelValue:a(g),"onUpdate:modelValue":t[4]||(t[4]=L=>U(g)?g.value=L:null),class:"w-full",items:a(w)},{item:r(({item:L})=>[(u(),v(D,{key:L.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:r(()=>[C("div",Le,[C("div",Se,[d(Q,{modelValue:a(l),"onUpdate:modelValue":t[1]||(t[1]=o=>U(l)?l.value=o:null),"page-count":a(b),total:a(h).length},null,8,["modelValue","page-count","total"]),C("span",Ue,F(a(s)("table.showing_rows",{from:a(X),to:a(G),total:a(h).length})),1)]),d(Z,{modelValue:a(p),"onUpdate:modelValue":t[2]||(t[2]=o=>U(p)?p.value=o:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:a(s)("table.search_placeholder")},null,8,["modelValue","placeholder"])])]),default:r(()=>[d(ae,{sort:a(x),"onUpdate:sort":t[3]||(t[3]=o=>U(x)?x.value=o:null),columns:a(K),rows:a(J),onSelect:O},{"priceInUSD-data":r(({row:o})=>[C("ul",Ce,[(u(!0),V(fe,null,ge(o.prices,S=>(u(),V("li",{key:S},[d(ee,{label:`$${S}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":r(({row:o})=>[d(te,{"class-id":o.classId},{default:r(({isLoading:S})=>[S||!o.className?(u(),v(y,{key:0})):(u(),V("div",Te,F(o.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:1}))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})}}});export{Fe as default};
