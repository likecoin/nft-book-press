import{_ as Re}from"./PZnptNIo.js";import{n as Le,u as Ne,q as Ee,O as Me,a0 as Pe,r as c,h as ie,s as I,v as Be,x as $e,o as _,A as P,w as s,B as a,U as de,b as t,a as d,t as re,C as v,J as B,c as F,F as X,D as Ae,G as De,a8 as Oe,E as Te,H as je,M as ze}from"./CXvzJBqc.js";import{_ as Fe}from"./bgT9q-Rv.js";import{_ as Ge}from"./CywMFlWE.js";import{_ as Je}from"./Bl9mAokz.js";import{_ as qe}from"./CE2iqjx2.js";import{_ as Qe}from"./C5ezs2iv.js";import{_ as We}from"./XxVD5M3f.js";import{_ as He}from"./CcEgir4l.js";import{_ as Ke}from"./CwmTlS9R.js";import{_ as Xe}from"./C2yFob7b.js";import{u as Ye}from"./BIuo8Hkz.js";import"./B6tRnKpl.js";import"./DYgdYNuC.js";import"./DgMIOc01.js";import"./DFlJJ7X2.js";import"./CCDWpv86.js";import"./Cs3pAtb6.js";(function(){try{var L=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$=new Error().stack;$&&(L._sentryDebugIds=L._sentryDebugIds||{},L._sentryDebugIds[$]="f01c929b-9663-4e4b-802d-c8d3fbc6f31e",L._sentryDebugIdIdentifier="sentry-dbid-f01c929b-9663-4e4b-802d-c8d3fbc6f31e")}catch{}})();const Ze={class:"flex items-center gap-2"},eo=["textContent"],oo={class:"flex items-start gap-4"},to=["src"],lo={class:"flex flex-col justify-start"},no=["textContent"],ao={class:"text-center"},so={class:"flex items-center gap-2 px-4 sm:px-6"},io={class:"flex items-center gap-2"},ro={class:"flex justify-center items-center gap-4"},co={class:"flex justify-center items-center gap-4"},uo={class:"flex items-center gap-2"},mo={class:"flex justify-center gap-4"},No=Le({__name:"index",setup(L){const $=Ne(),A=Ee(),{LIKER_LAND_URL:Y}=Me().public,D=Ye(),G=Pe(),{lazyFetchClassMetadataById:Z,lazyFetchClassListingInfoById:ee}=D,{lazyFetchCollectionById:oe}=G,u=c([{id:0,value:""}]),te=c(1),b=c(!1),C=c(""),y=c(""),k=c([]),m=c(""),w=c(""),p=c([]),h=c(!1),N=c(!1),U=c(!1);ie(h,o=>{o||(u.value=[{id:0,value:""}],te.value=1)});const ce=I(()=>{const o=[{key:"name",label:"Product",class:""}];return U.value&&o.push({key:"delete-action",label:"",class:"w-12"}),o}),ue=I(()=>{const o=[];return J.value.length&&o.push([{label:U.value?"Exit Edit Items":"Edit Items",icon:U.value?"i-heroicons-pencil-solid":"i-heroicons-pencil",click:be}]),o.push([{label:"New Coupon",icon:"i-heroicons-tag",click:()=>{b.value=!b.value}},{class:"text-red-500",label:"Clear All Coupons",icon:"i-heroicons-trash",iconClass:"text-red-500",disabled:!k.value.length,click:Ie}]),o}),J=I(()=>{var o;return(o=p.value)==null?void 0:o.map((e,i)=>{var n,O,E,T,j,z,g,x;return e.collectionId?{collectionId:e.collectionId,name:(n=G.getCollectionById(e.collectionId))==null?void 0:n.name,image:de((O=G.getCollectionById(e.collectionId))==null?void 0:O.image),index:i}:{classId:e.classId,name:(E=D.getClassMetadataById(e.classId))==null?void 0:E.name,prices:(j=(T=D.getClassListingInfoById(e.classId))==null?void 0:T.prices)==null?void 0:j.map(W=>({...W})),image:de((x=(g=(z=D.getClassMetadataById(e.classId))==null?void 0:z.data)==null?void 0:g.metadata)==null?void 0:x.image),index:i}})}),S=c([]),V=I(()=>S.value.map(e=>p.value[e.index]).sort((e,i)=>(e==null?void 0:e.priceIndex)!==void 0&&!(i!=null&&i.priceIndex)?-1:!(e!=null&&e.priceIndex)&&(i==null?void 0:i.priceIndex)!==void 0?1:0));ie(J,o=>{o.length||(U.value=!1)});const R=I(()=>{const o=new URLSearchParams({utm_source:"direct-checkout",utm_medium:"pos"});return V.value.forEach(({classId:e,priceIndex:i,collectionId:n})=>{e&&o.append("class_id",e),i&&o.append("price_index",i.toString()),n&&o.append("collection_id",n)}),m.value&&o.append("coupon",m.value),`${Y}/shopping-cart/book?${o.toString()}`}),me=I(()=>{const o=new URLSearchParams({gift_to_email:w.value,checkout:"1",utm_source:"direct-sales",utm_medium:"pos"});return V.value.forEach(({classId:e,priceIndex:i,collectionId:n})=>{e&&o.append("class_id",e),i&&o.append("price_index",i.toString()),n&&o.append("collection_id",n)}),m.value&&o.append("coupon",m.value),`${Y}/shopping-cart/book?${o.toString()}`}),q=I(()=>"Liker Land Point Of Sale");Be({title:q.value,ogTitle:q.value}),$e(()=>{try{const o=window.localStorage.getItem("nft_book_store_pos_items");if(o){const i=JSON.parse(o);p.value=i.map(n=>({collectionId:n.collectionId,classId:n.classId,priceIndex:n.priceIndex}))}const e=window.localStorage.getItem("nft_book_store_pos_coupons");if(e){const i=JSON.parse(e);k.value=i.map(n=>({name:n.name,code:n.code}))}}catch(o){console.error(o)}p.value.forEach(o=>{o.classId&&(Z(o.classId),ee(o.classId)),o.collectionId&&oe(o.collectionId)})});function pe(){u.value.length&&u.value.push({id:te.value++,value:""})}function fe(o){u.value.splice(o,1)}function _e(o,e){u.value[o].error=void 0,u.value[o].value=e}function ve(){u.value.forEach(o=>{o.error=void 0;let e=o.value.trim();e.startsWith("http")&&(e=new URL(e).pathname.split("/").pop()||""),e.startsWith("likenft")?(p.value.push({classId:e,priceIndex:0}),Z(e),ee(e)):e.startsWith("col_book_")?(p.value.push({collectionId:e}),oe(e)):o.error=new Error("Invalid product ID")}),u.value.every(o=>!o.error)&&(h.value=!1,Q())}function ge(o,{index:e}){p.value[e].priceIndex=Number(o),Q()}function xe({index:o}){p.value.splice(o,1),S.value=S.value.filter(e=>e.index!==o),Q()}function le(){h.value=!h.value}function be(){U.value=!U.value}function he(){k.value.push({name:C.value,code:y.value}),C.value="",y.value="",ne(),A.add({title:"Added coupon",timeout:2e3,color:"green"}),b.value=!1}function Ie(){window.confirm("Are you sure you want to clear all coupons?")&&(k.value=[],m.value="",ne(),A.add({title:"Cleared all coupons",timeout:2e3,color:"red"}))}function Q(){window.localStorage.setItem("nft_book_store_pos_items",JSON.stringify(p.value))}function ne(){window.localStorage.setItem("nft_book_store_pos_coupons",JSON.stringify(k.value))}function Ce(){A.add({title:"Copied URL to clipboard",timeout:2e3}),navigator.clipboard.writeText(R.value)}function ye(){window.open(R.value)}function ke(){N.value=!0}function we(){if(!w.value){alert("Please enter email");return}window.open(me.value)}return(o,e)=>{const i=Re,n=De,O=Fe,E=Ge,T=Oe,j=Je,z=Te,g=qe,x=Qe,W=We,H=je,Ue=He,K=ze,Se=Ke,Ve=Xe;return _(),P(Ve,{key:a($).path},{default:s(()=>[t(i,{title:a(q)},null,8,["title"]),t(Se,{ui:{base:"flex flex-col items-stretch grow space-y-4",padding:"max-md:!px-0 max-md:py-0"}},{default:s(()=>[t(K,{ui:{base:"flex flex-col grow",rounded:"max-md:rounded-none",header:{base:"flex justify-between items-center gap-4"},body:{base:"grow",padding:""},footer:{base:"sticky bottom-0 bg-white dark:bg-gray-900 rounded-b-[inherit]",padding:"px-0 sm:px-0 space-y-4"}}},{header:s(()=>[d("div",Ze,[d("h2",{class:"text-xl font-bold",textContent:re(`Sales Items${a(V).length>0?` (${a(V).length} selected)`:""}`)},null,8,eo),t(n,{icon:"i-heroicons-plus-circle",variant:"soft",onClick:le})]),t(O,{items:a(ue),popper:{placement:"bottom-end"}},{default:s(()=>[t(n,{color:"white",icon:"i-heroicons-ellipsis-horizontal-circle"})]),_:1},8,["items"])]),footer:s(()=>[d("div",so,[t(E,{modelValue:a(m),"onUpdate:modelValue":e[1]||(e[1]=l=>v(m)?m.value=l:null),class:"grow",options:a(k).map(l=>({label:l.name,value:l.code})),placeholder:"Select Coupon"},null,8,["modelValue","options"]),a(m)?(_(),P(n,{key:0,icon:"i-heroicons-x-mark-16-solid",size:"sm",color:"gray",variant:"outline",onClick:e[2]||(e[2]=()=>{m.value=""})})):B("",!0)]),t(z),t(Ue,{class:"w-full",items:[{key:"direct",label:"Direct Checkout"},{key:"gift",label:"Gift Checkout"}],ui:{wrapper:"px-4 sm:px-6",base:"flex flex-col space-y-4"}},{item:s(({item:l})=>[l.key==="direct"?(_(),F(X,{key:0},[t(x,{label:"Checkout URL"},{default:s(()=>[d("div",io,[t(g,{modelValue:a(R),"onUpdate:modelValue":e[3]||(e[3]=r=>v(R)?R.value=r:null),class:"grow font-mono",readonly:""},null,8,["modelValue"]),t(n,{icon:"i-heroicons-clipboard-document",variant:"soft",color:"gray",onClick:Ce})])]),_:1}),d("div",ro,[t(n,{label:"View Cart",size:"lg",onClick:ye}),t(n,{label:"Generate QR Code",disabled:!a(V).length,size:"lg",onClick:ke},null,8,["disabled"]),t(H,{modelValue:a(N),"onUpdate:modelValue":e[5]||(e[5]=r=>v(N)?N.value=r:null),ui:{padding:"p-0",rounded:"max-sm:rounded-b-none"}},{default:s(()=>[t(W,{data:a(R),mode:"readonly","file-name":"likerland_checkout",width:280,height:280},{header:s(()=>[e[12]||(e[12]=d("h3",{class:"font-bold font-mono",textContent:"Scan to buy"},null,-1)),t(n,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:e[4]||(e[4]=r=>N.value=!1)})]),_:1},8,["data"])]),_:1},8,["modelValue"])])],64)):l.key==="gift"?(_(),F(X,{key:1},[t(x,{label:"Receiver Email"},{default:s(()=>[t(g,{modelValue:a(w),"onUpdate:modelValue":e[6]||(e[6]=r=>v(w)?w.value=r:null),type:"email",placeholder:"example@liker.land"},null,8,["modelValue"])]),_:1}),d("div",co,[t(n,{label:"Send Gift",disabled:!a(V).length||!a(w),size:"lg",onClick:we},null,8,["disabled"])])],64)):B("",!0)]),_:1})]),default:s(()=>[t(j,{modelValue:a(S),"onUpdate:modelValue":e[0]||(e[0]=l=>v(S)?S.value=l:null),columns:a(ce),rows:a(J),ui:{wrapper:"static h-full",thead:"sticky top-0"}},{"name-data":s(({row:l})=>{var r,M;return[d("div",oo,[l.image?(_(),F("img",{key:0,class:"w-[64px] object-contain rounded-sm",src:l.image},null,8,to)):B("",!0),d("div",lo,[d("div",{class:"whitespace-break-spaces",textContent:re(l.name)},null,8,no),l.classId&&((r=l.prices)==null?void 0:r.length)>1?(_(),P(E,{key:0,class:"mt-2","model-value":a(p)[l.index].priceIndex||0,options:(M=l.prices)==null?void 0:M.map(f=>{var ae,se;return{label:((ae=f.name)==null?void 0:ae.zh)||((se=f.name)==null?void 0:se.en)||f.name,value:f.index}}),"onUpdate:modelValue":f=>ge(f,l)},null,8,["model-value","options","onUpdate:modelValue"])):B("",!0)])])]}),"delete-action-header":s(()=>[d("div",ao,[t(T,{name:"i-heroicons-trash-solid"})])]),"delete-action-data":s(({row:l})=>[t(n,{icon:"i-heroicons-x-mark",color:"red",variant:"link",onClick:r=>xe(l)},null,8,["onClick"])]),_:1},8,["modelValue","columns","rows"])]),_:1}),t(H,{modelValue:a(h),"onUpdate:modelValue":e[7]||(e[7]=l=>v(h)?h.value=l:null),ui:{padding:"p-0",rounded:"max-sm:rounded-b-none"}},{default:s(()=>[t(K,{ui:{rounded:"max-sm:rounded-b-none",header:{base:"flex justify-between items-center gap-4"},body:{base:"space-y-4"},footer:{base:"flex justify-center items-center"}}},{header:s(()=>[e[13]||(e[13]=d("h3",{class:"font-bold font-mono",textContent:"Add Item(s)"},null,-1)),t(n,{icon:"i-heroicons-x-mark",color:"gray",variant:"link",onClick:le})]),footer:s(()=>[t(n,{label:"Confirm",onClick:ve})]),default:s(()=>[(_(!0),F(X,null,Ae(a(u),(l,r)=>{var M;return _(),P(x,{key:`input-${l.id}`,label:"Enter Product ID/URL(s)",required:!0,error:(M=l.error)==null?void 0:M.message},{default:s(()=>[d("div",uo,[t(g,{class:"grow font-mono","model-value":l.value,placeholder:"https://liker.land/nft/class/likenft....","onUpdate:modelValue":f=>_e(r,f)},null,8,["model-value","onUpdate:modelValue"]),a(u).length>1?(_(),P(n,{key:0,icon:"i-heroicons-x-circle",variant:"link",onClick:f=>fe(r)},null,8,["onClick"])):B("",!0)])]),_:2},1032,["error"])}),128)),d("div",mo,[t(n,{icon:"i-heroicons-plus-circle",label:"Add",variant:"outline",onClick:pe})])]),_:1})]),_:1},8,["modelValue"]),t(H,{modelValue:a(b),"onUpdate:modelValue":e[11]||(e[11]=l=>v(b)?b.value=l:null),ui:{padding:"p-0",rounded:"max-sm:rounded-b-none"}},{default:s(()=>[t(K,{ui:{rounded:"max-sm:rounded-b-none",header:{base:"flex justify-between items-center gap-4"},body:{base:"space-y-4"},footer:{base:"flex justify-end items-center gap-4"}}},{header:s(()=>[e[14]||(e[14]=d("h3",{class:"font-bold",textContent:"Add Coupon"},null,-1)),t(n,{icon:"i-heroicons-x-mark-16-solid",color:"gray",size:"xl",padded:!1,variant:"link",onClick:e[8]||(e[8]=l=>b.value=!1)})]),footer:s(()=>[t(n,{icon:"i-heroicons-plus-circle",label:"Add Coupon",disabled:!a(C)||!a(y),onClick:he},null,8,["disabled"])]),default:s(()=>[t(x,{label:"Coupon Name",help:"For POS Display Only",required:!0},{default:s(()=>[t(g,{modelValue:a(C),"onUpdate:modelValue":e[9]||(e[9]=l=>v(C)?C.value=l:null),placeholder:"Fall Promotion"},null,8,["modelValue"])]),_:1}),t(x,{label:"Coupon Code",required:!0},{default:s(()=>[t(g,{modelValue:a(y),"onUpdate:modelValue":e[10]||(e[10]=l=>v(y)?y.value=l:null),class:"font-mono",placeholder:"FALLPROMO"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{No as default};
//# sourceMappingURL=DN6uAUmb.js.map
