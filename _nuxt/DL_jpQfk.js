import{_ as qt}from"./OxNfaRc5.js";import{a_ as ie,b1 as Re,bG as pt,bH as mt,bI as Mt,ba as c,bJ as ve,bK as Ee,b9 as b,bL as jt,bM as J,bN as tt,bO as Qt,bP as nt,bQ as ft,bR as le,bS as ot,aQ as zt,bT as Ue,aS as j,aT as k,bp as Oe,bo as _t,b3 as O,aX as r,aW as s,bU as at,bV as De,bq as Te,bW as lt,bX as Pe,bY as M,bZ as Ht,b_ as ht,aY as st,aV as V,b$ as vt,c0 as bt,c1 as Nt,c2 as it,bb as se,c3 as Ft,c4 as be,c5 as Kt,c6 as Wt,c7 as Gt,b7 as Xt,c8 as Yt,by as Jt,b8 as Zt,bk as en,b0 as tn,bt as nn,a$ as on,bh as an,bn as ln,bD as sn,b4 as t,aU as x,bA as rn,bw as un,bd as R,bv as cn,bi as Y,c9 as rt,be as dn,ca as pn,cb as mn,cc as ut,b2 as ct,cd as fn,ce as dt}from"./CdYtZq0D.js";import{_ as _n}from"./CyLu4eK1.js";import{_ as hn}from"./DpP4PhUR.js";import{_ as vn}from"./Du1RKLFu.js";import{s as bn}from"./D413nbYB.js";import{_ as kn}from"./Czmh6y2h.js";import{_ as gn}from"./CVS0gkuV.js";import{_ as yn}from"./BhryjSoQ.js";import{_ as Cn,d as In}from"./C09AfIMR.js";import{_ as wn}from"./BoePP6o3.js";import{_ as xn}from"./BFQJfKQJ.js";import{A as Sn,a as Ln}from"./BETsY8fF.js";import{u as Un}from"./BrrjQnMH.js";import"./DcSKjSBt.js";import"./hfcAh15g.js";import"./DNZVFkL5.js";import"./D5vIZ8E6.js";import"./Bbb6KkFe.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},g=new o.Error().stack;g&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[g]="36ee4364-dcd6-4c26-9566-982d982a3b4e",o._sentryDebugIdIdentifier="sentry-dbid-36ee4364-dcd6-4c26-9566-982d982a3b4e")}catch{}})();const Dn={wrapper:"w-full flex flex-col",container:"w-full flex flex-col",item:{base:"",size:"text-sm",color:"text-gray-500 dark:text-gray-400",padding:"pt-1.5 pb-3",icon:"ms-auto transform transition-transform duration-200 flex-shrink-0"},transition:{enterActiveClass:"overflow-hidden transition-[height] duration-200 ease-out",leaveActiveClass:"overflow-hidden transition-[height] duration-200 ease-out"},default:{openIcon:"i-heroicons-chevron-down-20-solid",closeIcon:"",class:"mb-1.5 w-full",variant:"soft",truncate:!0}};var Bn=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(Bn||{});let kt=Symbol("DisclosureContext");function Ae(o){let g=ft(kt,null);if(g===null){let L=new Error(`<${o} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(L,Ae),L}return g}let gt=Symbol("DisclosurePanelContext");function $n(){return ft(gt,null)}let Vn=ie({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(o,{slots:g,attrs:L}){let y=b(o.defaultOpen?0:1),u=b(null),U=b(null),h={buttonId:b(`headlessui-disclosure-button-${tt()}`),panelId:b(`headlessui-disclosure-panel-${tt()}`),disclosureState:y,panel:u,button:U,toggleDisclosure(){y.value=nt(y.value,{0:1,1:0})},closeDisclosure(){y.value!==1&&(y.value=1)},close(_){h.closeDisclosure();let I=_?_ instanceof HTMLElement?_:_.value instanceof HTMLElement?J(_):J(h.button):J(h.button);I?.focus()}};return mt(kt,h),Qt(c(()=>nt(y.value,{0:ve.Open,1:ve.Closed}))),()=>{let{defaultOpen:_,...I}=o,w={open:y.value===0,close:h.close};return Ee({theirProps:I,ourProps:{},slot:w,slots:g,attrs:L,name:"Disclosure"})}}}),On=ie({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(o,{attrs:g,slots:L,expose:y}){let u=Ae("DisclosureButton"),U=$n(),h=c(()=>U===null?!1:U.value===u.panelId.value);Re(()=>{h.value||o.id!==null&&(u.buttonId.value=o.id)}),pt(()=>{h.value||(u.buttonId.value=null)});let _=b(null);y({el:_,$el:_}),h.value||jt(()=>{u.button.value=_.value});let I=bn(c(()=>({as:o.as,type:g.type})),_);function w(){var l;o.disabled||(h.value?(u.toggleDisclosure(),(l=J(u.button))==null||l.focus()):u.toggleDisclosure())}function a(l){var d;if(!o.disabled)if(h.value)switch(l.key){case le.Space:case le.Enter:l.preventDefault(),l.stopPropagation(),u.toggleDisclosure(),(d=J(u.button))==null||d.focus();break}else switch(l.key){case le.Space:case le.Enter:l.preventDefault(),l.stopPropagation(),u.toggleDisclosure();break}}function p(l){switch(l.key){case le.Space:l.preventDefault();break}}return()=>{var l;let d={open:u.disclosureState.value===0},{id:m,...D}=o,Q=h.value?{ref:_,type:I.value,onClick:w,onKeydown:a}:{id:(l=u.buttonId.value)!=null?l:m,ref:_,type:I.value,"aria-expanded":u.disclosureState.value===0,"aria-controls":u.disclosureState.value===0||J(u.panel)?u.panelId.value:void 0,disabled:o.disabled?!0:void 0,onClick:w,onKeydown:a,onKeyup:p};return Ee({ourProps:Q,theirProps:D,slot:d,attrs:g,slots:L,name:"DisclosureButton"})}}}),Rn=ie({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(o,{attrs:g,slots:L,expose:y}){let u=Ae("DisclosurePanel");Re(()=>{o.id!==null&&(u.panelId.value=o.id)}),pt(()=>{u.panelId.value=null}),y({el:u.panel,$el:u.panel}),mt(gt,u.panelId);let U=Mt(),h=c(()=>U!==null?(U.value&ve.Open)===ve.Open:u.disclosureState.value===0);return()=>{var _;let I={open:u.disclosureState.value===0,close:u.close},{id:w,...a}=o,p={id:(_=u.panelId.value)!=null?_:w,ref:u.panel};return Ee({ourProps:p,theirProps:a,slot:I,attrs:g,slots:L,features:ot.RenderStrategy|ot.Static,visible:h.value,name:"DisclosurePanel"})}}});const Be=bt(be.ui.strategy,be.ui.accordion,Dn),En=bt(be.ui.strategy,be.ui.button,Kt),Tn=ie({components:{HDisclosure:Vn,HDisclosureButton:On,HDisclosurePanel:Rn,UIcon:Pe,UButton:Te},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},defaultOpen:{type:Boolean,default:!1},openIcon:{type:String,default:()=>Be.default.openIcon},unmount:{type:Boolean,default:!1},closeIcon:{type:String,default:()=>Be.default.closeIcon},multiple:{type:Boolean,default:!1},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["open","close"],setup(o,{emit:g}){const{ui:L,attrs:y}=Nt("accordion",it(o,"ui"),Be,it(o,"class")),u=c(()=>En),U=b([]),h=c(()=>U.value.map(({open:l})=>l));se(h,(l,d)=>{for(const m in l){const D=d[m],Q=l[m];!D&&Q?g("open",m):D&&!Q&&g("close",m)}},{immediate:!0});function _(l,d){!o.items[l].closeOthers&&o.multiple||U.value.forEach(m=>{m.open&&m.close(d.target)})}function I(l,d){const m=l;m.style.height="0",m.offsetHeight,m.style.height=m.scrollHeight+"px",m.addEventListener("transitionend",d,{once:!0})}function w(l){const d=l;d.style.height=d.scrollHeight+"px",d.offsetHeight}function a(l){const d=l;d.style.height="auto"}function p(l,d){const m=l;m.style.height="0",m.addEventListener("transitionend",d,{once:!0})}return Wt(()=>Gt()),{ui:L,uiButton:u,attrs:y,buttonRefs:U,closeOthers:_,omit:Ft,onEnter:I,onBeforeLeave:w,onAfterEnter:a,onLeave:p}}}),Pn={key:1};function An(o,g,L,y,u,U){const h=Pe,_=Te,I=Ue("HDisclosureButton"),w=Ue("HDisclosurePanel"),a=Ue("HDisclosure");return k(),j("div",{class:M(o.ui.wrapper)},[(k(!0),j(Oe,null,_t(o.items,(p,l)=>(k(),O(a,{key:l,as:"div",class:M(o.ui.container),"default-open":o.defaultOpen||p.defaultOpen},{default:r(({open:d,close:m})=>[s(I,{ref_for:!0,ref:()=>o.buttonRefs[l]={open:d,close:m},as:"template",disabled:p.disabled,onClick:D=>o.closeOthers(l,D),onKeydown:[at(D=>o.closeOthers(l,D),["enter"]),at(D=>o.closeOthers(l,D),["space"])]},{default:r(()=>[De(o.$slots,"default",{item:p,index:l,open:d,close:m},()=>[s(_,lt({ref_for:!0},{...o.omit(o.ui.default,["openIcon","closeIcon"]),...o.attrs,...o.omit(p,["slot","disabled","content","defaultOpen"])}),{trailing:r(()=>[s(h,{name:d&&o.closeIcon?o.closeIcon:o.openIcon,class:M([d&&!o.closeIcon?"-rotate-180":"",o.uiButton.icon.size[p.size||o.uiButton.default.size],o.ui.item.icon])},null,8,["name","class"])]),_:2},1040)])]),_:2},1032,["disabled","onClick","onKeydown"]),s(Ht,lt({ref_for:!0},o.ui.transition,{onEnter:o.onEnter,onAfterEnter:o.onAfterEnter,onBeforeLeave:o.onBeforeLeave,onLeave:o.onLeave}),{default:r(()=>[o.unmount?(k(),O(w,{key:0,class:M([o.ui.item.base,o.ui.item.size,o.ui.item.color,o.ui.item.padding]),unmount:""},{default:r(()=>[De(o.$slots,p.slot||"item",{item:p,index:l,open:d,close:m},()=>[st(V(p.content),1)])]),_:2},1032,["class"])):ht((k(),j("div",Pn,[s(w,{class:M([o.ui.item.base,o.ui.item.size,o.ui.item.color,o.ui.item.padding]),static:""},{default:r(()=>[De(o.$slots,p.slot||"item",{item:p,index:l,open:d,close:m},()=>[st(V(p.content),1)])]),_:2},1032,["class"])],512)),[[vt,d]])]),_:2},1040,["onEnter","onAfterEnter","onBeforeLeave","onLeave"])]),_:2},1032,["class","default-open"]))),128))],2)}const qn=Object.assign(zt(Tn,[["render",An]]),{__name:"UAccordion"}),Mn={key:0,class:"flex flex-col items-center justify-center self-stretch gap-4 py-10"},jn=["textContent"],Qn={class:"flex gap-2"},zn=["textContent"],Hn={class:"relative flex max-md:flex-col flex-wrap gap-4"},Nn={class:"flex items-center gap-2"},Fn=["textContent"],Kn={key:0},Wn=["textContent"],Gn=["textContent"],Xn=["textContent"],Yn=["textContent"],Jn={class:"flex items-center gap-2 font-bold"},Zn=["textContent"],eo=["textContent"],to=["textContent"],no={class:"flex items-center gap-2"},oo={class:"font-bold font-mono"},$e="bookpress",Ve="affiliate",wo=ie({__name:"purchase-link",setup(o){const{LIKE_CO_API:g,SITE_URL:L}=Xt().public,y=Yt(),u=Un(),U=Jt(),{userLikerInfo:h}=Zt(U),_=en(),I=tn(),w=nn(),{t:a}=on(),p=c({get:()=>_.query.share==="1",set:e=>{ct(I({query:{..._.query,share:e?"1":void 0}}),{replace:!0})}}),l=c(()=>p.value?a("purchase_link.sharing_mode_title"):a("purchase_link.generator_mode_title"));an({title:()=>l.value,ogTitle:()=>l.value});const d=b(""),m=c({get:()=>{if(d.value)return d.value;const e=_.query.product_id;return e?Array.isArray(e)?e.join(`
`):e:""},set:e=>{d.value=e}}),D=c(()=>m.value.split(`
`).map(e=>e.trim()).filter(Boolean)),Q=c(()=>D.value[0]||""),qe=c(()=>D.value.map(e=>{let n=e.trim();return n.startsWith("http")&&(n=new URL(n).pathname.split("/").pop()),n?.startsWith("0x")?n:""}).filter(Boolean)),Me=c(()=>qe.value[0]||"");function je(e={}){const n=new URLSearchParams;return e.utmCampaign&&n.set("utm_campaign",e.utmCampaign),e.utmSource&&n.set("utm_source",e.utmSource),e.utmMedium&&n.set("utm_medium",e.utmMedium),n.toString().replace("?","")}const re=b(""),Z=b(!0),ue=b(""),ce=b(""),ke=c(()=>{const e=H.value==="liker_land";return A.value?"custom-link":e?"likerland":"stripe"}),ge=b(""),ee=c({get:()=>ge.value?ge.value:je({utmCampaign:re.value,utmSource:ce.value,utmMedium:ue.value}),set:e=>{ge.value=e}}),yt=c(()=>je({utmCampaign:$e,utmSource:ke.value,utmMedium:Ve})),ye=c(()=>({utm_medium:Ve,utm_source:ke.value,utm_campaign:$e})),z=c(()=>{const e={...ye.value},n=Q.value?.trim()||"";if(n.startsWith("http")){const{searchParams:v}=new URL(n);v.delete("from"),Object.assign(e,Object.fromEntries(v))}return ee.value&&Object.assign(e,Object.fromEntries(new URLSearchParams(ee.value))),e}),Qe=c(()=>Object.entries(z.value).filter(([e])=>!(e==="utm_campaign"&&Z.value)).map(([e,n])=>({key:e,value:n}))),ze=c(()=>[{name:a("purchase_link.liker_land_product"),value:"liker_land"},{name:a("purchase_link.stripe_checkout"),value:"direct"},{name:a("purchase_link.custom_page"),value:"custom"}]),H=b(ze.value[0]?.value||"liker_land"),A=c(()=>H.value==="custom"),N=b(_.query.custom_link||""),Ce=b(""),T=c({get:()=>{if(Ce.value)return Ce.value;const e=_.query.from;return e?Array.isArray(e)?e.join(","):e:""},set:e=>{Ce.value=e}}),te=c(()=>T.value.split(",").map(e=>e.trim()).filter(Boolean).map(e=>{const n=y.getChannelInfoById(e);return{id:e,name:n?.displayName||e}})),He=b(!1),de=c({get:()=>!te.value.length||He.value,set:e=>{He.value=e}}),pe=c(()=>te.value.concat(de.value?Sn:[])),P=c(()=>pe.value.length>1),me=b("");se(Me,()=>{me.value=""});const ne=b("");se(T,()=>{ne.value=""});const F=b(""),Ne=c(()=>!!F.value),Fe=c(()=>A.value?!!N.value:!!Me.value&&!Ne.value),E=b(void 0),fe=c(()=>{const e={};if(E.value)for(const{id:n,data:v}of E.value)v.prices?e[n]=v.prices.map(f=>{let B="";return typeof f.name=="object"?B=f.name?.zh||f.name?.en||"":B=f.name,{label:[B,`$${f.price}`].filter(Boolean).join(" - "),value:f.index||0}}):e[n]=[];return e}),K=b({}),Ke=c(()=>E.value?.map(({id:e,data:n})=>({id:e,name:n.name?.zh||n.name?.en||n.name,editionOptions:fe.value[e]||[]}))||[]),Ct=c(()=>{const e=[];return A.value||e.push({key:"productId",label:a("common.title"),sortable:!0},{key:"selectedEditionLabel",label:a("table.selected_edition")}),p.value||e.push({key:"utmCampaign",label:a("purchase_link.utm_campaign"),sortable:!0}),e.push({key:"link",label:a("common.link")}),e}),Ie=c(()=>{const e=new Map,n=[...new Map(pe.value.map(f=>[f.id,f])).values()];return(A.value?[{id:"custom",data:{name:"Custom"}}]:E.value||[]).forEach(({id:f,data:B})=>{n.forEach(C=>{e.has(C.id)||e.set(C.id,[]);let G=z.value.utm_campaign||ye.value.utm_campaign||"";Z.value&&C.id!==Ln&&(G=`${fn(C.id)}_${G}`);const $=K.value[f]||0,ae={classId:f||"",channel:C.id,priceIndex:$,customLink:A.value?N.value:void 0,isUseLikerLandLink:H.value==="liker_land",query:{utm_campaign:G,...z.value}};e.get(C.id)?.push({productId:f,productName:B.name?.zh||B.name?.en||B.name,selectedEditionIndex:$,selectedEditionLabel:fe.value?.[f]?.[$]?.label||"",channelId:C.id,channelName:C.name,utmCampaign:G,utmMedium:z.value.utm_medium||"",utmSource:z.value.utm_source||"",url:dt(ae),qrCodeUrl:dt({...ae,isForQRCode:z.value.utm_source===ye.value.utm_source})})})}),e}),_e=c(()=>pe.value.flatMap(e=>Ie.value.get(e.id)||[])),oe=e=>Ie.value.get(e)||[],W=b(void 0),he=c({get:()=>!!W.value,set:e=>{e||(W.value=void 0)}});async function It(e){const n=await $fetch(`${g}/likernft/book/store/${e}`);return{id:e,data:n}}async function we(){if(me.value="",E.value=void 0,K.value={},ne.value="",F.value="",!!Fe.value)try{if(te.value.length){F.value=a("purchase_link.validating_channels");const e=te.value.find(n=>!pn(n.id));if(e){ne.value=a("purchase_link.invalid_channel")+` "${e.id}", please enter a valid channel ID starting with "@"`;return}try{await Promise.all(te.value.map(async n=>{const v=await y.lazyFetchChannelInfoById(n.id);if(!v)throw new Error(a("purchase_link.channel_no_liker_id"));const f=await u.fetchStripeConnectStatusByWallet(v.evmWallet);if(!f?.hasAccount)throw new Error(a("purchase_link.channel_no_stripe"));if(!f?.isReady)throw new Error(a("purchase_link.channel_stripe_incomplete"))}))}catch(n){ne.value=n.message,p.value=!1;return}}F.value=a("purchase_link.fetching_product_data");try{const e=await Promise.all(qe.value.map(n=>It(n)));E.value=e}catch(e){me.value=e.message,p.value=!1}}catch(e){console.error(e),w.add({icon:"i-heroicons-exclamation-circle",title:a("purchase_link.failed_create_link"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}}),p.value=!1}finally{F.value=""}}function We(e){const n=[];if(A.value){const v=new URL(N.value);n.push(v.hostname)}else n.push(`${e.productName||e.productId}`);return e.channelId&&n.push(`channel-${e.channelId}`),n.join("_")}async function Ge(e=""){await navigator.clipboard.writeText(e),w.add({icon:"i-heroicons-check-circle",title:a("purchase_link.copied_to_clipboard"),timeout:2e3,color:"green"})}function Xe(e=[],n){mn({data:e.map(({selectedEditionIndex:v,selectedEditionLabel:f,...B})=>({edition:`${v+1}. ${f}`,...B})),fileName:["affiliation_links",n,Date.now()].filter(Boolean).join("_").concat(".csv"),fileType:"csv"})}function wt(){Xe(_e.value)}function xt(e){return()=>Xe(oe(e))}function Ye(e=[]){try{sessionStorage.setItem("nft_book_press_batch_qrcode",ut(e.map(({channelId:n,qrCodeUrl:v,...f})=>({key:n,...f,url:v})))),window.open("/batch-qrcode?print=1","batch_qrcode","popup,menubar=no,location=no,status=no")}catch(n){console.error(n),w.add({icon:"i-heroicons-exclamation-circle",title:a("purchase_link.failed_print_qr"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}}function St(){Ye(_e.value)}function Lt(e){return()=>Ye(oe(e))}function Je(e=[]){try{sessionStorage.setItem("nft_book_press_batch_shorten_url",ut(e.map(({channelId:n,...v})=>({key:n,...v})))),ct(I({name:"batch-short-links",query:{print:1}}))}catch(n){console.error(n),w.add({icon:"i-heroicons-exclamation-circle",title:a("purchase_link.failed_shorten_links"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}}function Ut(){Je(_e.value)}function Dt(e){return()=>Je(oe(e))}function Bt(e){return()=>{const n=new URL(`${L}/affiliation-link`);n.searchParams.set("from",e),n.searchParams.set("share","1"),n.searchParams.set("nav","0"),oe(e).forEach(f=>{n.searchParams.append("product_id",f.productId)}),Ge(n.toString())}}async function Ze(e=[],n){const v=e.map(f=>({url:f.qrCodeUrl,filename:We(f)}));await In(v,{zipFilename:["affiliation_links_qrcodes",n,Date.now()].filter(Boolean).join("_")})}async function $t(){await Ze(_e.value)}function Vt(e){return()=>Ze(oe(e),e)}function xe(){!T.value&&h.value&&(T.value=sn(h.value.user))}return Re(()=>{p.value&&ln(()=>{we()}),xe()}),se(p,e=>{e?we():E.value=void 0}),se(h,()=>{h.value&&xe()}),(e,n)=>{const v=qt,f=Pe,B=_n,C=un,q=cn,G=hn,$=Te,ae=vn,X=rn,Ot=qn,Se=kn,et=gn,Rt=yn,Et=Cn,Tt=dn,Pt=wn,At=xn;return k(),O(At,null,{default:r(()=>[s(v,{title:t(l)},null,8,["title"]),s(Pt,{class:"flex flex-col items-stretch grow space-y-8"},{default:r(()=>[!t(E)&&t(p)||t(Ne)?(k(),j("div",Mn,[s(f,{class:"w-10 h-10 animate-spin",name:"i-heroicons-arrow-path-20-solid"}),x("span",{class:"text-gray-400 dark:text-gray-700 text-sm",textContent:V(t(F)||t(a)("purchase_link.failed_create_link"))},null,8,jn)])):t(E)?(k(),j(Oe,{key:2},[t(p)?Y("",!0):(k(),j("header",Kn,[s($,{icon:"i-heroicons-arrow-uturn-left",label:t(a)("purchase_link.back_to_config"),variant:"soft",onClick:n[10]||(n[10]=i=>E.value=void 0)},null,8,["label"])])),t(P)&&t(Ke).length?(k(),O(X,{key:1,ui:{body:{padding:""}}},{header:r(()=>[x("h3",{class:"text-lg font-bold",textContent:V(t(a)("purchase_link.product_list"))},null,8,Wn)]),default:r(()=>[s(Se,{columns:[{key:"name",label:t(a)("table.name")},{key:"editionSelect",label:t(a)("table.selected_edition")}],rows:t(Ke)},{"name-data":r(({row:i})=>[x("span",{textContent:V(i.name)},null,8,Gn)]),"editionSelect-data":r(({row:i})=>[i.editionOptions.length?(k(),O(B,{key:0,class:"min-w-[200px]","model-value":t(K)[i.id]||0,options:i.editionOptions,"onUpdate:modelValue":S=>t(K)[i.id]=S},null,8,["model-value","options","onUpdate:modelValue"])):Y("",!0)]),_:1},8,["columns","rows"])]),_:1})):Y("",!0),!t(p)&&t(Qe).length?(k(),O(X,{key:2,ui:{body:{padding:""}}},{header:r(()=>[x("h3",{class:"text-lg font-bold",textContent:V(t(a)("purchase_link.common_query_string"))},null,8,Xn)]),default:r(()=>[s(Se,{columns:[{key:"key",label:t(a)("table.key")},{key:"value",label:t(a)("table.value")}],rows:t(Qe),ui:{td:{font:"font-mono"}}},null,8,["columns","rows"])]),_:1})):Y("",!0),s(X,{ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"space-y-8",padding:t(P)?void 0:""}}},rt({default:r(()=>[(k(!0),j(Oe,null,_t(t(pe),i=>(k(),O(X,{key:i.id,ui:{base:"overflow-hidden",ring:t(P)?void 0:"",shadow:t(P)?void 0:"",header:{base:"flex justify-between items-center gap-4"},body:{padding:""}}},{header:r(()=>[x("h3",Jn,[x("span",{class:M(t(P)?"text-md":"text-lg"),textContent:V(i.name)},null,10,Zn),x("span",{class:M([t(P)?"text-xs":"text-sm","text-gray-400 dark:text-gray-700","font-mono"]),textContent:V(i.id)},null,10,eo)]),s(et,{items:[[{label:t(a)("purchase_link.print_qr_codes"),icon:"i-heroicons-qr-code",click:Lt(i.id)},{label:t(a)("purchase_link.download_qr_codes"),icon:"i-heroicons-arrow-down-on-square-stack",click:Vt(i.id)},{label:t(a)("purchase_link.download_links"),icon:"i-heroicons-arrow-down-on-square-stack",click:xt(i.id)},{label:t(a)("purchase_link.shorten_links"),icon:"i-heroicons-sparkles",click:Dt(i.id)},{label:t(a)("purchase_link.share_table"),icon:"i-heroicons-document-duplicate",click:Bt(i.id)}]],popper:{placement:"top-end"}},{default:r(()=>[s($,{icon:"i-heroicons-ellipsis-horizontal-20-solid",color:"gray",size:"sm",variant:"soft"})]),_:1},8,["items"])]),default:r(()=>[s(Se,{columns:t(Ct),rows:t(Ie).get(i.id)},rt({"productId-data":r(({row:S})=>[x("div",{textContent:V(S.productName)},null,8,to)]),"utmCampaign-data":r(({row:S})=>[s(Rt,{class:"font-mono",value:S.utmCampaign},null,8,["value"])]),"link-data":r(({row:S})=>[x("div",no,[s($,{icon:"i-heroicons-qr-code",variant:"outline",size:"xs",onClick:Le=>W.value=S},null,8,["onClick"]),s($,{icon:"i-heroicons-document-duplicate",variant:"outline",size:"xs",onClick:Le=>Ge(S.url||"")},null,8,["onClick"]),s($,{class:"font-mono break-all",label:S.url,to:S.url,color:"gray",variant:"outline",size:"xs",target:"_blank"},null,8,["label","to"])])]),_:2},[t(P)?void 0:{name:"selectedEditionLabel-data",fn:r(({row:S})=>[t(fe)?.[S.productId]?.length?(k(),O(B,{key:0,class:"min-w-[200px]","model-value":t(K)[S.productId]||0,options:t(fe)?.[S.productId]||[],"onUpdate:modelValue":Le=>t(K)[S.productId]=Le},null,8,["model-value","options","onUpdate:modelValue"])):Y("",!0)]),key:"0"}]),1032,["columns","rows"])]),_:2},1032,["ui"]))),128))]),_:2},[t(P)?{name:"header",fn:r(()=>[x("h2",{class:"text-lg font-bold",textContent:V(t(a)("purchase_link.affiliation_links"))},null,8,Yn),s(et,{items:[[{label:t(a)("purchase_link.print_all_qr"),icon:"i-heroicons-qr-code",click:St},{label:t(a)("purchase_link.download_qr_codes"),icon:"i-heroicons-arrow-down-on-square-stack",click:$t},{label:t(a)("purchase_link.download_all_links"),icon:"i-heroicons-arrow-down-on-square-stack",click:wt},{label:t(a)("purchase_link.shorten_all_links"),icon:"i-heroicons-sparkles",click:Ut}]],popper:{placement:"top-end"}},{default:r(()=>[s($,{icon:"i-heroicons-ellipsis-horizontal-20-solid",color:"gray",variant:"soft"})]),_:1},8,["items"])]),key:"0"}:void 0]),1032,["ui"]),s(Tt,{modelValue:t(he),"onUpdate:modelValue":n[12]||(n[12]=i=>R(he)?he.value=i:null)},{default:r(()=>[t(W)?(k(),O(Et,{key:0,data:t(W).qrCodeUrl,"file-name":We(t(W)),width:500,height:500},{header:r(()=>[x("h3",oo,V(t(a)("purchase_link.download_qr_modal")),1),s($,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:n[11]||(n[11]=i=>he.value=!1)})]),_:1},8,["data","file-name"])):Y("",!0)]),_:1},8,["modelValue"])],64)):(k(),O(X,{key:1,ui:{body:{base:"space-y-4"},footer:{base:"flex justify-end"}}},{footer:r(()=>[s($,{label:t(a)("purchase_link.generate"),size:"lg",disabled:!t(Fe),onClick:we},null,8,["label","disabled"])]),default:r(()=>[s(C,{label:t(a)("purchase_link.destination")},{default:r(()=>[s(B,{modelValue:t(H),"onUpdate:modelValue":n[0]||(n[0]=i=>R(H)?H.value=i:null),options:t(ze),"option-attribute":"name"},null,8,["modelValue","options"])]),_:1},8,["label"]),t(A)?(k(),O(C,{key:0,label:t(a)("purchase_link.custom_page_url"),required:!0},{default:r(()=>[s(q,{modelValue:t(N),"onUpdate:modelValue":n[1]||(n[1]=i=>R(N)?N.value=i:null),class:"font-mono",placeholder:"https://3ook.com/store?tag=blockchain",name:"custom_destination_url"},null,8,["modelValue"])]),_:1},8,["label"])):(k(),O(C,{key:1,label:t(a)("purchase_link.product_ids"),error:t(me),required:!0},{default:r(()=>[s(G,{modelValue:t(m),"onUpdate:modelValue":n[2]||(n[2]=i=>R(m)?m.value=i:null),class:"font-mono",placeholder:"0x53c7243b94b3c4a4827816f00d72394ddfb974c4\\n0x146736dd2ccb1dbdf266130a117609e00ad566b1",autoresize:!0,name:"product_id"},null,8,["modelValue"])]),_:1},8,["label","error"])),s(C,{label:t(a)("purchase_link.channel_ids"),hint:t(a)("purchase_link.optional"),error:t(ne),ui:{help:"flex items-center gap-2"}},{help:r(()=>[s(ae,{modelValue:t(de),"onUpdate:modelValue":n[4]||(n[4]=i=>R(de)?de.value=i:null),disabled:!t(T)},null,8,["modelValue","disabled"]),x("span",{textContent:V(t(a)("purchase_link.include_default_channels"))},null,8,zn)]),default:r(()=>[x("div",Qn,[s(q,{modelValue:t(T),"onUpdate:modelValue":n[3]||(n[3]=i=>R(T)?T.value=i:null),class:"grow font-mono",placeholder:t(a)("purchase_link.channel_ids_placeholder"),name:"channel_ids"},null,8,["modelValue","placeholder"]),ht(s($,{class:"relative",label:t(a)("purchase_link.prefill_from_account"),color:"gray",variant:"outline",size:"2xs",onClick:xe},null,8,["label"]),[[vt,!t(T)&&t(h)]])])]),_:1},8,["label","hint","error"]),s(Ot,{color:"gray",variant:"soft",size:"md",items:[{label:t(a)("purchase_link.query_string_optional"),defaultOpen:!0,slot:"body"}],ui:{item:{padding:"p-0"}}},{body:r(()=>[s(X,{ui:{body:{base:"space-y-4"}}},{default:r(()=>[x("div",Hn,[s(C,{class:"flex-1",label:t(a)("purchase_link.utm_campaign")},{default:r(()=>[s(q,{modelValue:t(re),"onUpdate:modelValue":n[5]||(n[5]=i=>R(re)?re.value=i:null),class:"font-mono",name:"utm_campaign",placeholder:`e.g. ${$e}`},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(C,{class:"flex-1",label:t(a)("purchase_link.utm_source")},{default:r(()=>[s(q,{modelValue:t(ce),"onUpdate:modelValue":n[6]||(n[6]=i=>R(ce)?ce.value=i:null),class:"font-mono",name:"utm_source",placeholder:`e.g. ${t(ke)}`},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(C,{class:"flex-1",label:t(a)("purchase_link.utm_medium")},{default:r(()=>[s(q,{modelValue:t(ue),"onUpdate:modelValue":n[7]||(n[7]=i=>R(ue)?ue.value=i:null),class:"font-mono",name:"utm_medium",placeholder:`e.g. ${Ve}`},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),s(C,{label:t(a)("purchase_link.additional_query_string")},{default:r(()=>[s(q,{modelValue:t(ee),"onUpdate:modelValue":n[8]||(n[8]=i=>R(ee)?ee.value=i:null),class:"font-mono",placeholder:t(yt),name:"query_params"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),x("div",Nn,[s(ae,{modelValue:t(Z),"onUpdate:modelValue":n[9]||(n[9]=i=>R(Z)?Z.value=i:null)},null,8,["modelValue"]),x("span",{textContent:V(t(a)("purchase_link.prefix_channel_id"))},null,8,Fn)])]),_:1})]),_:1},8,["items"])]),_:1}))]),_:1})]),_:1})}}});export{wo as default};
