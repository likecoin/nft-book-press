import{a_ as U,b7 as D,a$ as P,bz as L,b8 as w,b9 as x,bb as z,b1 as V,ba as m,b3 as _,aX as d,aT as u,bi as f,b4 as t,bj as j,bD as G,aU as C,aS as W,aW as h,aV as k,br as K}from"./BVgQfaNN.js";import{_ as M}from"./BCu72LcT.js";import{_ as X}from"./B7Q4iAhT.js";import{u as q}from"./C9kugC67.js";import"./CKjq_wLR.js";import"./Tkb2MnXN.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new r.Error().stack;l&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[l]="71393bab-ff04-4ba5-932f-7b1450c21171",r._sentryDebugIdIdentifier="sentry-dbid-71393bab-ff04-4ba5-932f-7b1450c21171")}catch{}})();const F={class:"text-center font-bold font-mono"},H={class:"flex justify-center items-center gap-4"},J=["textContent"],ae=U({__name:"index",setup(r){const{LIKE_CO_API:l}=D().public,{t:s}=P(),y=L(),p=q(),{token:v,wallet:b}=w(y),{getStripeConnectStatusByWallet:T}=w(p),o=x(""),n=x(!1);z(n,e=>{e&&(o.value="")}),V(async()=>{await p.refreshStripeConnectStatus(b.value)});const i=m(()=>T.value(b.value)),c=m(()=>i.value?.isReady),A=m(()=>{if(!i.value?.hasAccount&&!c.value)return s("user_settings.setup_stripe_connect");if(i.value?.hasAccount&&!c.value)return s("user_settings.resume_stripe_connect_setup");if(i.value?.hasAccount&&c.value)return s("user_settings.login_to_stripe")});async function B(){try{n.value=!0,await p.refreshStripeConnectStatus(b.value)}catch(e){o.value=e.toString()}finally{n.value=!1}}async function E(){try{n.value=!0;const a=(await $fetch(`${l}/likernft/book/user/connect/login`,{method:"POST",headers:{authorization:`Bearer ${v.value}`}})).url;if(a)window.open(a);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),o.value=e.toString()}finally{n.value=!1}}async function N(){try{n.value=!0;const a=(await $fetch(`${l}/likernft/book/user/connect/new`,{method:"POST",headers:{authorization:`Bearer ${v.value}`}})).url;if(a)window.open(a);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),o.value=e.toString()}finally{n.value=!1}}async function $(){n.value=!0;try{c.value?await E():await N()}catch(e){console.error(e),o.value=e.toString()}finally{n.value=!1}}return(e,a)=>{const g=j,S=K,I=M,R=G,O=X;return u(),_(O,null,{default:d(()=>[t(o)?(u(),_(g,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${t(o)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:a[0]||(a[0]=Q=>o.value="")},null,8,["title"])):f("",!0),t(c)?f("",!0):(u(),_(g,{key:1,icon:"i-heroicons-exclamation-circle",color:"orange",variant:"soft",title:t(s)("user_settings.stripe_express_notice"),description:t(s)("user_settings.stripe_express_description")},null,8,["title","description"])),t(y).isAuthenticated?(u(),_(R,{key:2,ui:{header:{base:"flex justify-between items-center"},body:{padding:""},footer:{base:"text-center"}}},{header:d(()=>[C("h1",F,k(t(s)("user_settings.stripe_payout_status")),1),h(I,{text:"Refresh Status",popper:{placement:"left"}},{default:d(()=>[h(S,{icon:"i-heroicons-arrow-path",variant:"outline",disabled:t(n),onClick:B},null,8,["disabled"])]),_:1})]),footer:d(()=>[C("div",H,[t(i)?.hasAccount&&t(c)?(u(),W("span",{key:0,class:"text-sm text-gray-500",textContent:k(t(i).email)},null,8,J)):f("",!0),h(S,{label:t(A),size:"md",loading:t(n),disabled:t(n),color:"black",onClick:$},null,8,["label","loading","disabled"])])]),_:1})):f("",!0)]),_:1})}}});export{ae as default};
