import{a_ as z,b9 as _,b1 as j,bY as ne,b4 as a,bk as le,b0 as re,a$ as ce,bz as ie,b8 as de,bh as ue,ba as d,bb as V,b3 as v,aX as r,b2 as P,aT as u,bi as F,aW as m,bj as me,bf as _e,aY as pe,bD as be,bd as U,aS as B,aV as A,aU as C,bo as fe,bp as ge,be as ye,bw as ve}from"./BVdfQj5Q.js";import{_ as ke}from"./DHGZTKUm.js";import{a as q}from"./BxLGC7pa.js";import{_ as Ie}from"./B0sW_yEE.js";import{_ as we}from"./clHF8n0p.js";import{_ as xe}from"./x7zgvyYO.js";import"./Cq7NStM5.js";import"./xd2UgJzt.js";(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p=new c.Error().stack;p&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[p]="bda6ca27-c8df-4fac-b14b-acbb1dc98322",c._sentryDebugIdIdentifier="sentry-dbid-bda6ca27-c8df-4fac-b14b-acbb1dc98322")}catch{}})();const he=z({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(c){const p=q(),g=c,s=_(!1);return j(async()=>{try{s.value=!0,await p.lazyFetchClassMetadataById(g.classId)}catch{}finally{s.value=!1}}),(k,T)=>ne(k.$slots,"default",{isLoading:a(s)})}}),Le={class:"flex justify-between items-center w-full"},Se={class:"flex gap-2 items-center"},Ue={class:"text-sm leading-5"},Ce={class:"flex gap-1"},Te={key:1,class:"max-w-xs truncate"},Fe=z({__name:"index",setup(c){const p=le(),g=re(),{t:s}=ce(),k=ie(),T=q(),{listingList:R,moderatedBookList:$,token:E}=de(k),{lazyFetchClassMetadataById:Y}=T,{fetchBookListing:W,fetchModeratedBookList:X}=k,I=_(""),D=_(!1);ue({title:()=>s("seo_titles.book_listing_management"),ogTitle:()=>s("seo_titles.book_listing_management")});const w=d(()=>[{label:s("bookstore.current_listing"),key:"current"},{label:s("bookstore.viewable_listing"),key:"viewable"}]),y=d({get(){const e=w.value.findIndex(t=>t.key===p.query.tab);return e===-1?0:e},set(e){P(g({query:{tab:w.value[e].key}}),{replace:!0})}}),b=_(""),x=_({column:"pendingAction",direction:"desc"}),f=_(50),l=_(1),G=d(()=>(l.value-1)*f.value+1),H=d(()=>Math.min(l.value*f.value,h.value.length)),h=d(()=>(w.value[y.value].key==="viewable"?$:R).value.map(e=>{var t,o,i;return{classId:e.classId,className:(t=T.getClassMetadataById(e.classId))==null?void 0:t.name,priceInUSD:(o=e.prices)==null?void 0:o[0].price,prices:(i=e.prices)==null?void 0:i.map(N=>N.price),pendingAction:e.pendingNFTCount,sold:e.sold}}).filter(e=>{if(!b.value)return!0;const t=b.value.toLowerCase();return e.classId.toLowerCase().includes(t)||e.className.toLowerCase().includes(t)})),J=d(()=>{const{column:e,direction:t}=x.value;return h.value.sort((o,i)=>o[e]<i[e]?t==="asc"?-1:1:o[e]>i[e]?t==="asc"?1:-1:0)}),K=d(()=>J.value.slice((l.value-1)*f.value,l.value*f.value)),O=d(()=>[{key:"pendingAction",label:s("table.pending_action"),sortable:!0},{key:"className",label:s("table.class_name"),sortable:!0},{key:"priceInUSD",label:s("table.price_in_usd"),sortable:!0},{key:"sold",label:s("table.sold"),sortable:!0},{key:"classId",label:s("bookstore.class_id"),sortable:!0,class:"font-mono"}]);V(D,e=>{e&&(I.value="")}),V(y,()=>{b.value="",l.value=1}),V(f,()=>{l.value=1}),j(async()=>{const e=[W()];E.value&&e.push(X()),await Promise.all(e),new Set(R.value.map(o=>o.classId).concat($.value.map(o=>o.classId))).forEach(o=>Y(o))});async function Q(e){await P(g({name:"my-books-status-classId",params:{classId:e.classId}}))}return(e,t)=>{const o=me,i=_e,N=ke,Z=ve,ee=ye,te=he,ae=Ie,M=be,se=we,oe=xe;return u(),v(oe,{ui:{constrained:""}},{default:r(()=>[a(I)?(u(),v(o,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${a(I)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:t[0]||(t[0]=L=>I.value="")},null,8,["title"])):F("",!0),a(D)?(u(),v(i,{key:1,animation:"carousel"},{indicator:r(()=>t[5]||(t[5]=[pe(" Loading... ")])),_:1})):F("",!0),m(M,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:r(()=>[m(se,{modelValue:a(y),"onUpdate:modelValue":t[4]||(t[4]=L=>U(y)?y.value=L:null),class:"w-full",items:a(w)},{item:r(({item:L})=>[(u(),v(M,{key:L.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:r(()=>[C("div",Le,[C("div",Se,[m(N,{modelValue:a(l),"onUpdate:modelValue":t[1]||(t[1]=n=>U(l)?l.value=n:null),"page-count":a(f),total:a(h).length},null,8,["modelValue","page-count","total"]),C("span",Ue,A(a(s)("table.showing_rows",{from:a(G),to:a(H),total:a(h).length})),1)]),m(Z,{modelValue:a(b),"onUpdate:modelValue":t[2]||(t[2]=n=>U(b)?b.value=n:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:a(s)("table.search_placeholder")},null,8,["modelValue","placeholder"])])]),default:r(()=>[m(ae,{sort:a(x),"onUpdate:sort":t[3]||(t[3]=n=>U(x)?x.value=n:null),columns:a(O),rows:a(K),onSelect:Q},{"priceInUSD-data":r(({row:n})=>[C("ul",Ce,[(u(!0),B(fe,null,ge(n.prices,S=>(u(),B("li",{key:S},[m(ee,{label:`$${S}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":r(({row:n})=>[m(te,{"class-id":n.classId},{default:r(({isLoading:S})=>[S||!n.className?(u(),v(i,{key:0})):(u(),B("div",Te,A(n.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})}}});export{Fe as default};
