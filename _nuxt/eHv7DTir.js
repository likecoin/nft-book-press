import{a_ as ve,bx as ge,bm as ye,b0 as _e,b7 as xe,b8 as i,b9 as K,b1 as he,aS as ee,aW as o,aX as t,bh as ke,aT as D,bt as we,b3 as j,br as oe,b4 as l,bO as Ve,aY as N,aU as c,bQ as M,bf as d,cQ as Ie,bR as Ue,bD as Pe,bq as Ce,bg as Se,b2 as le,bM as Ee}from"./C7XQIrPM.js";import{_ as Te}from"./DvV_81yL.js";import{_ as De}from"./CROjSDN2.js";import{_ as Ne,a as Re}from"./CZhspGV5.js";import{_ as Ae}from"./Ev_aRQXW.js";import{c as Me,_ as Be,E as te,p as ze}from"./BN5PBCdi.js";import{_ as Le}from"./ciiQ9bXN.js";import{_ as Fe,a as $e,b as Oe}from"./DIcGmy8B.js";import{_ as je}from"./CjYJqPtf.js";import{u as qe}from"./C6NCxhyU.js";import"./D_LCcsEc.js";import"./BimtM7Sk.js";import"./BRjOu1Ku.js";(function(){try{var x=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p=new x.Error().stack;p&&(x._sentryDebugIds=x._sentryDebugIds||{},x._sentryDebugIds[p]="7e53f776-1d36-45ba-b60a-21d03b20ad66",x._sentryDebugIdIdentifier="sentry-dbid-7e53f776-1d36-45ba-b60a-21d03b20ad66")}catch{}})();const Ge=["src"],no=ve({__name:"edit",setup(x){const p=ge(),q=qe(),ae=ye(),G=_e(),B=xe(),f=i(ae.params.collectionId),b=i(!1),s=i({}),z=i([]),v=i(Ee),k=i(1),w=i("auto"),V=i("Thanks for purchasing this NFT ebook."),I=i("Standard Edition"),U=i("標準版"),P=i(""),C=i(""),g=i(""),S=i(!1),h=i(!0),E=i(!1),y=i(!1),L=i([]),F=i(!1),H=i(0),$=i(!1),Q=i(["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"]),X=i({en:"Product description in English...",zh:"產品中文描述..."}),Y=K(()=>w.value==="auto"),ne=K(()=>$.value?H.value:0),{getClassMetadataById:ie}=q;Me({markdownItConfig(n){n.options.html=!1}});function se(n){const e=n.target.value,u=v.value;Number(u)!==0&&Number(e)===0&&(h.value=!0)}he(async()=>{var n,e,u,_;try{b.value=!0,s.value=await p.fetchCollectionById(f.value);const r=s.value.typePayload;r&&(s.value={...s.value,...r}),z.value=s.value.classIds||[],v.value=s.value.priceInDecimal/100||0,k.value=s.value.stock||0,I.value=((n=s.value.name)==null?void 0:n.en)||"",U.value=((e=s.value.name)==null?void 0:e.zh)||"",g.value=s.value.image||"",P.value=((u=s.value.description)==null?void 0:u.en)||" ",C.value=((_=s.value.description)==null?void 0:_.zh)||" ",S.value=s.value.hasShipping||!1,L.value=s.value.shippingRates||[],y.value=s.value.isPhysicalOnly||!1,h.value=s.value.isAllowCustomPrice||!1,E.value=s.value.isUnlisted||!1,w.value=s.value.isAutoDeliver?"auto":"manual",V.value=s.value.autoMemo||"",H.value=s.value.stock,$.value=s.value.isAutoDeliver}catch(r){console.error(r),B.add({icon:"i-heroicons-exclamation-circle",title:r.toString(),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}finally{b.value=!1}});function Z(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function W(n){return ze.sanitize(n)}async function ue(){await le(G({name:"nft-book-store-collection-status-collectionId",params:{collectionId:f.value}}))}async function re(n){var e;F.value=!0;try{await p.updateNFTBookCollectionById(f.value,{shippingRates:n});const u=await p.fetchCollectionById(f.value);L.value=(e=u==null?void 0:u.typePayload)==null?void 0:e.shippingRates}catch(u){const _=u.data||u;console.error(_),B.add({icon:"i-heroicons-exclamation-circle",title:_,timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}finally{F.value=!1}}async function de(){try{const n={classIds:z.value,name:{en:I.value,zh:U.value},description:{en:Z(P.value),zh:Z(C.value)},image:g.value,priceInDecimal:Math.round(Number(v.value)*100),price:Number(v.value),stock:Number(k.value),isAutoDeliver:!y.value&&Y.value,autoMemo:V.value||"",hasShipping:S.value||!1,isPhysicalOnly:y.value||!1,isAllowCustomPrice:h.value??!0,isUnlisted:E.value??!1};if(!n||n.price===void 0)throw new Error("Please input price of edition");if(n.price!==0&&n.price<M)throw new Error(`Price of each edition must be at least $${M} or $0 (free)`);if(!n.stock&&n.stock!==0)throw new Error("Please input stock of edition");if(n.stock<0)throw new Error("Stock cannot be negative");if(!n.name.en||!n.name.zh)throw new Error("Please input product name");b.value=!0,await p.updateNFTBookCollectionById(f.value,n),await le(G({name:"nft-book-store-collection-status-collectionId",params:{collectionId:f.value}}))}catch(n){const e=n.data||n;console.error(e),B.add({icon:"i-heroicons-exclamation-circle",title:e,timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}finally{b.value=!1}}return(n,e)=>{const u=Se,_=Ve,r=Te,m=De,me=Ne,T=we,ce=Ae,R=Pe,A=Be,O=Re,pe=Le,fe=ke;return D(),ee("div",null,[o(fe,{"model-value":!0,ui:{width:"sm:max-w-7xl"}},{default:t(()=>[o(T,{ui:{header:{base:"flex justify-between items-center"},body:{base:"space-y-4"},footer:{base:"flex justify-end items-center"}}},{header:t(()=>[e[13]||(e[13]=c("h2",{class:"font-bold font-mono"}," Edit collection info ",-1)),o(u,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:ue})]),footer:t(()=>[o(u,{label:"Save Changes",loading:l(b),size:"lg",disabled:l(b),onClick:de},null,8,["loading","disabled"])]),default:t(()=>[l(b)?(D(),j(_,{key:0,animation:"carousel"},{indicator:t(()=>e[14]||(e[14]=[N(" Loading... ")])),_:1})):oe("",!0),o(T,{ui:{body:{base:"space-y-4"}}},{header:t(()=>e[15]||(e[15]=[c("h2",{class:"font-bold font-mono"}," Class Info ",-1)])),default:t(()=>[o(m,{label:"NFT collection ID"},{default:t(()=>[o(r,{class:"font-mono",value:l(f),readonly:!0,disabled:!0},null,8,["value"])]),_:1}),o(m,{label:"Books in Collection"},{default:t(()=>[o(T,{ui:{body:{padding:""}}},{default:t(()=>[o(me,{columns:[{key:"classId",label:"Class ID"},{key:"name",label:"Book Name"}],rows:l(z).map((a,be)=>{var J;return{index:be,classId:a,name:(J=l(ie)(a))==null?void 0:J.name}})},null,8,["rows"])]),_:1})]),_:1})]),_:1}),o(T,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:t(()=>e[16]||(e[16]=[c("h3",{class:"font-bold font-mono"}," Pricing and Availability ",-1)])),default:t(()=>[o(m,{label:`Price(USD) of this collection (Minimal ${l(M)} or $0 (free)) / 版本定價（美金）`},{default:t(()=>[o(r,{modelValue:l(v),"onUpdate:modelValue":e[0]||(e[0]=a=>d(v)?v.value=a:null),type:"number",step:"0.01",min:l(M),onInput:se},null,8,["modelValue","min"])]),_:1},8,["label"]),o(m,{label:"Total number of NFT for sale of this collection / 此定價上架的數量"},{default:t(()=>[o(r,{modelValue:l(k),"onUpdate:modelValue":e[1]||(e[1]=a=>d(k)?k.value=a:null),type:"number",step:"1",min:l(ne),max:l(Ie)},null,8,["modelValue","min","max"])]),_:1}),o(ce,{modelValue:l(w),"onUpdate:modelValue":e[2]||(e[2]=a=>d(w)?w.value=a:null),disabled:l($)||l(y),legend:"Delivery method of this collection / 自動或手動發書",options:l(Ue)},null,8,["modelValue","disabled","options"]),l(Y)?(D(),j(m,{key:0},{label:t(()=>[e[18]||(e[18]=N(" Memo of this collection / 自動發書留言 ")),o(A,null,{image:t(()=>e[17]||(e[17]=[c("img",{src:Fe,class:"object-cover",alt:""},null,-1)])),default:t(()=>[o(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:t(()=>[o(r,{modelValue:l(V),"onUpdate:modelValue":e[3]||(e[3]=a=>d(V)?V.value=a:null)},null,8,["modelValue"])]),_:1})):(D(),j(m,{key:1,label:"Is Physical only good / 只含實體書",ui:{label:{base:"font-mono font-bold"}}},{default:t(()=>[o(O,{modelValue:l(y),"onUpdate:modelValue":e[4]||(e[4]=a=>d(y)?y.value=a:null),name:"isPhysicalOnly",label:"This collection does not contain any digital file/NFT"},null,8,["modelValue"])]),_:1})),o(m,null,{label:t(()=>[e[20]||(e[20]=N(" Allow custom price / 開啟打賞功能 ")),o(A,{"image-style":{width:"300px"}},{image:t(()=>e[19]||(e[19]=[c("img",{src:$e,class:"object-cover",alt:""},null,-1)])),default:t(()=>[o(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:t(()=>[o(O,{modelValue:l(h),"onUpdate:modelValue":e[5]||(e[5]=a=>d(h)?h.value=a:null),name:"isAllowCustomPrice",label:"Allow user to pay more than defined price"},null,8,["modelValue"])]),_:1}),o(m,{label:"Unlist Edition / 暫時下架"},{default:t(()=>[o(O,{modelValue:l(E),"onUpdate:modelValue":e[6]||(e[6]=a=>d(E)?E.value=a:null),name:"isUnlisted",label:"Pause selling of this Edition"},null,8,["modelValue"])]),_:1})]),_:1}),o(T,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:t(()=>e[21]||(e[21]=[c("h3",{class:"font-bold font-mono"}," Product Information ",-1)])),default:t(()=>[o(m,{label:"Product Name",ui:{container:"space-y-2"}},{label:t(()=>[e[23]||(e[23]=N(" Product Name / 產品名稱（英文） ")),o(A,{"image-style":{width:"250px"}},{image:t(()=>e[22]||(e[22]=[c("img",{src:je,class:"object-cover",alt:""},null,-1)])),default:t(()=>[o(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:t(()=>[o(r,{modelValue:l(I),"onUpdate:modelValue":e[7]||(e[7]=a=>d(I)?I.value=a:null),placeholder:"Product name in English"},null,8,["modelValue"]),e[24]||(e[24]=c("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"Description (Optional) / 描述（選填）",-1)),o(l(te),{modelValue:l(P),"onUpdate:modelValue":e[8]||(e[8]=a=>d(P)?P.value=a:null),language:"en-US","editor-id":"en",placeholder:l(X).en,toolbars:l(Q),sanitize:W,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder","toolbars"])]),_:1,__:[24]}),o(m,{ui:{container:"space-y-2 my-[20px]"}},{label:t(()=>[e[26]||(e[26]=N(" 產品名稱（中文） ")),o(A,{"image-style":{width:"250px"}},{image:t(()=>e[25]||(e[25]=[c("img",{src:Oe,class:"object-cover",alt:""},null,-1)])),default:t(()=>[o(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:t(()=>[o(r,{modelValue:l(U),"onUpdate:modelValue":e[9]||(e[9]=a=>d(U)?U.value=a:null),placeholder:"產品中文名字"},null,8,["modelValue"]),e[27]||(e[27]=c("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),o(l(te),{modelValue:l(C),"onUpdate:modelValue":e[10]||(e[10]=a=>d(C)?C.value=a:null),language:"en-US","editor-id":"zh",placeholder:l(X).zh,toolbars:l(Q),sanitize:W,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder","toolbars"])]),_:1,__:[27]}),o(m,{label:"Image of this book collection",ui:{container:"space-y-2"}},{default:t(()=>[o(r,{modelValue:l(g),"onUpdate:modelValue":e[11]||(e[11]=a=>d(g)?g.value=a:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),l(g)?(D(),ee("img",{key:0,src:l(Ce)(l(g)),class:"w-1/3"},null,8,Ge)):oe("",!0)]),_:1})]),_:1}),o(pe,{modelValue:l(S),"onUpdate:modelValue":e[12]||(e[12]=a=>d(S)?S.value=a:null),"is-show-physical-goods-checkbox":!0,"shipping-info":l(L),"is-loading":l(F),onUpdateShippingRates:re},null,8,["modelValue","shipping-info","is-loading"])]),_:1})]),_:1})])}}});export{no as default};
