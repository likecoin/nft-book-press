import{bM as ee,bN as E,bO as me,aQ as be,a_ as H,aS as M,aT as d,bP as _,b3 as g,br as F,bQ as S,bi as te,bj as ae,bg as se,bR as ve,bS as K,b9 as b,b8 as $,b1 as oe,b4 as l,bm as ge,b0 as ye,a$ as he,bk as ke,bn as Be,ba as Y,aX as I,b2 as Z,aW as V,bs as Ce,by as we,aY as Ie,bt as Pe,bf as D,aV as x,aU as q,bT as Le}from"./Dq4rT-N9.js";import{_ as Ne}from"./B4gIQhUf.js";import{u as ne}from"./BMBfczuj.js";import{_ as ze}from"./B1WyV98J.js";import{_ as $e}from"./BacxtZVP.js";import{_ as Fe}from"./CxQjuV1Y.js";import"./DUA9JB9s.js";import"./u5jSbuzZ.js";import"./CcViUbx4.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},h=new e.Error().stack;h&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[h]="e3933a14-2cdf-4563-925f-bf07ed6115e3",e._sentryDebugIdIdentifier="sentry-dbid-e3933a14-2cdf-4563-925f-bf07ed6115e3")}catch{}})();const Oe={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},N=ee(E.ui.strategy,E.ui.pagination,Oe),Ue=ee(E.ui.strategy,E.ui.button,me),Se=H({components:{UButton:se},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>N.default.size,validator(e){return Object.keys(Ue.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>N.default.activeButton},inactiveButton:{type:Object,default:()=>N.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>N.default.firstButton},lastButton:{type:Object,default:()=>N.default.lastButton},prevButton:{type:Object,default:()=>N.default.prevButton},nextButton:{type:Object,default:()=>N.default.nextButton},divider:{type:String,default:"â€¦"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:h}){const{ui:P,attrs:i}=ve("pagination",K(e,"ui"),N,K(e,"class")),r=b({get(){return e.modelValue},set(n){h("update:modelValue",n)}}),k=b(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(n,u)=>u+1)),y=b(()=>{const n=k.value.length,u=r.value,B=Math.max(e.max,5),c=Math.floor((Math.min(B,n)-5)/2),C=u-c,f=u+c,G=C-1>1,R=f+1<n,t=[];if(n<=B){for(let p=1;p<=n;p++)t.push(p);return t}if(t.push(1),G&&t.push(e.divider),!R){const p=u+c+2-n;for(let w=u-c-p;w<=u-c-1;w++)t.push(w)}for(let p=Math.max(2,C);p<=Math.min(n,f);p++)t.push(p);if(!G){const p=1-(u-c-2);for(let w=u+c+1;w<=u+c+p;w++)t.push(w)}return R&&t.push(e.divider),f<n&&t.push(n),t.length>=3&&t[1]===e.divider&&t[2]===3&&(t[1]=2),t.length>=3&&t[t.length-2]===e.divider&&t[t.length-1]===t.length&&(t[t.length-2]=t.length-1),t}),a=b(()=>r.value>1),z=b(()=>r.value<k.value.length);function O(){a.value&&(r.value=1)}function W(){z.value&&(r.value=k.value.length)}function Q(n){typeof n!="string"&&(r.value=n)}function U(){a.value&&r.value--}function T(){z.value&&r.value++}return{ui:P,attrs:i,currentPage:r,pages:k,displayedPages:y,canGoLastOrNext:z,canGoFirstOrPrev:a,onClickPrev:U,onClickNext:T,onClickPage:Q,onClickFirst:O,onClickLast:W}}});function Ve(e,h,P,i,r,k){const y=se;return d(),M("div",S({class:e.ui.wrapper},e.attrs),[_(e.$slots,"first",{onClick:e.onClickFirst,canGoFirst:e.canGoFirstOrPrev},()=>{var a;return[e.firstButton&&e.showFirst?(d(),g(y,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),_(e.$slots,"prev",{onClick:e.onClickPrev,canGoPrev:e.canGoFirstOrPrev},()=>{var a;return[e.prevButton?(d(),g(y,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage-1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),(d(!0),M(te,null,ae(e.displayedPages,(a,z)=>{var O;return d(),g(y,S({key:`${a}-${z}`,to:typeof a=="number"?(O=e.to)==null?void 0:O.call(e,a):null,size:e.size,disabled:e.disabled,label:`${a}`},{ref_for:!0},a===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof a=="string","z-[1]":a===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(a)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),_(e.$slots,"next",{onClick:e.onClickNext,canGoNext:e.canGoLastOrNext},()=>{var a;return[e.nextButton?(d(),g(y,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage+1),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),_(e.$slots,"last",{onClick:e.onClickLast,canGoLast:e.canGoLastOrNext},()=>{var a;return[e.lastButton&&e.showLast?(d(),g(y,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.pages.length),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]})],16)}const _e=be(Se,[["render",Ve]]),Me=H({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(e){const h=ne(),P=e,i=$(!1);return oe(async()=>{try{i.value=!0,await h.lazyFetchClassMetadataById(P.classId)}catch{}finally{i.value=!1}}),(r,k)=>_(r.$slots,"default",{isLoading:l(i)})}}),Te={class:"flex justify-between items-center w-full"},Ge={class:"flex gap-2 items-center"},Re={class:"text-sm leading-5"},je={class:"flex gap-1"},Ae={key:1,class:"max-w-xs truncate"},Ke=H({__name:"index",setup(e){const h=ge(),P=ye(),{t:i}=he(),r=ke(),k=ne(),{listingList:y,moderatedBookList:a,token:z}=Be(r),{lazyFetchClassMetadataById:O}=k,{fetchBookListing:W,fetchModeratedBookList:Q}=r,U=$(""),T=$(!1),n=b(()=>[{label:i("bookstore.current_listing"),key:"current"},{label:i("bookstore.viewable_listing"),key:"viewable"}]),u=b({get(){const s=n.value.findIndex(o=>o.key===h.query.tab);return s===-1?0:s},set(s){Z(P({query:{tab:n.value[s].key}}),{replace:!0})}}),B=$(""),c=$({column:"pendingAction",direction:"desc"}),C=$(50),f=$(1),G=b(()=>(f.value-1)*C.value+1),R=b(()=>Math.min(f.value*C.value,t.value.length)),t=b(()=>(n.value[u.value].key==="viewable"?a:y).value.map(s=>{var o,m,L;return{classId:s.classId,className:(o=k.getClassMetadataById(s.classId))==null?void 0:o.name,priceInUSD:(m=s.prices)==null?void 0:m[0].price,prices:(L=s.prices)==null?void 0:L.map(X=>X.price),pendingAction:s.pendingNFTCount,sold:s.sold}}).filter(s=>{if(!B.value)return!0;const o=B.value.toLowerCase();return s.classId.toLowerCase().includes(o)||s.className.toLowerCase().includes(o)})),p=b(()=>{const{column:s,direction:o}=c.value;return t.value.sort((m,L)=>m[s]<L[s]?o==="asc"?-1:1:m[s]>L[s]?o==="asc"?1:-1:0)}),w=b(()=>p.value.slice((f.value-1)*C.value,f.value*C.value)),le=b(()=>[{key:"pendingAction",label:i("table.pending_action"),sortable:!0},{key:"className",label:i("table.class_name"),sortable:!0},{key:"priceInUSD",label:i("table.price_in_usd"),sortable:!0},{key:"sold",label:i("table.sold"),sortable:!0},{key:"classId",label:i("bookstore.class_id"),sortable:!0,class:"font-mono"}]);Y(T,s=>{s&&(U.value="")}),Y(u,()=>{B.value="",f.value=1}),Y(C,()=>{f.value=1}),oe(async()=>{const s=[W()];z.value&&s.push(Q()),await Promise.all(s),new Set(y.value.map(m=>m.classId).concat(a.value.map(m=>m.classId))).forEach(m=>O(m))});async function ie(s){await Z(P({name:"my-books-status-classId",params:{classId:s.classId}}))}return(s,o)=>{const m=Ce,L=we,X=_e,re=Ne,ue=Le,de=Me,ce=ze,J=Pe,fe=$e,pe=Fe;return d(),g(pe,{ui:{constrained:""}},{default:I(()=>[l(U)?(d(),g(m,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${l(U)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:o[0]||(o[0]=j=>U.value="")},null,8,["title"])):F("",!0),l(T)?(d(),g(L,{key:1,animation:"carousel"},{indicator:I(()=>o[5]||(o[5]=[Ie(" Loading... ")])),_:1})):F("",!0),V(J,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:I(()=>[l(r).isAuthenticated?(d(),g(fe,{key:0,modelValue:l(u),"onUpdate:modelValue":o[4]||(o[4]=j=>D(u)?u.value=j:null),class:"w-full",items:l(n)},{item:I(({item:j})=>[(d(),g(J,{key:j.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:I(()=>[q("div",Te,[q("div",Ge,[V(X,{modelValue:l(f),"onUpdate:modelValue":o[1]||(o[1]=v=>D(f)?f.value=v:null),"page-count":l(C),total:l(t).length},null,8,["modelValue","page-count","total"]),q("span",Re,x(l(i)("table.showing_rows",{from:l(G),to:l(R),total:l(t).length})),1)]),V(re,{modelValue:l(B),"onUpdate:modelValue":o[2]||(o[2]=v=>D(B)?B.value=v:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:l(i)("table.search_placeholder")},null,8,["modelValue","placeholder"])])]),default:I(()=>[V(ce,{sort:l(c),"onUpdate:sort":o[3]||(o[3]=v=>D(c)?c.value=v:null),columns:l(le),rows:l(w),onSelect:ie},{"priceInUSD-data":I(({row:v})=>[q("ul",je,[(d(!0),M(te,null,ae(v.prices,A=>(d(),M("li",{key:A},[V(ue,{label:`$${A}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":I(({row:v})=>[V(de,{"class-id":v.classId},{default:I(({isLoading:A})=>[A||!v.className?(d(),g(L,{key:0})):(d(),M("div",Ae,x(v.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])):F("",!0)]),_:1})]),_:1})}}});export{Ke as default};
