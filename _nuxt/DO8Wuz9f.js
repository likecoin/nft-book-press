import{n as Be,T as Ee,q as Re,v as Fe,a2 as We,s as te,M as $e,u as Oe,r as s,a4 as ze,C as L,z as Le,h as je,y as qe,o as g,B as N,w as a,a5 as He,F as o,N as T,d as A,c as J,b as l,a as u,G as v,a6 as j,a7 as Ge,W as Ze,H as Ke,Z as Qe,a3 as Je,K as Xe,Q as Ye,a8 as eo,a9 as oo,_ as lo}from"./CQCxTdTH.js";import{_ as to,a as ao}from"./6_AXLUaQ.js";import{_ as no}from"./DlpZDsvL.js";import{_ as so}from"./D019nh47.js";import{_ as io}from"./D2XisxhJ.js";import{j as uo,u as ro,p as mo,_ as co}from"./CHkFhrWK.js";import{_ as po}from"./B9InFHO-.js";import{_ as fo}from"./tYHjd0KY.js";import{_ as bo}from"./D0wWhsw8.js";import{_ as vo,a as yo,b as go}from"./D1hMCN7a.js";import{u as wo}from"./B2kReUJg.js";import{u as ho}from"./DWpbi4lx.js";import"./5RxetXBO.js";import"./DENgb8v9.js";import"./B6K0MkTD.js";import"./BSgsPQMZ.js";import"./CnGkSZgM.js";(function(){try{var V=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D=new Error().stack;D&&(V._sentryDebugIds=V._sentryDebugIds||{},V._sentryDebugIds[D]="ca87ac09-9ccd-408a-82a9-6a2e2c9a0eeb",V._sentryDebugIdIdentifier="sentry-dbid-ca87ac09-9ccd-408a-82a9-6a2e2c9a0eeb")}catch{}})();const _o={class:"flex items-start gap-[12px] w-full px-[12px] mb-[12px]"},ko=["src"],xo={class:"flex gap-2"},Co={class:"flex justify-end items-center"},Vo={class:"flex justify-between items-center w-full"},Uo={key:0,class:"mt-[24px] flex flex-col gap-[12px]"},So={class:"flex gap-2"},Io={class:"flex justify-end items-center"},Po={class:"grid md:grid-cols-2 gap-4"},No=Be({__name:"new",setup(V){const{LCD_URL:D}=Ee().public,q=Re(),ae=Fe(),ne=We(),se=wo(),X=ho(),{wallet:w,signer:H}=te(q),{initIfNecessary:ie}=q,{newNFTBookCollection:ue}=ne,{getClassMetadataById:re,lazyFetchClassMetadataById:de}=se,{fetchStripeConnectStatusByWallet:me}=X,{getStripeConnectStatusByWallet:ce}=te(X),pe=$e(),Y=Oe(),U=s(""),y=s(!1),fe=s({en:"Collection description in English...",zh:"套裝中文描述..."}),be=s("New Book Collection Name"),M=s("新書集名稱"),ve=s(""),B=s(""),_=s(""),h=s(""),k=s([]),i=s({price:ze,stock:Number(Y.query.count||1),hasShipping:!1,isPhysicalOnly:!1,isAllowCustomPrice:!0,isUnlisted:!1,deliveryMethod:"auto",autoMemo:"Thank you for your support. It means a lot to me."}),x=s([]),E=s([]),R=s([]),f=s(""),b=s(""),F=s(!0),W=s(!1),$=s(!1),S=s(!1),I=s(""),G=s(!1),Z=s(!0),ye=["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"],ge=L(()=>"Submit"),we=L(()=>[{key:"wallet",label:"Wallet",sortable:!0},{key:"remove",label:"",sortable:!1}]),he=L(()=>E.value.map((n,e)=>({index:e,wallet:n,walletLink:He(n)}))),_e=L(()=>R.value.map((n,e)=>({index:e,email:n})));uo({markdownItConfig(n){n.options.html=!1}}),Le(async()=>{try{y.value=!0;try{await me(w.value)}catch(n){console.error(n)}ce.value(w.value).isReady&&(S.value=!0,I.value=w.value)}catch(n){console.error(n)}finally{y.value=!1}}),je(y,n=>{n&&(U.value="")}),qe({title:"New Book Collection",ogTitle:"New Book Collection"});function ke(n){Number(n.data)===0&&(i.value.isAllowCustomPrice=!0)}function xe(){k.value.push(h.value),de(h.value),h.value=""}function Ce(n){x.value=n}function Ve(){f.value&&(E.value.push(f.value),f.value="")}function Ue(){b.value&&(R.value.push(b.value),b.value="")}function Se(n){I.value=n,G.value=!0}function Ie(n){return{priceInDecimal:Math.round(Number(n.price)*100),stock:Number(n.stock),hasShipping:!!(n.hasShipping||x.value.length),isPhysicalOnly:!!n.isPhysicalOnly,isAllowCustomPrice:!!(n.isAllowCustomPrice??!0),isUnlisted:!!(n.isUnlisted??!1),isAutoDeliver:!n.isPhysicalOnly&&n.deliveryMethod==="auto",autoMemo:n.autoMemo}}function ee(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Pe(n){return mo.sanitize(n)}async function Ne(){try{if(h.value)throw new Error('Please press "Add" button to add NFT class ID');if(!k.value.length)throw new Error('Please press "Add" button to add NFT class ID');if(f.value)throw new Error('Please press "Add" button to add moderator wallet');if(b.value)throw new Error('Please press "Add" button to add notification email');if(y.value=!0,await Promise.all(k.value.map(async c=>{var p,r,z;const d=await $fetch(`${D}/cosmos/nft/v1beta1/classes/${c}`),m=((z=(r=(p=d==null?void 0:d.class)==null?void 0:p.data)==null?void 0:r.metadata)==null?void 0:z.nft_meta_collection_id)||"";if(!m.includes("nft_book")&&!m.includes("book_nft"))throw new Error("NFT Class not in NFT BOOK meta collection")})),Number(i.value.price)!==0&&i.value.price<j)throw new Error(`Price of each edition must be at least $${j} or $0 (free)`);const n=S.value&&I.value?{[I.value]:100}:null,e=x.value.length?x.value.map(c=>({name:{en:c.name.en,zh:c.name.zh},priceInDecimal:Math.round(Number(c.price)*100),price:Number(c.price)})):void 0,C=Ie(i.value);let O;if(C.isAutoDeliver){if(!confirm(`NFT Book Press - Reminder
Once you choose automatic delivery, you can't switch it back to manual delivery. Are you sure?`))return;if(C.stock>0){if((!w.value||!H.value)&&await ie(),!w.value||!H.value)throw new Error("Unable to connect to wallet");O=await oo(k.value,[],C.stock,H.value,w.value)}}await ue({classIds:k.value,defaultPaymentCurrency:"USD",connectedWallets:n,moderatorWallets:E.value,notificationEmails:R.value,shippingRates:e,name:{en:be.value,zh:M.value},description:{en:ee(ve.value),zh:ee(B.value)},image:_.value,hideDownload:W.value,mustClaimToView:F.value,autoDeliverNFTsTxHash:O,...C}),pe.push({name:"nft-book-store-collection"})}catch(n){const e=n.data||n;console.error(e),U.value=e}finally{G.value=!1,y.value=!1}}function Te(){return Ne()}return(n,e)=>{const C=Qe,O=Je,c=to,d=no,m=Xe,p=Ye,r=so,z=io,K=eo,Q=co,P=ao,oe=po,Ae=fo,De=bo;return g(),N(De,null,{default:a(()=>[o(U)?(g(),N(C,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${o(U)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:e[0]||(e[0]=t=>U.value="")},null,8,["title"])):T("",!0),o(y)?(g(),N(O,{key:1,animation:"carousel"},{indicator:a(()=>e[20]||(e[20]=[A(" Loading... ")])),_:1})):T("",!0),o(ae).isAuthenticated?(g(),J(Ke,{key:2},[l(p,{ui:{body:{base:"space-y-4"}}},{header:a(()=>e[21]||(e[21]=[u("h2",{class:"font-bold font-mono"}," New Book Collection Info ",-1)])),default:a(()=>[l(r,{label:"Books in Collection"},{default:a(()=>[l(p,{ui:{body:{padding:""}}},{default:a(()=>[l(c,{columns:[{key:"classId",label:"Class ID"},{key:"name",label:"Book Name"}],rows:o(k).map((t,Me)=>{var le;return{index:Me,classId:t,name:(le=o(re)(t))==null?void 0:le.name}})},null,8,["rows"]),u("div",_o,[l(d,{modelValue:o(h),"onUpdate:modelValue":e[1]||(e[1]=t=>v(h)?h.value=t:null),class:"font-mono w-full",placeholder:"likenft...."},null,8,["modelValue"]),l(m,{onClick:xe},{default:a(()=>e[22]||(e[22]=[A(" Add ")])),_:1})])]),_:1})]),_:1}),l(r,{label:"Total number of packages available for sale"},{default:a(()=>[l(d,{modelValue:o(i).stock,"onUpdate:modelValue":e[2]||(e[2]=t=>o(i).stock=t),type:"number",step:"1",min:0,max:Number(o(Y).query.count)||void 0},null,8,["modelValue","max"])]),_:1})]),_:1}),l(p,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[23]||(e[23]=[u("h3",{class:"font-bold font-mono"}," Pricing and Availability ",-1)])),default:a(()=>[l(r,{label:`Price(USD) of this collection (Minimal ${o(j)} or $0 (free)) / 版本定價（美金）`},{default:a(()=>[l(d,{modelValue:o(i).price,"onUpdate:modelValue":e[3]||(e[3]=t=>o(i).price=t),type:"number",step:"0.01",min:o(j),onInput:ke},null,8,["modelValue","min"])]),_:1},8,["label"]),l(z,{modelValue:o(i).deliveryMethod,"onUpdate:modelValue":e[4]||(e[4]=t=>o(i).deliveryMethod=t),disabled:o(i).isPhysicalOnly,legend:"Delivery method of this collection / 自動或手動發書",options:o(Ge)},null,8,["modelValue","disabled","options"]),o(i).deliveryMethod==="auto"?(g(),N(r,{key:0},{label:a(()=>[e[25]||(e[25]=A(" Memo of this collection / 自動發書留言 ")),l(Q,null,{image:a(()=>e[24]||(e[24]=[u("img",{src:vo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(K,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(d,{modelValue:o(i).autoMemo,"onUpdate:modelValue":e[5]||(e[5]=t=>o(i).autoMemo=t)},null,8,["modelValue"])]),_:1})):(g(),N(r,{key:1,label:"Is Physical only good / 只含實體書",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(P,{modelValue:o(i).isPhysicalOnly,"onUpdate:modelValue":e[6]||(e[6]=t=>o(i).isPhysicalOnly=t),name:"isPhysicalOnly",label:"This collection does not contain any digital file/NFT"},null,8,["modelValue"])]),_:1})),l(r,null,{label:a(()=>[e[27]||(e[27]=A(" Allow custom price / 開啟打賞功能 ")),l(Q,{"image-style":{width:"300px"}},{image:a(()=>e[26]||(e[26]=[u("img",{src:yo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(K,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(P,{modelValue:o(i).isAllowCustomPrice,"onUpdate:modelValue":e[7]||(e[7]=t=>o(i).isAllowCustomPrice=t),name:"isAllowCustomPrice",label:"Allow user to pay more than defined price"},null,8,["modelValue"])]),_:1}),l(r,{label:"Unlist Edition / 暫時下架"},{default:a(()=>[l(P,{modelValue:o(i).isUnlisted,"onUpdate:modelValue":e[8]||(e[8]=t=>o(i).isUnlisted=t),name:"isUnlisted",label:"Pause selling of this Edition"},null,8,["modelValue"])]),_:1})]),_:1}),l(p,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[28]||(e[28]=[u("h3",{class:"font-bold font-mono"}," Product Information ",-1)])),default:a(()=>[l(r,{ui:{container:"space-y-2 my-[20px]"}},{label:a(()=>[e[30]||(e[30]=A(" 產品名稱（中文） ")),l(Q,{"image-style":{width:"250px"}},{image:a(()=>e[29]||(e[29]=[u("img",{src:go,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(K,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(d,{modelValue:o(M),"onUpdate:modelValue":e[9]||(e[9]=t=>v(M)?M.value=t:null),placeholder:"產品中文名字"},null,8,["modelValue"]),e[31]||(e[31]=u("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),l(o(ro),{modelValue:o(B),"onUpdate:modelValue":e[10]||(e[10]=t=>v(B)?B.value=t:null),language:"en-US","editor-id":"zh",placeholder:o(fe).zh,toolbars:ye,sanitize:Pe,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder"])]),_:1}),l(r,{label:"Image of this book collection",ui:{container:"space-y-2"}},{default:a(()=>[l(d,{modelValue:o(_),"onUpdate:modelValue":e[11]||(e[11]=t=>v(_)?_.value=t:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),o(_)?(g(),J("img",{key:0,src:o(Ze)(o(_)),class:"w-1/3"},null,8,ko)):T("",!0)]),_:1}),l(oe,{modelValue:o(i).hasShipping,"onUpdate:modelValue":e[12]||(e[12]=t=>o(i).hasShipping=t),"is-show-physical-goods-checkbox":!0,"is-show-setting-modal-button":!0,"shipping-info":o(x)},null,8,["modelValue","shipping-info"])]),_:1}),l(Ae,{"is-stripe-connect-checked":o(S),"onUpdate:isStripeConnectChecked":e[13]||(e[13]=t=>v(S)?S.value=t:null),"is-using-default-account":o(Z),"onUpdate:isUsingDefaultAccount":e[14]||(e[14]=t=>v(Z)?Z.value=t:null),"stripe-connect-wallet":o(I),"should-disable-setting":o(G),"login-address":o(w),onSave:Se},null,8,["is-stripe-connect-checked","is-using-default-account","stripe-connect-wallet","should-disable-setting","login-address"]),l(p,{ui:{header:{base:"flex justify-between items-center"},body:{padding:""}}},{header:a(()=>[e[32]||(e[32]=u("h4",{class:"text-sm font-bold font-mono"}," Email to receive sales notifications / 欲收到銷售通知的電郵 ",-1)),u("div",xo,[l(d,{modelValue:o(b),"onUpdate:modelValue":e[15]||(e[15]=t=>v(b)?b.value=t:null),placeholder:"abc@example.com"},null,8,["modelValue"]),l(m,{label:"Add",variant:o(b)?"outline":"solid",color:o(b)?"primary":"gray",disabled:!o(b),onClick:Ue},null,8,["variant","color","disabled"])])]),default:a(()=>[l(c,{columns:[{key:"email",label:"Email",sortable:!0},{key:"action"}],rows:o(_e)},{"email-data":a(({row:t})=>[l(m,{label:t.email,to:`mailto:${t.email}`,variant:"link",padded:!1},null,8,["label","to"])]),"action-data":a(({row:t})=>[u("div",Co,[l(m,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(R).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["rows"])]),_:1}),l(p,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"12px"}}},{default:a(()=>[u("div",Vo,[e[33]||(e[33]=u("h3",{class:"font-bold font-mono"}," Advanced Settings ",-1)),l(m,{color:"gray",variant:"ghost",icon:o($)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:e[16]||(e[16]=()=>{$.value=!o($)})},null,8,["icon"])]),o($)?(g(),J("div",Uo,[l(oe,{"is-show-physical-goods-checkbox":!1,"shipping-info":o(x),"is-show-setting-modal-button":!0,onUpdateShippingRates:Ce},{header:a(()=>e[34]||(e[34]=[u("span",{class:"text-[14px] text-gray-500"}," (Includes physical good that requires shipping) ",-1)])),_:1},8,["shipping-info"]),l(p,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"",base:"space-y-8"}}},{header:a(()=>[e[35]||(e[35]=u("h4",{class:"text-sm font-bold font-mono"}," Share sales data to wallets / 分享銷售數據給特定地址 ",-1)),u("div",So,[l(d,{modelValue:o(f),"onUpdate:modelValue":e[17]||(e[17]=t=>v(f)?f.value=t:null),class:"font-mono",placeholder:"like1..."},null,8,["modelValue"]),l(m,{label:"Add",variant:o(f)?"outline":"solid",color:o(f)?"primary":"gray",disabled:!o(f),onClick:Ve},null,8,["variant","color","disabled"])])]),default:a(()=>[l(c,{columns:o(we),rows:o(he)},{"wallet-data":a(({row:t})=>[l(m,{class:"font-mono",label:t.wallet,to:t.walletLink,variant:"link",padded:!1},null,8,["label","to"])]),"remove-data":a(({row:t})=>[u("div",Io,[l(m,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(E).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(p,{ui:{body:{base:"space-y-8"}}},{header:a(()=>e[36]||(e[36]=[u("h3",{class:"font-bold font-mono"}," DRM Options / 數位版權管理選項 ",-1)])),default:a(()=>[u("div",Po,[l(r,{label:"Force NFT claim before view",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(P,{modelValue:o(F),"onUpdate:modelValue":e[18]||(e[18]=t=>v(F)?F.value=t:null),name:"mustClaimToView",label:"Must claim NFT to view"},null,8,["modelValue"])]),_:1}),l(r,{label:"Disable File Download",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(P,{modelValue:o(W),"onUpdate:modelValue":e[19]||(e[19]=t=>v(W)?W.value=t:null),name:"hideDownload",label:"Disable Download"},null,8,["modelValue"])]),_:1})])]),_:1})])):T("",!0)]),_:1}),l(m,{label:o(ge),loading:o(y),size:"lg",disabled:o(y),onClick:Te},null,8,["label","loading","disabled"])],64)):T("",!0)]),_:1})}}}),Zo=lo(No,[["__scopeId","data-v-beb36113"]]);export{Zo as default};
//# sourceMappingURL=DO8Wuz9f.js.map
