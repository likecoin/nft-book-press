import{bN as se,bO as Q,bP as he,aQ as ke,a_ as Z,aS as G,aT as f,bQ as j,b3 as h,br as $,bR as F,bi as ne,bj as le,bg as x,bS as Be,bT as oe,b9 as v,b8 as U,b1 as ie,b4 as s,bm as we,b0 as Ce,a$ as _e,bk as Ie,bn as Pe,ba as J,aX as B,b2 as ae,aW as w,bs as Le,bK as Ne,aY as ze,bt as Ue,bf as M,aU as P,aV as W,bU as Ve}from"./WNE9bIA0.js";import{_ as $e}from"./Cjq0uDqV.js";import{_ as Oe}from"./DDim_sPC.js";import{_ as Se}from"./BxtxvorN.js";import{u as re}from"./CVZCu2JQ.js";import{_ as Fe}from"./C-6BtS0x.js";import{_ as Me}from"./CDqawuoa.js";import{_ as Te}from"./BvovyLh2.js";import"./BRaINFZT.js";import"./pQJoMVEc.js";import"./BQs_4rZ1.js";import"./DLy6siok.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},C=new e.Error().stack;C&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[C]="a5bf656f-9e2d-4f36-8e5d-f84ba29626f7",e._sentryDebugIdIdentifier="sentry-dbid-a5bf656f-9e2d-4f36-8e5d-f84ba29626f7")}catch{}})();const Re={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},z=se(Q.ui.strategy,Q.ui.pagination,Re),je=se(Q.ui.strategy,Q.ui.button,he),Ge=Z({components:{UButton:x},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>z.default.size,validator(e){return Object.keys(je.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>z.default.activeButton},inactiveButton:{type:Object,default:()=>z.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>z.default.firstButton},lastButton:{type:Object,default:()=>z.default.lastButton},prevButton:{type:Object,default:()=>z.default.prevButton},nextButton:{type:Object,default:()=>z.default.nextButton},divider:{type:String,default:"â€¦"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:C}){const{ui:L,attrs:l}=Be("pagination",oe(e,"ui"),z,oe(e,"class")),r=v({get(){return e.modelValue},set(i){C("update:modelValue",i)}}),_=v(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(i,u)=>u+1)),k=v(()=>{const i=_.value.length,u=r.value,y=Math.max(e.max,5),p=Math.floor((Math.min(y,i)-5)/2),T=u-p,m=u+p,g=T-1>1,D=m+1<i,n=[];if(i<=y){for(let d=1;d<=i;d++)n.push(d);return n}if(n.push(1),g&&n.push(e.divider),!D){const d=u+p+2-i;for(let I=u-p-d;I<=u-p-1;I++)n.push(I)}for(let d=Math.max(2,T);d<=Math.min(i,m);d++)n.push(d);if(!g){const d=1-(u-p-2);for(let I=u+p+1;I<=u+p+d;I++)n.push(I)}return D&&n.push(e.divider),m<i&&n.push(i),n.length>=3&&n[1]===e.divider&&n[2]===3&&(n[1]=2),n.length>=3&&n[n.length-2]===e.divider&&n[n.length-1]===n.length&&(n[n.length-2]=n.length-1),n}),o=v(()=>r.value>1),V=v(()=>r.value<_.value.length);function O(){o.value&&(r.value=1)}function X(){V.value&&(r.value=_.value.length)}function K(i){typeof i!="string"&&(r.value=i)}function S(){o.value&&r.value--}function A(){V.value&&r.value++}return{ui:L,attrs:l,currentPage:r,pages:_,displayedPages:k,canGoLastOrNext:V,canGoFirstOrPrev:o,onClickPrev:S,onClickNext:A,onClickPage:K,onClickFirst:O,onClickLast:X}}});function Ae(e,C,L,l,r,_){const k=x;return f(),G("div",F({class:e.ui.wrapper},e.attrs),[j(e.$slots,"first",{onClick:e.onClickFirst,canGoFirst:e.canGoFirstOrPrev},()=>{var o;return[e.firstButton&&e.showFirst?(f(),h(k,F({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]}),j(e.$slots,"prev",{onClick:e.onClickPrev,canGoPrev:e.canGoFirstOrPrev},()=>{var o;return[e.prevButton?(f(),h(k,F({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,e.currentPage-1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]}),(f(!0),G(ne,null,le(e.displayedPages,(o,V)=>{var O;return f(),h(k,F({key:`${o}-${V}`,to:typeof o=="number"?(O=e.to)==null?void 0:O.call(e,o):null,size:e.size,disabled:e.disabled,label:`${o}`},{ref_for:!0},o===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof o=="string","z-[1]":o===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(o)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),j(e.$slots,"next",{onClick:e.onClickNext,canGoNext:e.canGoLastOrNext},()=>{var o;return[e.nextButton?(f(),h(k,F({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,e.currentPage+1),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]}),j(e.$slots,"last",{onClick:e.onClickLast,canGoLast:e.canGoLastOrNext},()=>{var o;return[e.lastButton&&e.showLast?(f(),h(k,F({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,e.pages.length),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]})],16)}const De=ke(Ge,[["render",Ae]]),qe=Z({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(e){const C=re(),L=e,l=U(!1);return ie(async()=>{try{l.value=!0,await C.lazyFetchClassMetadataById(L.classId)}catch{}finally{l.value=!1}}),(r,_)=>j(r.$slots,"default",{isLoading:s(l)})}}),Ee={class:"font-bold font-mono"},We={class:"flex justify-between items-center w-full px-4 py-3"},Qe={class:"flex items-center gap-1.5"},Xe={class:"text-sm"},Ke={class:"flex gap-1.5 items-center"},Ye={class:"flex flex-wrap justify-between items-center w-full px-4 py-3"},He={class:"text-sm leading-5"},Je={class:"flex gap-1"},Ze={key:1,class:"max-w-xs truncate"},ct=Z({__name:"index",setup(e){const C=we(),L=Ce(),{t:l}=_e(),r=Ie(),_=re(),{listingList:k,moderatedBookList:o,token:V}=Pe(r),{lazyFetchClassMetadataById:O}=_,{fetchBookListing:X,fetchModeratedBookList:K}=r,S=U(""),A=U(!1),i=v(()=>[{label:l("bookstore.current_listing"),key:"current"},{label:l("bookstore.viewable_listing"),key:"viewable"}]),u=v({get(){const a=i.value.findIndex(t=>t.key===C.query.tab);return a===-1?0:a},set(a){ae(L({query:{tab:i.value[a].key}}),{replace:!0})}}),y=U(""),p=U({column:"pendingAction",direction:"desc"}),T=[5,10,20,50],m=U(T[1]),g=U(1),D=v(()=>(g.value-1)*m.value+1),n=v(()=>Math.min(g.value*m.value,d.value.length)),d=v(()=>(i.value[u.value].key==="viewable"?o:k).value.map(a=>{var t,b,N;return{classId:a.classId,className:(t=_.getClassMetadataById(a.classId))==null?void 0:t.name,priceInUSD:(b=a.prices)==null?void 0:b[0].price,prices:(N=a.prices)==null?void 0:N.map(H=>H.price),pendingAction:a.pendingNFTCount,sold:a.sold}}).filter(a=>{if(!y.value)return!0;const t=y.value.toLowerCase();return a.classId.toLowerCase().includes(t)||a.className.toLowerCase().includes(t)})),I=v(()=>{const{column:a,direction:t}=p.value;return d.value.sort((b,N)=>b[a]<N[a]?t==="asc"?-1:1:b[a]>N[a]?t==="asc"?1:-1:0)}),ue=v(()=>I.value.slice((g.value-1)*m.value,g.value*m.value)),Y=v(()=>[{key:"classId",label:l("bookstore.class_id"),sortable:!0,class:"font-mono"},{key:"className",label:l("table.class_name"),sortable:!0},{key:"priceInUSD",label:l("table.price_in_usd"),sortable:!0},{key:"pendingAction",label:l("table.pending_action"),sortable:!0},{key:"sold",label:l("table.sold"),sortable:!0}]),q=U(Y.value.slice(1,Y.value.length));J(A,a=>{a&&(S.value="")}),J(u,()=>{y.value="",g.value=1}),J(m,()=>{g.value=1}),ie(async()=>{const a=[X()];V.value&&a.push(K()),await Promise.all(a),new Set(k.value.map(b=>b.classId).concat(o.value.map(b=>b.classId))).forEach(b=>O(b))});async function de(a){await ae(L({name:"nft-book-store-status-classId",params:{classId:a.classId}}))}return(a,t)=>{const b=Le,N=Ne,H=$e,ce=Oe,ee=x,fe=Se,pe=De,me=Ve,be=qe,ve=Fe,te=Ue,ge=Me,ye=Te;return f(),h(ye,{ui:{constrained:""}},{default:B(()=>[s(S)?(f(),h(b,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${s(S)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:t[0]||(t[0]=R=>S.value="")},null,8,["title"])):$("",!0),s(A)?(f(),h(N,{key:1,animation:"carousel"},{indicator:B(()=>t[8]||(t[8]=[ze(" Loading... ")])),_:1})):$("",!0),w(te,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:B(()=>[s(r).isAuthenticated?(f(),h(ge,{key:0,modelValue:s(u),"onUpdate:modelValue":t[7]||(t[7]=R=>M(u)?u.value=R:null),class:"w-full",items:s(i)},{item:B(({item:R})=>[(f(),h(te,{key:R.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:B(()=>[P("h2",Ee,W(R.label),1),w(H,{modelValue:s(y),"onUpdate:modelValue":t[1]||(t[1]=c=>M(y)?y.value=c:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:s(l)("table.search_placeholder")},null,8,["modelValue","placeholder"])]),default:B(()=>[P("div",We,[P("div",Qe,[P("span",Xe,W(s(l)("table.rows_per_page")),1),w(ce,{modelValue:s(m),"onUpdate:modelValue":t[2]||(t[2]=c=>M(m)?m.value=c:null),options:T,class:"me-2 w-20",size:"xs"},null,8,["modelValue"])]),P("div",Ke,[w(fe,{modelValue:s(q),"onUpdate:modelValue":t[3]||(t[3]=c=>M(q)?q.value=c:null),options:s(Y),multiple:""},{default:B(()=>[w(ee,{class:"min-w-[180px]",label:s(l)("table.columns"),icon:"i-heroicons-view-columns",color:"gray",size:"xs"},null,8,["label"])]),_:1},8,["modelValue","options"]),w(ee,{icon:"i-heroicons-funnel",label:s(l)("table.reset"),color:"gray",size:"xs",disabled:!s(y),onClick:t[4]||(t[4]=c=>y.value="")},null,8,["label","disabled"])])]),P("div",Ye,[P("div",null,[P("span",He,W(s(l)("table.showing_rows",{from:s(D),to:s(n),total:s(d).length})),1)]),w(pe,{modelValue:s(g),"onUpdate:modelValue":t[5]||(t[5]=c=>M(g)?g.value=c:null),"page-count":s(m),total:s(d).length},null,8,["modelValue","page-count","total"])]),w(ve,{sort:s(p),"onUpdate:sort":t[6]||(t[6]=c=>M(p)?p.value=c:null),columns:s(q),rows:s(ue),onSelect:de},{"priceInUSD-data":B(({row:c})=>[P("ul",Je,[(f(!0),G(ne,null,le(c.prices,E=>(f(),G("li",{key:E},[w(me,{label:`$${E}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":B(({row:c})=>[w(be,{"class-id":c.classId},{default:B(({isLoading:E})=>[E||!c.className?(f(),h(N,{key:0})):(f(),G("div",Ze,W(c.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])):$("",!0)]),_:1})]),_:1})}}});export{ct as default};
