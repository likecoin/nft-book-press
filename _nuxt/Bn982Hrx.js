const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./M-tptkT8.js","./Dm55n_q7.js","./entry.BY492grj.css","./DEPwAapD.js","./Dbnh4rXa.js","./DGf9HjKN.js","./BNRh5wRg.js","./BeJGAGuW.js","./Di6iiB0e.js","./Select.qOczc23w.css"])))=>i.map(i=>d[i]);
import{a_ as G,b3 as M,b4 as N,b5 as g,b6 as j,b7 as U,b8 as H,b0 as K,b9 as W,ba as X,b1 as B,aX as v,aT as u,aU as p,aW as n,bb as J,bc as R,bd as d,be as Y,bf as Z,aS as C,bg as w,bh as V,aV as ee}from"./Dm55n_q7.js";import{_ as te}from"./BeJGAGuW.js";import{_ as oe}from"./BNRh5wRg.js";import{_ as ne}from"./9FAC0F-8.js";import{g as ae,a as le,_ as se,d as re,D as ie,b as de}from"./M-tptkT8.js";import{_ as ce}from"./BrbWWaox.js";import{p as ue}from"./CUxdmJDi.js";import"./DGf9HjKN.js";import"./DEPwAapD.js";import"./Dbnh4rXa.js";import"./Di6iiB0e.js";(function(){try{var _=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},y=new _.Error().stack;y&&(_._sentryDebugIds=_._sentryDebugIds||{},_._sentryDebugIds[y]="0ba6a5a4-4f5b-45b8-8842-d503c490489b",_._sentryDebugIdIdentifier="sentry-dbid-0ba6a5a4-4f5b-45b8-8842-d503c490489b")}catch{}})();const pe={class:"print:hidden flex justify-center"},_e={class:"flex justify-center items-center gap-2 print:hidden"},fe={class:"flex flex-col items-center gap-[2cm] print:gap-0"},me={class:"text-xs text-center font-mono"},I="key,url",q=12,Qe=G({__name:"batch-qrcode",setup(_){const{BOOK3_URL:y}=M().public,Q=N(),a=g(""),O=`${I}
example01,https://example01.com
example02,https://example02.com`,f=g(ie),k=g(de),m=g(!1),D=g(void 0),s=g([]),T=j(()=>{const t=[];for(let e=0;e<s.value.length;e+=q)t.push(s.value.slice(e,e+q));return t});U(a,()=>{s.value=[]}),U(f,()=>{s.value=[]}),H({title:"Batch Create Book QR Codes",ogTitle:"Batch Create Book QR Codes"}),K(()=>{try{const t=sessionStorage.getItem("nft_book_press_batch_qrcode");t&&(a.value=t,sessionStorage.removeItem("nft_book_press_batch_qrcode")),W(()=>{a.value&&E()})}catch(t){console.error(t)}});async function E(){try{let e=a.value;e.includes(I)||(e=`${I}
${e}`),s.value=ue(e,{columns:!0,skip_empty_lines:!0})}catch(e){console.error(e),Q.add({icon:"i-heroicons-exclamation-circle",title:"Failed to parse CSV input",timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}const{default:t}=await X(async()=>{const{default:e}=await import("./M-tptkT8.js").then(r=>r.q);return{default:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);s.value.forEach((e,r)=>{var c,i,x;const b=new t(ae({margin:0,data:e.url,image:f.value==="none"?void 0:le(f.value),fillColor:k.value})),l=(c=D.value)==null?void 0:c[r];l&&((i=l.querySelector("svg"))==null||i.remove(),b.append(l),(x=l.querySelector("svg"))==null||x.setAttribute("viewBox","0 0 300 300"))})}function $(t){if(!t)return;const[e]=t,r=new FileReader;r.onload=b=>{var c;const l=(c=b.target)==null?void 0:c.result;typeof l=="string"&&(a.value=l)},r.readAsText(e)}function P(){a.value&&window.print()}function A(){re(s.value.map(t=>({filename:t.key,url:t.url})))}return(t,e)=>{const r=te,b=oe,l=J,c=ne,i=Y,x=se,F=Z,L=ce;return u(),B(L,{class:"print:space-y-0 print:p-0"},{default:v(()=>{var S;return[e[8]||(e[8]=p("h1",{class:"text-lg font-bold font-mono print:hidden"}," Batch Create Book QR Codes ",-1)),n(b,{label:"Upload CSV file",class:"print:hidden"},{default:v(()=>[n(r,{type:"file",accept:"csv",onChange:$})]),_:1}),n(l,{class:"print:hidden",label:"OR"}),n(b,{class:"print:hidden",label:"Input CSV content"},{default:v(()=>[n(c,{modelValue:d(a),"onUpdate:modelValue":e[0]||(e[0]=o=>R(a)?a.value=o:null),class:"font-mono",placeholder:O,resize:!0},null,8,["modelValue"])]),_:1}),p("div",pe,[n(i,{label:"QR Code Appearance",variant:"outline",onClick:e[1]||(e[1]=o=>m.value=!0)})]),n(F,{modelValue:d(m),"onUpdate:modelValue":e[6]||(e[6]=o=>R(m)?m.value=o:null)},{default:v(()=>[n(x,{icon:d(f),"onUpdate:icon":e[3]||(e[3]=o=>R(f)?f.value=o:null),color:d(k),"onUpdate:color":e[4]||(e[4]=o=>R(k)?k.value=o:null),data:`${d(y)}/store`,width:500,height:500,mode:"config",onSave:e[5]||(e[5]=o=>m.value=!1)},{header:v(()=>[e[7]||(e[7]=p("h3",{class:"font-bold font-mono"}," QR Code Config ",-1)),n(i,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:e[2]||(e[2]=o=>m.value=!1)})]),_:1},8,["icon","color","data"])]),_:1},8,["modelValue"]),p("nav",_e,[(S=d(s))!=null&&S.length?(u(),C(w,{key:1},[n(i,{label:"Print",size:"lg",variant:"outline",onClick:P}),n(i,{label:"Download",size:"lg",variant:"outline",onClick:A})],64)):(u(),B(i,{key:0,label:"Generate",size:"lg",disabled:!d(a),onClick:E},null,8,["disabled"]))]),p("div",fe,[(u(!0),C(w,null,V(d(T),(o,z)=>(u(),C("ul",{key:z,class:"w-[20cm] grid grid-cols-3 items-center gap-[0.25cm] py-[0.5cm] break-before-page"},[(u(!0),C(w,null,V(o,h=>(u(),C("li",{key:h.key||h.url},[p("figure",{ref_for:!0,ref_key:"qrCodeRef",ref:D,class:"qrcode"},[p("figcaption",me,ee(h.key||h.url),1)],512)]))),128))]))),128))])]}),_:1,__:[8]})}}});export{Qe as default};
