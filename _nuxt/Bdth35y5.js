import{_ as jt}from"./CHIVaQ3_.js";import{a_ as ue,b1 as Ae,bD as ht,bE as vt,bF as Qt,ba as d,bG as Ie,bH as qe,bI as lt,b9 as b,bJ as zt,bK as Z,bL as ie,bM as st,bN as Ht,bO as it,bP as bt,bQ as kt,bR as we,bS as Nt,aQ as Ft,bT as Ve,aS as Q,aT as g,bn as Pe,bo as gt,b3 as O,aX as r,aW as s,bU as rt,bV as Oe,bq as Me,bW as ut,bX as je,bY as j,bZ as Kt,b_ as yt,aY as ct,aV as V,b$ as Ct,c0 as Wt,c1 as dt,bb as re,c2 as Gt,c3 as Xt,c4 as Yt,b7 as Jt,c5 as Zt,bv as en,b8 as tn,bj as nn,b0 as on,bs as an,a$ as ln,bh as sn,bm as rn,c6 as un,bx as cn,b2 as pt,c7 as dn,c8 as mt,b4 as n,aU as S,bA as pn,bd as E,bi as J,c9 as ft,bg as mn,ca as fn,cb as _t}from"./DKQfXkmP.js";import{_ as _n}from"./D39WzfFX.js";import{_ as hn}from"./CLRWOvdN.js";import{_ as vn}from"./BUZ_eXdg.js";import{_ as bn}from"./Bi1j8ZlZ.js";import{_ as kn}from"./1ucbcvnE.js";import{s as gn}from"./CtJ2k79u.js";import{_ as yn}from"./Dfk8Yp3t.js";import{_ as Cn}from"./hQGyAmxh.js";import{_ as In}from"./Cmasbhyi.js";import{_ as wn,d as xn}from"./CUJ-KYW_.js";import{_ as Sn}from"./C9oTDVtx.js";import{_ as Ln}from"./CCwCkij9.js";import{A as Dn,a as Un}from"./LMRE0rPC.js";import{u as Bn}from"./DC62CDPd.js";import"./KfUHJoSC.js";import"./Qp-aIGUz.js";import"./B6UX-ISL.js";import"./BzhPE6u9.js";import"./Dm4IUlup.js";(function(){try{var o=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},y=new o.Error().stack;y&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[y]="b10936d0-5c75-4c96-be07-b15061c2e1ef",o._sentryDebugIdIdentifier="sentry-dbid-b10936d0-5c75-4c96-be07-b15061c2e1ef")}catch{}})();const $n={wrapper:"w-full flex flex-col",container:"w-full flex flex-col",item:{base:"",size:"text-sm",color:"text-gray-500 dark:text-gray-400",padding:"pt-1.5 pb-3",icon:"ms-auto transform transition-transform duration-200 flex-shrink-0"},transition:{enterActiveClass:"overflow-hidden transition-[height] duration-200 ease-out",leaveActiveClass:"overflow-hidden transition-[height] duration-200 ease-out"},default:{openIcon:"i-heroicons-chevron-down-20-solid",closeIcon:"",class:"mb-1.5 w-full",variant:"soft",truncate:!0}};var Vn=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(Vn||{});let It=Symbol("DisclosureContext");function Qe(o){let y=bt(It,null);if(y===null){let D=new Error(`<${o} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(D,Qe),D}return y}let wt=Symbol("DisclosurePanelContext");function On(){return bt(wt,null)}let En=ue({name:"Disclosure",props:{as:{type:[Object,String],default:"template"},defaultOpen:{type:[Boolean],default:!1}},setup(o,{slots:y,attrs:D}){let C=b(o.defaultOpen?0:1),c=b(null),U=b(null),v={buttonId:b(`headlessui-disclosure-button-${st()}`),panelId:b(`headlessui-disclosure-panel-${st()}`),disclosureState:C,panel:c,button:U,toggleDisclosure(){C.value=it(C.value,{0:1,1:0})},closeDisclosure(){C.value!==1&&(C.value=1)},close(h){v.closeDisclosure();let I=h?h instanceof HTMLElement?h:h.value instanceof HTMLElement?Z(h):Z(v.button):Z(v.button);I==null||I.focus()}};return vt(It,v),Ht(d(()=>it(C.value,{0:Ie.Open,1:Ie.Closed}))),()=>{let{defaultOpen:h,...I}=o,w={open:C.value===0,close:v.close};return qe({theirProps:I,ourProps:{},slot:w,slots:y,attrs:D,name:"Disclosure"})}}}),Rn=ue({name:"DisclosureButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(o,{attrs:y,slots:D,expose:C}){let c=Qe("DisclosureButton"),U=On(),v=d(()=>U===null?!1:U.value===c.panelId.value);Ae(()=>{v.value||o.id!==null&&(c.buttonId.value=o.id)}),ht(()=>{v.value||(c.buttonId.value=null)});let h=b(null);C({el:h,$el:h}),v.value||zt(()=>{c.button.value=h.value});let I=gn(d(()=>({as:o.as,type:y.type})),h);function w(){var l;o.disabled||(v.value?(c.toggleDisclosure(),(l=Z(c.button))==null||l.focus()):c.toggleDisclosure())}function a(l){var p;if(!o.disabled)if(v.value)switch(l.key){case ie.Space:case ie.Enter:l.preventDefault(),l.stopPropagation(),c.toggleDisclosure(),(p=Z(c.button))==null||p.focus();break}else switch(l.key){case ie.Space:case ie.Enter:l.preventDefault(),l.stopPropagation(),c.toggleDisclosure();break}}function m(l){switch(l.key){case ie.Space:l.preventDefault();break}}return()=>{var l;let p={open:c.disclosureState.value===0},{id:f,...B}=o,z=v.value?{ref:h,type:I.value,onClick:w,onKeydown:a}:{id:(l=c.buttonId.value)!=null?l:f,ref:h,type:I.value,"aria-expanded":c.disclosureState.value===0,"aria-controls":c.disclosureState.value===0||Z(c.panel)?c.panelId.value:void 0,disabled:o.disabled?!0:void 0,onClick:w,onKeydown:a,onKeyup:m};return qe({ourProps:z,theirProps:B,slot:p,attrs:y,slots:D,name:"DisclosureButton"})}}}),Tn=ue({name:"DisclosurePanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(o,{attrs:y,slots:D,expose:C}){let c=Qe("DisclosurePanel");Ae(()=>{o.id!==null&&(c.panelId.value=o.id)}),ht(()=>{c.panelId.value=null}),C({el:c.panel,$el:c.panel}),vt(wt,c.panelId);let U=Qt(),v=d(()=>U!==null?(U.value&Ie.Open)===Ie.Open:c.disclosureState.value===0);return()=>{var h;let I={open:c.disclosureState.value===0,close:c.close},{id:w,...a}=o,m={id:(h=c.panelId.value)!=null?h:w,ref:c.panel};return qe({ourProps:m,theirProps:a,slot:I,attrs:y,slots:D,features:lt.RenderStrategy|lt.Static,visible:v.value,name:"DisclosurePanel"})}}});const Ee=kt(we.ui.strategy,we.ui.accordion,$n),Pn=kt(we.ui.strategy,we.ui.button,Nt),An=ue({components:{HDisclosure:En,HDisclosureButton:Rn,HDisclosurePanel:Tn,UIcon:je,UButton:Me},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},defaultOpen:{type:Boolean,default:!1},openIcon:{type:String,default:()=>Ee.default.openIcon},unmount:{type:Boolean,default:!1},closeIcon:{type:String,default:()=>Ee.default.closeIcon},multiple:{type:Boolean,default:!1},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["open","close"],setup(o,{emit:y}){const{ui:D,attrs:C}=Wt("accordion",dt(o,"ui"),Ee,dt(o,"class")),c=d(()=>Pn),U=b([]),v=d(()=>U.value.map(({open:l})=>l));re(v,(l,p)=>{for(const f in l){const B=p[f],z=l[f];!B&&z?y("open",f):B&&!z&&y("close",f)}},{immediate:!0});function h(l,p){!o.items[l].closeOthers&&o.multiple||U.value.forEach(f=>{f.open&&f.close(p.target)})}function I(l,p){const f=l;f.style.height="0",f.offsetHeight,f.style.height=f.scrollHeight+"px",f.addEventListener("transitionend",p,{once:!0})}function w(l){const p=l;p.style.height=p.scrollHeight+"px",p.offsetHeight}function a(l){const p=l;p.style.height="auto"}function m(l,p){const f=l;f.style.height="0",f.addEventListener("transitionend",p,{once:!0})}return Xt(()=>Yt()),{ui:D,uiButton:c,attrs:C,buttonRefs:U,closeOthers:h,omit:Gt,onEnter:I,onBeforeLeave:w,onAfterEnter:a,onLeave:m}}}),qn={key:1};function Mn(o,y,D,C,c,U){const v=je,h=Me,I=Ve("HDisclosureButton"),w=Ve("HDisclosurePanel"),a=Ve("HDisclosure");return g(),Q("div",{class:j(o.ui.wrapper)},[(g(!0),Q(Pe,null,gt(o.items,(m,l)=>(g(),O(a,{key:l,as:"div",class:j(o.ui.container),"default-open":o.defaultOpen||m.defaultOpen},{default:r(({open:p,close:f})=>[s(I,{ref_for:!0,ref:()=>o.buttonRefs[l]={open:p,close:f},as:"template",disabled:m.disabled,onClick:B=>o.closeOthers(l,B),onKeydown:[rt(B=>o.closeOthers(l,B),["enter"]),rt(B=>o.closeOthers(l,B),["space"])]},{default:r(()=>[Oe(o.$slots,"default",{item:m,index:l,open:p,close:f},()=>[s(h,ut({ref_for:!0},{...o.omit(o.ui.default,["openIcon","closeIcon"]),...o.attrs,...o.omit(m,["slot","disabled","content","defaultOpen"])}),{trailing:r(()=>[s(v,{name:p&&o.closeIcon?o.closeIcon:o.openIcon,class:j([p&&!o.closeIcon?"-rotate-180":"",o.uiButton.icon.size[m.size||o.uiButton.default.size],o.ui.item.icon])},null,8,["name","class"])]),_:2},1040)])]),_:2},1032,["disabled","onClick","onKeydown"]),s(Kt,ut({ref_for:!0},o.ui.transition,{onEnter:o.onEnter,onAfterEnter:o.onAfterEnter,onBeforeLeave:o.onBeforeLeave,onLeave:o.onLeave}),{default:r(()=>[o.unmount?(g(),O(w,{key:0,class:j([o.ui.item.base,o.ui.item.size,o.ui.item.color,o.ui.item.padding]),unmount:""},{default:r(()=>[Oe(o.$slots,m.slot||"item",{item:m,index:l,open:p,close:f},()=>[ct(V(m.content),1)])]),_:2},1032,["class"])):yt((g(),Q("div",qn,[s(w,{class:j([o.ui.item.base,o.ui.item.size,o.ui.item.color,o.ui.item.padding]),static:""},{default:r(()=>[Oe(o.$slots,m.slot||"item",{item:m,index:l,open:p,close:f},()=>[ct(V(m.content),1)])]),_:2},1032,["class"])],512)),[[Ct,p]])]),_:2},1040,["onEnter","onAfterEnter","onBeforeLeave","onLeave"])]),_:2},1032,["class","default-open"]))),128))],2)}const jn=Ft(An,[["render",Mn]]),Qn={key:0,class:"flex flex-col items-center justify-center self-stretch gap-4 py-10"},zn=["textContent"],Hn={class:"flex gap-2"},Nn=["textContent"],Fn={class:"relative flex max-md:flex-col flex-wrap gap-4"},Kn={class:"flex items-center gap-2"},Wn=["textContent"],Gn={key:0},Xn=["textContent"],Yn=["textContent"],Jn=["textContent"],Zn=["textContent"],eo={class:"flex items-center gap-2 font-bold"},to=["textContent"],no=["textContent"],oo=["textContent"],ao={class:"flex items-center gap-2"},lo={class:"font-bold font-mono"},Re="bookpress",Te="affiliate",Do=ue({__name:"purchase-link",setup(o){const{LIKE_CO_API:y,SITE_URL:D}=Jt().public,C=Zt(),c=Bn(),U=en(),{userLikerInfo:v}=tn(U),h=nn(),I=on(),w=an(),{t:a}=ln(),m=d({get:()=>h.query.share==="1",set:e=>{pt(I({query:{...h.query,share:e?"1":void 0}}),{replace:!0})}}),l=d(()=>m.value?a("purchase_link.sharing_mode_title"):a("purchase_link.generator_mode_title"));sn({title:()=>l.value,ogTitle:()=>l.value});const p=b(""),f=d({get:()=>{if(p.value)return p.value;const e=h.query.product_id;return e?Array.isArray(e)?e.join(`
`):e:""},set:e=>{p.value=e}}),B=d(()=>f.value.split(`
`).map(e=>e.trim()).filter(Boolean)),z=d(()=>B.value[0]||""),ze=d(()=>B.value.map(e=>{let t=e.trim();return t.startsWith("http")&&(t=new URL(t).pathname.split("/").pop()),t!=null&&t.startsWith("0x")?t:""}).filter(Boolean)),He=d(()=>ze.value[0]||"");function Ne(e={}){const t=new URLSearchParams;return e.utmCampaign&&t.set("utm_campaign",e.utmCampaign),e.utmSource&&t.set("utm_source",e.utmSource),e.utmMedium&&t.set("utm_medium",e.utmMedium),t.toString().replace("?","")}const ce=b(""),ee=b(!0),de=b(""),pe=b(""),xe=d(()=>{const e=N.value==="liker_land";return M.value?"custom-link":e?"likerland":"stripe"}),Se=b(""),te=d({get:()=>Se.value?Se.value:Ne({utmCampaign:ce.value,utmSource:pe.value,utmMedium:de.value}),set:e=>{Se.value=e}}),xt=d(()=>Ne({utmCampaign:Re,utmSource:xe.value,utmMedium:Te})),Le=d(()=>({utm_medium:Te,utm_source:xe.value,utm_campaign:Re})),H=d(()=>{var _;const e={...Le.value},t=((_=z.value)==null?void 0:_.trim())||"";if(t.startsWith("http")){const{searchParams:u}=new URL(t);u.delete("from"),Object.assign(e,Object.fromEntries(u))}return te.value&&Object.assign(e,Object.fromEntries(new URLSearchParams(te.value))),e}),Fe=d(()=>Object.entries(H.value).filter(([e])=>!(e==="utm_campaign"&&ee.value)).map(([e,t])=>({key:e,value:t}))),Ke=d(()=>[{name:a("purchase_link.liker_land_product"),value:"liker_land"},{name:a("purchase_link.stripe_checkout"),value:"direct"},{name:a("purchase_link.custom_page"),value:"custom"}]),N=b(Ke.value[0].value),M=d(()=>N.value==="custom"),F=b(h.query.custom_link||""),De=b(""),P=d({get:()=>{if(De.value)return De.value;const e=h.query.from;return e?Array.isArray(e)?e.join(","):e:""},set:e=>{De.value=e}}),ne=d(()=>P.value.split(",").map(e=>e.trim()).filter(Boolean).map(e=>{const t=C.getChannelInfoById(e);return{id:e,name:(t==null?void 0:t.displayName)||e}})),We=b(!1),me=d({get:()=>!ne.value.length||We.value,set:e=>{We.value=e}}),fe=d(()=>ne.value.concat(me.value?Dn:[])),q=d(()=>fe.value.length>1),_e=b("");re(He,()=>{_e.value=""});const oe=b("");re(P,()=>{oe.value=""});const K=b(""),Ge=d(()=>!!K.value),Xe=d(()=>M.value?!!F.value:!!He.value&&!Ge.value),R=b(void 0),he=d(()=>{const e={};if(R.value)for(const{id:t,data:_}of R.value)_.prices?e[t]=_.prices.map(u=>{var k,T;let x="";return typeof u.name=="object"?x=((k=u.name)==null?void 0:k.zh)||((T=u.name)==null?void 0:T.en)||"":x=u.name,{label:[x,`$${u.price}`].filter(Boolean).join(" - "),value:u.index||0}}):e[t]=[];return e}),W=b({}),Ye=d(()=>{var e;return((e=R.value)==null?void 0:e.map(({id:t,data:_})=>{var u,x;return{id:t,name:((u=_.name)==null?void 0:u.zh)||((x=_.name)==null?void 0:x.en)||_.name,editionOptions:he.value[t]||[]}}))||[]}),St=d(()=>{const e=[];return M.value||e.push({key:"productId",label:a("common.title"),sortable:!0},{key:"selectedEditionLabel",label:a("table.selected_edition")}),m.value||e.push({key:"utmCampaign",label:a("purchase_link.utm_campaign"),sortable:!0}),e.push({key:"link",label:a("common.link")}),e}),Ue=d(()=>{const e=new Map,t=[...new Map(fe.value.map(u=>[u.id,u])).values()];return(M.value?[{id:"custom",data:{name:"Custom"}}]:R.value||[]).forEach(({id:u,data:x})=>{t.forEach(k=>{var A,ke,Y,se,ge,ye;e.has(k.id)||e.set(k.id,[]);let X=H.value.utm_campaign||Le.value.utm_campaign||"";ee.value&&k.id!==Un&&(X=`${dn(k.id)}_${X}`);const $=W.value[u]||0,le={classId:u||"",channel:k.id,priceIndex:$,customLink:M.value?F.value:void 0,isUseLikerLandLink:N.value==="liker_land",query:{utm_campaign:X,...H.value}};(ye=e.get(k.id))==null||ye.push({productId:u,productName:((A=x.name)==null?void 0:A.zh)||((ke=x.name)==null?void 0:ke.en)||x.name,selectedEditionIndex:$,selectedEditionLabel:((ge=(se=(Y=he.value)==null?void 0:Y[u])==null?void 0:se[$])==null?void 0:ge.label)||"",channelId:k.id,channelName:k.name,utmCampaign:X,utmMedium:H.value.utm_medium,utmSource:H.value.utm_source,url:mt(le),qrCodeUrl:mt({...le,isForQRCode:H.value.utm_source===Le.value.utm_source})})})}),e}),ve=d(()=>fe.value.flatMap(e=>Ue.value.get(e.id)||[])),ae=e=>Ue.value.get(e)||[],G=b(void 0),be=d({get:()=>!!G.value,set:e=>{e||(G.value=void 0)}});async function Lt(e){const t=await $fetch(`${y}/likernft/book/store/${e}`);return{id:e,data:t}}async function Be(){if(_e.value="",R.value=void 0,W.value={},oe.value="",K.value="",!!Xe.value)try{if(ne.value.length){K.value=a("purchase_link.validating_channels");const e=ne.value.find(t=>!un(t.id));if(e){oe.value=a("purchase_link.invalid_channel")+` "${e.id}", please enter a valid channel ID starting with "@"`;return}try{await Promise.all(ne.value.map(async t=>{const _=await C.lazyFetchChannelInfoById(t.id);if(!_)throw new Error(a("purchase_link.channel_no_liker_id"));const u=await c.fetchStripeConnectStatusByWallet(_.evmWallet);if(!(u!=null&&u.hasAccount))throw new Error(a("purchase_link.channel_no_stripe"));if(!(u!=null&&u.isReady))throw new Error(a("purchase_link.channel_stripe_incomplete"))}))}catch(t){oe.value=t.message,m.value=!1;return}}K.value=a("purchase_link.fetching_product_data");try{const e=await Promise.all(ze.value.map(t=>Lt(t)));R.value=e}catch(e){_e.value=e.message,m.value=!1}}catch(e){console.error(e),w.add({icon:"i-heroicons-exclamation-circle",title:a("purchase_link.failed_create_link"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}}),m.value=!1}finally{K.value=""}}function Je(e){const t=[];if(M.value){const _=new URL(F.value);t.push(_.hostname)}else t.push(`${e.productName||e.productId}`);return e.channelId&&t.push(`channel-${e.channelId}`),t.join("_")}async function Ze(e=""){await navigator.clipboard.writeText(e),w.add({icon:"i-heroicons-check-circle",title:a("purchase_link.copied_to_clipboard"),timeout:2e3,color:"green"})}function et(e=[],t){fn({data:e.map(({selectedEditionIndex:_,selectedEditionLabel:u,...x})=>({edition:`${_+1}. ${u}`,...x})),fileName:["affiliation_links",t,Date.now()].filter(Boolean).join("_").concat(".csv"),fileType:"csv"})}function Dt(){et(ve.value)}function Ut(e){return()=>et(ae(e))}function tt(e=[]){try{sessionStorage.setItem("nft_book_press_batch_qrcode",_t(e.map(({channelId:t,qrCodeUrl:_,...u})=>({key:t,...u,url:_})))),window.open("/batch-qrcode?print=1","batch_qrcode","popup,menubar=no,location=no,status=no")}catch(t){console.error(t),w.add({icon:"i-heroicons-exclamation-circle",title:a("purchase_link.failed_print_qr"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}}function Bt(){tt(ve.value)}function $t(e){return()=>tt(ae(e))}function nt(e=[]){try{sessionStorage.setItem("nft_book_press_batch_shorten_url",_t(e.map(({channelId:t,..._})=>({key:t,..._})))),pt(I({name:"batch-short-links",query:{print:1}}))}catch(t){console.error(t),w.add({icon:"i-heroicons-exclamation-circle",title:a("purchase_link.failed_shorten_links"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}}function Vt(){nt(ve.value)}function Ot(e){return()=>nt(ae(e))}function Et(e){return()=>{const t=new URL(`${D}/affiliation-link`);t.searchParams.set("from",e),t.searchParams.set("share","1"),t.searchParams.set("nav","0"),ae(e).forEach(u=>{t.searchParams.append("product_id",u.productId)}),Ze(t.toString())}}async function ot(e=[],t){const _=e.map(u=>({url:u.qrCodeUrl,filename:Je(u)}));await xn(_,{zipFilename:["affiliation_links_qrcodes",t,Date.now()].filter(Boolean).join("_")})}async function Rt(){await ot(ve.value)}function Tt(e){return()=>ot(ae(e),e)}function $e(){!P.value&&v.value&&(P.value=cn(v.value.user))}return Ae(()=>{m.value&&rn(()=>{Be()}),$e()}),re(m,e=>{e?Be():R.value=void 0}),re(v,()=>{v.value&&$e()}),(e,t)=>{const _=jt,u=je,x=_n,k=hn,T=vn,X=bn,$=Me,le=kn,A=pn,ke=jn,Y=yn,se=Cn,ge=In,ye=wn,Pt=mn,At=Sn,qt=Ln;return g(),O(qt,null,{default:r(()=>[s(_,{title:n(l)},null,8,["title"]),s(At,{class:"flex flex-col items-stretch grow space-y-8"},{default:r(()=>[!n(R)&&n(m)||n(Ge)?(g(),Q("div",Qn,[s(u,{class:"w-10 h-10 animate-spin",name:"i-heroicons-arrow-path-20-solid"}),S("span",{class:"text-gray-400 dark:text-gray-700 text-sm",textContent:V(n(K)||n(a)("purchase_link.failed_create_link"))},null,8,zn)])):n(R)?(g(),Q(Pe,{key:2},[n(m)?J("",!0):(g(),Q("header",Gn,[s($,{icon:"i-heroicons-arrow-uturn-left",label:n(a)("purchase_link.back_to_config"),variant:"soft",onClick:t[10]||(t[10]=i=>R.value=void 0)},null,8,["label"])])),n(q)&&n(Ye).length?(g(),O(A,{key:1,ui:{body:{padding:""}}},{header:r(()=>[S("h3",{class:"text-lg font-bold",textContent:V(n(a)("purchase_link.product_list"))},null,8,Xn)]),default:r(()=>[s(Y,{columns:[{key:"name",label:n(a)("table.name")},{key:"editionSelect",label:n(a)("table.selected_edition")}],rows:n(Ye)},{"name-data":r(({row:i})=>[S("span",{textContent:V(i.name)},null,8,Yn)]),"editionSelect-data":r(({row:i})=>[i.editionOptions.length?(g(),O(x,{key:0,class:"min-w-[200px]","model-value":n(W)[i.id]||0,options:i.editionOptions,"onUpdate:modelValue":L=>n(W)[i.id]=L},null,8,["model-value","options","onUpdate:modelValue"])):J("",!0)]),_:1},8,["columns","rows"])]),_:1})):J("",!0),!n(m)&&n(Fe).length?(g(),O(A,{key:2,ui:{body:{padding:""}}},{header:r(()=>[S("h3",{class:"text-lg font-bold",textContent:V(n(a)("purchase_link.common_query_string"))},null,8,Jn)]),default:r(()=>[s(Y,{columns:[{key:"key",label:n(a)("table.key")},{key:"value",label:n(a)("table.value")}],rows:n(Fe),ui:{td:{font:"font-mono"}}},null,8,["columns","rows"])]),_:1})):J("",!0),s(A,{ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"space-y-8",padding:n(q)?void 0:""}}},ft({default:r(()=>[(g(!0),Q(Pe,null,gt(n(fe),i=>(g(),O(A,{key:i.id,ui:{base:"overflow-hidden",ring:n(q)?void 0:"",shadow:n(q)?void 0:"",header:{base:"flex justify-between items-center gap-4"},body:{padding:""}}},{header:r(()=>[S("h3",eo,[S("span",{class:j(n(q)?"text-md":"text-lg"),textContent:V(i.name)},null,10,to),S("span",{class:j([n(q)?"text-xs":"text-sm","text-gray-400 dark:text-gray-700","font-mono"]),textContent:V(i.id)},null,10,no)]),s(se,{items:[[{label:n(a)("purchase_link.print_qr_codes"),icon:"i-heroicons-qr-code",click:$t(i.id)},{label:n(a)("purchase_link.download_qr_codes"),icon:"i-heroicons-arrow-down-on-square-stack",click:Tt(i.id)},{label:n(a)("purchase_link.download_links"),icon:"i-heroicons-arrow-down-on-square-stack",click:Ut(i.id)},{label:n(a)("purchase_link.shorten_links"),icon:"i-heroicons-sparkles",click:Ot(i.id)},{label:n(a)("purchase_link.share_table"),icon:"i-heroicons-document-duplicate",click:Et(i.id)}]],popper:{placement:"top-end"}},{default:r(()=>[s($,{icon:"i-heroicons-ellipsis-horizontal-20-solid",color:"gray",size:"sm",variant:"soft"})]),_:2},1032,["items"])]),default:r(()=>[s(Y,{columns:n(St),rows:n(Ue).get(i.id)},ft({"productId-data":r(({row:L})=>[S("div",{textContent:V(L.productName)},null,8,oo)]),"utmCampaign-data":r(({row:L})=>[s(ge,{class:"font-mono",value:L.utmCampaign},null,8,["value"])]),"link-data":r(({row:L})=>[S("div",ao,[s($,{icon:"i-heroicons-qr-code",variant:"outline",size:"xs",onClick:Ce=>G.value=L},null,8,["onClick"]),s($,{icon:"i-heroicons-document-duplicate",variant:"outline",size:"xs",onClick:Ce=>Ze(L.url||"")},null,8,["onClick"]),s($,{class:"font-mono break-all",label:L.url,to:L.url,color:"gray",variant:"outline",size:"xs",target:"_blank"},null,8,["label","to"])])]),_:2},[n(q)?void 0:{name:"selectedEditionLabel-data",fn:r(({row:L})=>{var Ce,at;return[(Ce=n(he))!=null&&Ce[L.productId].length?(g(),O(x,{key:0,class:"min-w-[200px]","model-value":n(W)[L.productId]||0,options:((at=n(he))==null?void 0:at[L.productId])||[],"onUpdate:modelValue":Mt=>n(W)[L.productId]=Mt},null,8,["model-value","options","onUpdate:modelValue"])):J("",!0)]}),key:"0"}]),1032,["columns","rows"])]),_:2},1032,["ui"]))),128))]),_:2},[n(q)?{name:"header",fn:r(()=>[S("h2",{class:"text-lg font-bold",textContent:V(n(a)("purchase_link.affiliation_links"))},null,8,Zn),s(se,{items:[[{label:n(a)("purchase_link.print_all_qr"),icon:"i-heroicons-qr-code",click:Bt},{label:n(a)("purchase_link.download_qr_codes"),icon:"i-heroicons-arrow-down-on-square-stack",click:Rt},{label:n(a)("purchase_link.download_all_links"),icon:"i-heroicons-arrow-down-on-square-stack",click:Dt},{label:n(a)("purchase_link.shorten_all_links"),icon:"i-heroicons-sparkles",click:Vt}]],popper:{placement:"top-end"}},{default:r(()=>[s($,{icon:"i-heroicons-ellipsis-horizontal-20-solid",color:"gray",variant:"soft"})]),_:1},8,["items"])]),key:"0"}:void 0]),1032,["ui"]),s(Pt,{modelValue:n(be),"onUpdate:modelValue":t[12]||(t[12]=i=>E(be)?be.value=i:null)},{default:r(()=>[n(G)?(g(),O(ye,{key:0,data:n(G).qrCodeUrl,"file-name":Je(n(G)),width:500,height:500},{header:r(()=>[S("h3",lo,V(n(a)("purchase_link.download_qr_modal")),1),s($,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:t[11]||(t[11]=i=>be.value=!1)})]),_:1},8,["data","file-name"])):J("",!0)]),_:1},8,["modelValue"])],64)):(g(),O(A,{key:1,ui:{body:{base:"space-y-4"},footer:{base:"flex justify-end"}}},{footer:r(()=>[s($,{label:n(a)("purchase_link.generate"),size:"lg",disabled:!n(Xe),onClick:Be},null,8,["label","disabled"])]),default:r(()=>[s(k,{label:n(a)("purchase_link.destination")},{default:r(()=>[s(x,{modelValue:n(N),"onUpdate:modelValue":t[0]||(t[0]=i=>E(N)?N.value=i:null),options:n(Ke),"option-attribute":"name"},null,8,["modelValue","options"])]),_:1},8,["label"]),n(M)?(g(),O(k,{key:0,label:n(a)("purchase_link.custom_page_url"),required:!0},{default:r(()=>[s(T,{modelValue:n(F),"onUpdate:modelValue":t[1]||(t[1]=i=>E(F)?F.value=i:null),class:"font-mono",placeholder:"https://3ook.com/store?tag=blockchain",name:"custom_destination_url"},null,8,["modelValue"])]),_:1},8,["label"])):(g(),O(k,{key:1,label:n(a)("purchase_link.product_ids"),error:n(_e),required:!0},{default:r(()=>[s(X,{modelValue:n(f),"onUpdate:modelValue":t[2]||(t[2]=i=>E(f)?f.value=i:null),class:"font-mono",placeholder:"0x53c7243b94b3c4a4827816f00d72394ddfb974c4\\n0x146736dd2ccb1dbdf266130a117609e00ad566b1",autoresize:!0,name:"product_id"},null,8,["modelValue"])]),_:1},8,["label","error"])),s(k,{label:n(a)("purchase_link.channel_ids"),hint:n(a)("purchase_link.optional"),error:n(oe),ui:{help:"flex items-center gap-2"}},{help:r(()=>[s(le,{modelValue:n(me),"onUpdate:modelValue":t[4]||(t[4]=i=>E(me)?me.value=i:null),disabled:!n(P)},null,8,["modelValue","disabled"]),S("span",{textContent:V(n(a)("purchase_link.include_default_channels"))},null,8,Nn)]),default:r(()=>[S("div",Hn,[s(T,{modelValue:n(P),"onUpdate:modelValue":t[3]||(t[3]=i=>E(P)?P.value=i:null),class:"grow font-mono",placeholder:n(a)("purchase_link.channel_ids_placeholder"),name:"channel_ids"},null,8,["modelValue","placeholder"]),yt(s($,{class:"relative",label:n(a)("purchase_link.prefill_from_account"),color:"gray",variant:"outline",size:"2xs",onClick:$e},null,8,["label"]),[[Ct,!n(P)&&n(v)]])])]),_:1},8,["label","hint","error"]),s(ke,{color:"gray",variant:"soft",size:"md",items:[{label:n(a)("purchase_link.query_string_optional"),defaultOpen:!0,slot:"body"}],ui:{item:{padding:"p-0"}}},{body:r(()=>[s(A,{ui:{body:{base:"space-y-4"}}},{default:r(()=>[S("div",Fn,[s(k,{class:"flex-1",label:n(a)("purchase_link.utm_campaign")},{default:r(()=>[s(T,{modelValue:n(ce),"onUpdate:modelValue":t[5]||(t[5]=i=>E(ce)?ce.value=i:null),class:"font-mono",name:"utm_campaign",placeholder:`e.g. ${Re}`},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(k,{class:"flex-1",label:n(a)("purchase_link.utm_source")},{default:r(()=>[s(T,{modelValue:n(pe),"onUpdate:modelValue":t[6]||(t[6]=i=>E(pe)?pe.value=i:null),class:"font-mono",name:"utm_source",placeholder:`e.g. ${n(xe)}`},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(k,{class:"flex-1",label:n(a)("purchase_link.utm_medium")},{default:r(()=>[s(T,{modelValue:n(de),"onUpdate:modelValue":t[7]||(t[7]=i=>E(de)?de.value=i:null),class:"font-mono",name:"utm_medium",placeholder:`e.g. ${Te}`},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),s(k,{label:n(a)("purchase_link.additional_query_string")},{default:r(()=>[s(T,{modelValue:n(te),"onUpdate:modelValue":t[8]||(t[8]=i=>E(te)?te.value=i:null),class:"font-mono",placeholder:n(xt),name:"query_params"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),S("div",Kn,[s(le,{modelValue:n(ee),"onUpdate:modelValue":t[9]||(t[9]=i=>E(ee)?ee.value=i:null)},null,8,["modelValue"]),S("span",{textContent:V(n(a)("purchase_link.prefix_channel_id"))},null,8,Wn)])]),_:1})]),_:1},8,["items"])]),_:1}))]),_:1})]),_:1})}}});export{Do as default};
