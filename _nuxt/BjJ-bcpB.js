import{a_ as Ae,bl as De,bk as Ee,bx as Ne,bn as oe,b0 as Me,b8 as s,b9 as L,b1 as Be,ba as Re,bb as Fe,b3 as P,aX as a,bO as Oe,aT as _,br as T,aS as K,b4 as o,bs as We,bP as Le,aY as A,bi as $e,aW as l,bt as ze,aU as u,bf as f,bg as je,cR as qe,bR as $,bS as Ge,bE as He,bq as Ke,b2 as Xe,cS as Ye,bN as Ze,aQ as Qe}from"./CfseOdbi.js";import{_ as Je,a as eo}from"./Vz5hS-_V.js";import{_ as oo}from"./-gN7atBo.js";import{_ as lo}from"./Cs0rOM-S.js";import{_ as to}from"./CGD-2gor.js";import{c as ao,_ as no,E as so,p as io}from"./Bf4zBdpk.js";import{_ as uo}from"./qaQ7udST.js";import{_ as ro}from"./D8_THKns.js";import{_ as mo}from"./YhmgSYdO.js";import{_ as co,a as po,b as fo}from"./Bj_w0LaQ.js";import{u as bo}from"./CLNw9kjo.js";import{u as vo}from"./C1nflsXw.js";import"./W06PnaAv.js";import"./C0bDvF5Q.js";import"./Du4xQxEZ.js";import"./DkdshRd_.js";import"./CS540GWc.js";(function(){try{var h=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D=new h.Error().stack;D&&(h._sentryDebugIds=h._sentryDebugIds||{},h._sentryDebugIds[D]="6beec083-2876-4532-91aa-f97f41e5a22e",h._sentryDebugIdIdentifier="sentry-dbid-6beec083-2876-4532-91aa-f97f41e5a22e")}catch{}})();const go={class:"flex items-start gap-[12px] w-full px-[12px] mb-[12px]"},yo=["src"],_o={class:"flex gap-2"},wo={class:"flex justify-end items-center"},ho={class:"flex justify-between items-center w-full"},xo={key:0,class:"mt-[24px] flex flex-col gap-[12px]"},ko={class:"flex gap-2"},Co={class:"flex justify-end items-center"},Vo={class:"grid md:grid-cols-2 gap-4"},So=Ae({__name:"new",setup(h){const D=De(),X=Ee(),le=Ne(),te=bo(),Y=vo(),{wallet:V}=oe(D),{newNFTBookCollection:ae}=le,{getClassMetadataById:ne,lazyFetchClassMetadataById:Z}=te,{fetchStripeConnectStatusByWallet:se}=Y,{getStripeConnectStatusByWallet:ie}=oe(Y),ue=Me(),w=s(""),v=s(!1),re=s({en:"Collection description in English...",zh:"套裝中文描述..."}),de=s("New Book Collection Name"),E=s("新書集名稱"),me=s(""),N=s(""),x=s(""),m=s(""),k=s([]),i=s({price:Ze,stock:Ye,hasShipping:!1,isPhysicalOnly:!1,isAllowCustomPrice:!0,isUnlisted:!1,deliveryMethod:"auto",autoMemo:"Thank you for your support. It means a lot to me."}),C=s([]),M=s([]),B=s([]),c=s(""),p=s(""),R=s(!0),F=s(!1),O=s(!1),S=s(!1),U=s(""),z=s(!1),j=s(!0),ce=["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"],pe=L(()=>"Submit"),fe=L(()=>[{key:"wallet",label:"Wallet",sortable:!0},{key:"remove",label:"",sortable:!1}]),be=L(()=>M.value.map((n,e)=>({index:e,wallet:n,walletLink:Oe(n)}))),ve=L(()=>B.value.map((n,e)=>({index:e,email:n})));ao({markdownItConfig(n){n.options.html=!1}}),Be(async()=>{try{if(v.value=!0,V.value){try{await se(V.value)}catch(n){console.error(n)}ie.value(V.value).isReady&&(S.value=!0,U.value=V.value)}}catch(n){console.error(n)}finally{v.value=!1}}),Re(v,n=>{n&&(w.value="")}),Fe({title:"New Book Collection",ogTitle:"New Book Collection"});function ge(n){Number(n.data)===0&&(i.value.isAllowCustomPrice=!0)}function ye(){if(m.value){if(k.value.includes(m.value)){w.value="Class ID already exists";return}if(!m.value.startsWith("0x")){w.value="Invalid Class ID";return}k.value.push(m.value),Z(m.value),m.value=""}}function _e(n){C.value=n}function we(){c.value&&(M.value.push(c.value),c.value="")}function he(){p.value&&(B.value.push(p.value),p.value="")}function xe(n){U.value=n,z.value=!0}function ke(n){return{priceInDecimal:Math.round(Number(n.price)*100),stock:Number(n.stock),hasShipping:!!(n.hasShipping||C.value.length),isPhysicalOnly:!!n.isPhysicalOnly,isAllowCustomPrice:!!(n.isAllowCustomPrice??!0),isUnlisted:!!(n.isUnlisted??!1),isAutoDeliver:!n.isPhysicalOnly&&n.deliveryMethod==="auto",autoMemo:n.autoMemo}}function Q(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ce(n){return io.sanitize(n)}async function Ve(){try{if(m.value)throw new Error('Please press "Add" button to add NFT class ID');if(!k.value.length)throw new Error('Please press "Add" button to add NFT class ID');if(c.value)throw new Error('Please press "Add" button to add moderator wallet');if(p.value)throw new Error('Please press "Add" button to add notification email');if(v.value=!0,await Promise.all(k.value.map(async g=>{const r=(await Z(g)).nft_meta_collection_id||"";if(!r.includes("nft_book")&&!r.includes("book_nft"))throw new Error("NFT Class not in NFT BOOK meta collection")})),Number(i.value.price)!==0&&i.value.price<$)throw new Error(`Price of each edition must be at least $${$} or $0 (free)`);const n=S.value&&U.value?{[U.value]:100}:null,e=C.value.length?C.value.map(g=>({name:{en:g.name.en,zh:g.name.zh},priceInDecimal:Math.round(Number(g.price)*100),price:Number(g.price)})):void 0,q=ke(i.value);await ae({classIds:k.value,defaultPaymentCurrency:"USD",connectedWallets:n,moderatorWallets:M.value,notificationEmails:B.value,shippingRates:e,name:{en:de.value,zh:E.value},description:{en:Q(me.value),zh:Q(N.value)},image:x.value,hideDownload:F.value,mustClaimToView:R.value,...q}),Xe(ue({name:"nft-book-store-collection"}))}catch(n){const e=n.data||n;console.error(e),w.value=e}finally{z.value=!1,v.value=!1}}function Se(){return Ve()}return(n,e)=>{const q=We,g=Le,W=Je,r=oo,b=je,y=ze,d=lo,Ue=to,G=He,H=no,I=eo,J=uo,Ie=ro,Pe=mo;return _(),P(Pe,null,{default:a(()=>[o(w)?(_(),P(q,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${o(w)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:e[0]||(e[0]=t=>w.value="")},null,8,["title"])):T("",!0),o(v)?(_(),P(g,{key:1,animation:"carousel"},{indicator:a(()=>e[20]||(e[20]=[A(" Loading... ")])),_:1})):T("",!0),o(X).isAuthenticated?(_(),K($e,{key:2},[l(y,{ui:{body:{base:"space-y-4"}}},{header:a(()=>e[21]||(e[21]=[u("h2",{class:"font-bold font-mono"}," New Book Collection Info ",-1)])),default:a(()=>[l(d,{label:"Books in Collection"},{default:a(()=>[l(y,{ui:{body:{padding:""}}},{default:a(()=>[l(W,{columns:[{key:"classId",label:"Class ID"},{key:"name",label:"Book Name"}],rows:o(k).map((t,Te)=>{var ee;return{index:Te,classId:t,name:(ee=o(ne)(t))==null?void 0:ee.name}})},null,8,["rows"]),u("div",go,[l(r,{modelValue:o(m),"onUpdate:modelValue":e[1]||(e[1]=t=>f(m)?m.value=t:null),class:"font-mono w-full",placeholder:"0x...."},null,8,["modelValue"]),l(b,{onClick:ye},{default:a(()=>e[22]||(e[22]=[A(" Add ")])),_:1,__:[22]})])]),_:1})]),_:1}),l(d,{label:"Total number of packages available for sale"},{default:a(()=>[l(r,{modelValue:o(i).stock,"onUpdate:modelValue":e[2]||(e[2]=t=>o(i).stock=t),type:"number",step:"1",min:0,max:o(qe)},null,8,["modelValue","max"])]),_:1})]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[23]||(e[23]=[u("h3",{class:"font-bold font-mono"}," Pricing and Availability ",-1)])),default:a(()=>[l(d,{label:`Price(USD) of this collection (Minimal ${o($)} or $0 (free)) / 版本定價（美金）`},{default:a(()=>[l(r,{modelValue:o(i).price,"onUpdate:modelValue":e[3]||(e[3]=t=>o(i).price=t),type:"number",step:"0.01",min:o($),onInput:ge},null,8,["modelValue","min"])]),_:1},8,["label"]),l(Ue,{modelValue:o(i).deliveryMethod,"onUpdate:modelValue":e[4]||(e[4]=t=>o(i).deliveryMethod=t),disabled:o(i).isPhysicalOnly,legend:"Delivery method of this collection / 自動或手動發書",options:o(Ge)},null,8,["modelValue","disabled","options"]),o(i).deliveryMethod==="auto"?(_(),P(d,{key:0},{label:a(()=>[e[25]||(e[25]=A(" Memo of this collection / 自動發書留言 ")),l(H,null,{image:a(()=>e[24]||(e[24]=[u("img",{src:co,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(G,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(r,{modelValue:o(i).autoMemo,"onUpdate:modelValue":e[5]||(e[5]=t=>o(i).autoMemo=t)},null,8,["modelValue"])]),_:1})):(_(),P(d,{key:1,label:"Is Physical only good / 只含實體書",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(I,{modelValue:o(i).isPhysicalOnly,"onUpdate:modelValue":e[6]||(e[6]=t=>o(i).isPhysicalOnly=t),name:"isPhysicalOnly",label:"This collection does not contain any digital file/NFT"},null,8,["modelValue"])]),_:1})),l(d,null,{label:a(()=>[e[27]||(e[27]=A(" Allow custom price / 開啟打賞功能 ")),l(H,{"image-style":{width:"300px"}},{image:a(()=>e[26]||(e[26]=[u("img",{src:po,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(G,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(I,{modelValue:o(i).isAllowCustomPrice,"onUpdate:modelValue":e[7]||(e[7]=t=>o(i).isAllowCustomPrice=t),name:"isAllowCustomPrice",label:"Allow user to pay more than defined price"},null,8,["modelValue"])]),_:1}),l(d,{label:"Unlist Edition / 暫時下架"},{default:a(()=>[l(I,{modelValue:o(i).isUnlisted,"onUpdate:modelValue":e[8]||(e[8]=t=>o(i).isUnlisted=t),name:"isUnlisted",label:"Pause selling of this Edition"},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[28]||(e[28]=[u("h3",{class:"font-bold font-mono"}," Product Information ",-1)])),default:a(()=>[l(d,{ui:{container:"space-y-2 my-[20px]"}},{label:a(()=>[e[30]||(e[30]=A(" 產品名稱（中文） ")),l(H,{"image-style":{width:"250px"}},{image:a(()=>e[29]||(e[29]=[u("img",{src:fo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(G,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(r,{modelValue:o(E),"onUpdate:modelValue":e[9]||(e[9]=t=>f(E)?E.value=t:null),placeholder:"產品中文名字"},null,8,["modelValue"]),e[31]||(e[31]=u("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),l(o(so),{modelValue:o(N),"onUpdate:modelValue":e[10]||(e[10]=t=>f(N)?N.value=t:null),language:"en-US","editor-id":"zh",placeholder:o(re).zh,toolbars:ce,sanitize:Ce,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder"])]),_:1,__:[31]}),l(d,{label:"Image of this book collection",ui:{container:"space-y-2"}},{default:a(()=>[l(r,{modelValue:o(x),"onUpdate:modelValue":e[11]||(e[11]=t=>f(x)?x.value=t:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),o(x)?(_(),K("img",{key:0,src:o(Ke)(o(x)),class:"w-1/3"},null,8,yo)):T("",!0)]),_:1}),l(J,{modelValue:o(i).hasShipping,"onUpdate:modelValue":e[12]||(e[12]=t=>o(i).hasShipping=t),"is-show-physical-goods-checkbox":!0,"is-show-setting-modal-button":!0,"shipping-info":o(C)},null,8,["modelValue","shipping-info"])]),_:1}),l(Ie,{"is-stripe-connect-checked":o(S),"onUpdate:isStripeConnectChecked":e[13]||(e[13]=t=>f(S)?S.value=t:null),"is-using-default-account":o(j),"onUpdate:isUsingDefaultAccount":e[14]||(e[14]=t=>f(j)?j.value=t:null),"stripe-connect-wallet":o(U),"should-disable-setting":o(z),"login-address":o(V),onSave:xe},null,8,["is-stripe-connect-checked","is-using-default-account","stripe-connect-wallet","should-disable-setting","login-address"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:""}}},{header:a(()=>[e[32]||(e[32]=u("h4",{class:"text-sm font-bold font-mono"}," Email to receive sales notifications / 欲收到銷售通知的電郵 ",-1)),u("div",_o,[l(r,{modelValue:o(p),"onUpdate:modelValue":e[15]||(e[15]=t=>f(p)?p.value=t:null),placeholder:"abc@example.com"},null,8,["modelValue"]),l(b,{label:"Add",variant:o(p)?"outline":"solid",color:o(p)?"primary":"gray",disabled:!o(p),onClick:he},null,8,["variant","color","disabled"])])]),default:a(()=>[l(W,{columns:[{key:"email",label:"Email",sortable:!0},{key:"action"}],rows:o(ve)},{"email-data":a(({row:t})=>[l(b,{label:t.email,to:`mailto:${t.email}`,variant:"link",padded:!1},null,8,["label","to"])]),"action-data":a(({row:t})=>[u("div",wo,[l(b,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(B).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["rows"])]),_:1}),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"12px"}}},{default:a(()=>[u("div",ho,[e[33]||(e[33]=u("h3",{class:"font-bold font-mono"}," Advanced Settings ",-1)),l(b,{color:"gray",variant:"ghost",icon:o(O)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:e[16]||(e[16]=()=>{O.value=!o(O)})},null,8,["icon"])]),o(O)?(_(),K("div",xo,[l(J,{"is-show-physical-goods-checkbox":!1,"shipping-info":o(C),"is-show-setting-modal-button":!0,onUpdateShippingRates:_e},{header:a(()=>e[34]||(e[34]=[u("span",{class:"text-[14px] text-gray-500"}," (Includes physical good that requires shipping) ",-1)])),_:1},8,["shipping-info"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"",base:"space-y-8"}}},{header:a(()=>[e[35]||(e[35]=u("h4",{class:"text-sm font-bold font-mono"}," Share sales data to wallets / 分享銷售數據給特定地址 ",-1)),u("div",ko,[l(r,{modelValue:o(c),"onUpdate:modelValue":e[17]||(e[17]=t=>f(c)?c.value=t:null),class:"font-mono",placeholder:"0x..."},null,8,["modelValue"]),l(b,{label:"Add",variant:o(c)?"outline":"solid",color:o(c)?"primary":"gray",disabled:!o(c),onClick:we},null,8,["variant","color","disabled"])])]),default:a(()=>[l(W,{columns:o(fe),rows:o(be)},{"wallet-data":a(({row:t})=>[l(b,{class:"font-mono",label:t.wallet,to:t.walletLink,variant:"link",padded:!1},null,8,["label","to"])]),"remove-data":a(({row:t})=>[u("div",Co,[l(b,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(M).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(y,{ui:{body:{base:"space-y-8"}}},{header:a(()=>e[36]||(e[36]=[u("h3",{class:"font-bold font-mono"}," DRM Options / 數位版權管理選項 ",-1)])),default:a(()=>[u("div",Vo,[l(d,{label:"Force NFT claim before view",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(I,{modelValue:o(R),"onUpdate:modelValue":e[18]||(e[18]=t=>f(R)?R.value=t:null),name:"mustClaimToView",label:"Must claim NFT to view"},null,8,["modelValue"])]),_:1}),l(d,{label:"Disable File Download",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(I,{modelValue:o(F),"onUpdate:modelValue":e[19]||(e[19]=t=>f(F)?F.value=t:null),name:"hideDownload",label:"Disable Download"},null,8,["modelValue"])]),_:1})])]),_:1})])):T("",!0)]),_:1}),l(b,{label:o(pe),loading:o(v),size:"lg",disabled:o(v),onClick:Se},null,8,["label","loading","disabled"])],64)):T("",!0)]),_:1})}}}),jo=Qe(So,[["__scopeId","data-v-bfaa5de7"]]);export{jo as default};
