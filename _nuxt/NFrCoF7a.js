import{_ as Re}from"./BAS2LMTG.js";import{n as Le,u as Ne,x as Ee,T as Pe,a2 as Be,r as u,h as ie,C as b,y as Me,z as $e,o as _,B,w as s,F as a,W as de,b as t,a as d,t as re,G as v,N as M,c as F,H as X,I as Ae,K as De,a8 as Te,J as ze,L as Oe,Q as je}from"./D6SWFTK-.js";import{_ as Fe}from"./jeUQpFuS.js";import{_ as Ge}from"./0EjnBa-A.js";import{_ as Je}from"./Dyu6Qreo.js";import{_ as Qe}from"./BEp4rydo.js";import{_ as We}from"./DvoYa4fO.js";import{_ as qe}from"./zv8PlfhH.js";import{_ as He}from"./D0W9f-1Z.js";import{_ as Ke}from"./CblZZMOj.js";import{_ as Xe}from"./D5Q5cyAY.js";import{u as Ye}from"./DSW8pRRf.js";import"./BEr8OvV9.js";import"./z9SAchJH.js";import"./BIJ64lMo.js";import"./DR5WqLUx.js";import"./Cm-uwJtc.js";(function(){try{var L=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$=new Error().stack;$&&(L._sentryDebugIds=L._sentryDebugIds||{},L._sentryDebugIds[$]="cd0eaf69-3a8b-461e-928e-54a5a4c91b7e",L._sentryDebugIdIdentifier="sentry-dbid-cd0eaf69-3a8b-461e-928e-54a5a4c91b7e")}catch{}})();const Ze={class:"flex items-center gap-2"},eo=["textContent"],oo={class:"flex items-start gap-4"},to=["src"],lo={class:"flex flex-col justify-start"},no=["textContent"],ao={class:"text-center"},so={class:"flex items-center gap-2 px-4 sm:px-6"},io={class:"flex items-center gap-2"},ro={class:"flex justify-center items-center gap-4"},uo={class:"flex justify-center items-center gap-4"},co={class:"flex items-center gap-2"},mo={class:"flex justify-center gap-4"},Lo=Le({__name:"index",setup(L){const $=Ne(),A=Ee(),{LIKER_LAND_URL:Y}=Pe().public,D=Ye(),G=Be(),{lazyFetchClassMetadataById:Z,lazyFetchClassListingInfoById:ee}=D,{lazyFetchCollectionById:oe}=G,c=u([{id:0,value:""}]),te=u(1),h=u(!1),C=u(""),y=u(""),k=u([]),m=u(""),w=u(""),p=u([]),I=u(!1),N=u(!1),U=u(!1);ie(I,o=>{o||(c.value=[{id:0,value:""}],te.value=1)});const ue=b(()=>{const o=[{key:"name",label:"Product",class:""}];return U.value&&o.push({key:"delete-action",label:"",class:"w-12"}),o}),ce=b(()=>{const o=[];return J.value.length&&o.push([{label:U.value?"Exit Edit Items":"Edit Items",icon:U.value?"i-heroicons-pencil-solid":"i-heroicons-pencil",click:he}]),o.push([{label:"New Coupon",icon:"i-heroicons-tag",click:()=>{h.value=!h.value}},{class:"text-red-500",label:"Clear All Coupons",icon:"i-heroicons-trash",iconClass:"text-red-500",disabled:!k.value.length,click:be}]),o}),J=b(()=>{var o;return(o=p.value)==null?void 0:o.map((e,i)=>{var n,T,E,z,O,j,g,x;return e.collectionId?{collectionId:e.collectionId,name:(n=G.getCollectionById(e.collectionId))==null?void 0:n.name,image:de((T=G.getCollectionById(e.collectionId))==null?void 0:T.image),index:i}:{classId:e.classId,name:(E=D.getClassMetadataById(e.classId))==null?void 0:E.name,prices:(O=(z=D.getClassListingInfoById(e.classId))==null?void 0:z.prices)==null?void 0:O.map(q=>({...q})),image:de((x=(g=(j=D.getClassMetadataById(e.classId))==null?void 0:j.data)==null?void 0:g.metadata)==null?void 0:x.image),index:i}})}),S=u([]),V=b(()=>S.value.map(e=>p.value[e.index]).sort((e,i)=>(e==null?void 0:e.priceIndex)!==void 0&&!(i!=null&&i.priceIndex)?-1:!(e!=null&&e.priceIndex)&&(i==null?void 0:i.priceIndex)!==void 0?1:0));ie(J,o=>{o.length||(U.value=!1)});const R=b(()=>{const o=new URLSearchParams({utm_source:"direct-checkout",utm_medium:"pos"});return V.value.forEach(({classId:e,priceIndex:i,collectionId:n})=>{e&&o.append("class_id",e),i&&o.append("price_index",i.toString()),n&&o.append("collection_id",n)}),m.value&&o.append("coupon",m.value),`${Y}/shopping-cart/book?${o.toString()}`}),me=b(()=>{const o=new URLSearchParams({gift_to_email:w.value,checkout:"1",utm_source:"direct-sales",utm_medium:"pos"});return V.value.forEach(({classId:e,priceIndex:i,collectionId:n})=>{e&&o.append("class_id",e),i&&o.append("price_index",i.toString()),n&&o.append("collection_id",n)}),m.value&&o.append("coupon",m.value),`${Y}/shopping-cart/book?${o.toString()}`}),Q=b(()=>"Liker Land Point Of Sale");Me({title:Q.value,ogTitle:Q.value}),$e(()=>{try{const o=window.localStorage.getItem("nft_book_store_pos_items");if(o){const i=JSON.parse(o);p.value=i.map(n=>({collectionId:n.collectionId,classId:n.classId,priceIndex:n.priceIndex}))}const e=window.localStorage.getItem("nft_book_store_pos_coupons");if(e){const i=JSON.parse(e);k.value=i.map(n=>({name:n.name,code:n.code}))}}catch(o){console.error(o)}p.value.forEach(o=>{o.classId&&(Z(o.classId),ee(o.classId)),o.collectionId&&oe(o.collectionId)})});function pe(){c.value.length&&c.value.push({id:te.value++,value:""})}function fe(o){c.value.splice(o,1)}function _e(o,e){c.value[o].error=void 0,c.value[o].value=e}function ve(){c.value.forEach(o=>{o.error=void 0;let e=o.value.trim();e.startsWith("http")&&(e=new URL(e).pathname.split("/").pop()||""),e.startsWith("likenft")?(p.value.push({classId:e,priceIndex:0}),Z(e),ee(e)):e.startsWith("col_book_")?(p.value.push({collectionId:e}),oe(e)):o.error=new Error("Invalid product ID")}),c.value.every(o=>!o.error)&&(I.value=!1,W())}function ge(o,{index:e}){p.value[e].priceIndex=Number(o),W()}function xe({index:o}){p.value.splice(o,1),S.value=S.value.filter(e=>e.index!==o),W()}function le(){I.value=!I.value}function he(){U.value=!U.value}function Ie(){k.value.push({name:C.value,code:y.value}),C.value="",y.value="",ne(),A.add({title:"Added coupon",timeout:2e3,color:"green"}),h.value=!1}function be(){window.confirm("Are you sure you want to clear all coupons?")&&(k.value=[],m.value="",ne(),A.add({title:"Cleared all coupons",timeout:2e3,color:"red"}))}function W(){window.localStorage.setItem("nft_book_store_pos_items",JSON.stringify(p.value))}function ne(){window.localStorage.setItem("nft_book_store_pos_coupons",JSON.stringify(k.value))}function Ce(){A.add({title:"Copied URL to clipboard",timeout:2e3}),navigator.clipboard.writeText(R.value)}function ye(){window.open(R.value)}function ke(){N.value=!0}function we(){if(!w.value){alert("Please enter email");return}window.open(me.value)}return(o,e)=>{const i=Re,n=De,T=Fe,E=Ge,z=Te,O=Je,j=ze,g=Qe,x=We,q=qe,H=Oe,Ue=He,K=je,Se=Ke,Ve=Xe;return _(),B(Ve,{key:a($).path},{default:s(()=>[t(i,{title:a(Q)},null,8,["title"]),t(Se,{ui:{base:"flex flex-col items-stretch grow space-y-4",padding:"max-md:!px-0 max-md:py-0"}},{default:s(()=>[t(K,{ui:{base:"flex flex-col grow",rounded:"max-md:rounded-none",header:{base:"flex justify-between items-center gap-4"},body:{base:"grow",padding:""},footer:{base:"sticky bottom-0 bg-white dark:bg-gray-900 rounded-b-[inherit]",padding:"px-0 sm:px-0 space-y-4"}}},{header:s(()=>[d("div",Ze,[d("h2",{class:"text-xl font-bold",textContent:re(`Sales Items${a(V).length>0?` (${a(V).length} selected)`:""}`)},null,8,eo),t(n,{icon:"i-heroicons-plus-circle",variant:"soft",onClick:le})]),t(T,{items:a(ce),popper:{placement:"bottom-end"}},{default:s(()=>[t(n,{color:"white",icon:"i-heroicons-ellipsis-horizontal-circle"})]),_:1},8,["items"])]),footer:s(()=>[d("div",so,[t(E,{modelValue:a(m),"onUpdate:modelValue":e[1]||(e[1]=l=>v(m)?m.value=l:null),class:"grow",options:a(k).map(l=>({label:l.name,value:l.code})),placeholder:"Select Coupon"},null,8,["modelValue","options"]),a(m)?(_(),B(n,{key:0,icon:"i-heroicons-x-mark-16-solid",size:"sm",color:"gray",variant:"outline",onClick:e[2]||(e[2]=()=>{m.value=""})})):M("",!0)]),t(j),t(Ue,{class:"w-full",items:[{key:"direct",label:"Direct Checkout"},{key:"gift",label:"Gift Checkout"}],ui:{wrapper:"px-4 sm:px-6",base:"flex flex-col space-y-4"}},{item:s(({item:l})=>[l.key==="direct"?(_(),F(X,{key:0},[t(x,{label:"Checkout URL"},{default:s(()=>[d("div",io,[t(g,{modelValue:a(R),"onUpdate:modelValue":e[3]||(e[3]=r=>v(R)?R.value=r:null),class:"grow font-mono",readonly:""},null,8,["modelValue"]),t(n,{icon:"i-heroicons-clipboard-document",variant:"soft",color:"gray",onClick:Ce})])]),_:1}),d("div",ro,[t(n,{label:"View Cart",size:"lg",onClick:ye}),t(n,{label:"Generate QR Code",disabled:!a(V).length,size:"lg",onClick:ke},null,8,["disabled"]),t(H,{modelValue:a(N),"onUpdate:modelValue":e[5]||(e[5]=r=>v(N)?N.value=r:null),ui:{padding:"p-0",rounded:"max-sm:rounded-b-none"}},{default:s(()=>[t(q,{data:a(R),mode:"readonly","file-name":"likerland_checkout",width:280,height:280},{header:s(()=>[e[12]||(e[12]=d("h3",{class:"font-bold font-mono",textContent:"Scan to buy"},null,-1)),t(n,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:e[4]||(e[4]=r=>N.value=!1)})]),_:1},8,["data"])]),_:1},8,["modelValue"])])],64)):l.key==="gift"?(_(),F(X,{key:1},[t(x,{label:"Receiver Email"},{default:s(()=>[t(g,{modelValue:a(w),"onUpdate:modelValue":e[6]||(e[6]=r=>v(w)?w.value=r:null),type:"email",placeholder:"example@liker.land"},null,8,["modelValue"])]),_:1}),d("div",uo,[t(n,{label:"Send Gift",disabled:!a(V).length||!a(w),size:"lg",onClick:we},null,8,["disabled"])])],64)):M("",!0)]),_:1})]),default:s(()=>[t(O,{modelValue:a(S),"onUpdate:modelValue":e[0]||(e[0]=l=>v(S)?S.value=l:null),columns:a(ue),rows:a(J),ui:{wrapper:"static h-full",thead:"sticky top-0"}},{"name-data":s(({row:l})=>{var r,P;return[d("div",oo,[l.image?(_(),F("img",{key:0,class:"w-[64px] object-contain rounded-sm",src:l.image},null,8,to)):M("",!0),d("div",lo,[d("div",{class:"whitespace-break-spaces",textContent:re(l.name)},null,8,no),l.classId&&((r=l.prices)==null?void 0:r.length)>1?(_(),B(E,{key:0,class:"mt-2","model-value":a(p)[l.index].priceIndex||0,options:(P=l.prices)==null?void 0:P.map(f=>{var ae,se;return{label:((ae=f.name)==null?void 0:ae.zh)||((se=f.name)==null?void 0:se.en)||f.name,value:f.index}}),"onUpdate:modelValue":f=>ge(f,l)},null,8,["model-value","options","onUpdate:modelValue"])):M("",!0)])])]}),"delete-action-header":s(()=>[d("div",ao,[t(z,{name:"i-heroicons-trash-solid"})])]),"delete-action-data":s(({row:l})=>[t(n,{icon:"i-heroicons-x-mark",color:"red",variant:"link",onClick:r=>xe(l)},null,8,["onClick"])]),_:1},8,["modelValue","columns","rows"])]),_:1}),t(H,{modelValue:a(I),"onUpdate:modelValue":e[7]||(e[7]=l=>v(I)?I.value=l:null),ui:{padding:"p-0",rounded:"max-sm:rounded-b-none"}},{default:s(()=>[t(K,{ui:{rounded:"max-sm:rounded-b-none",header:{base:"flex justify-between items-center gap-4"},body:{base:"space-y-4"},footer:{base:"flex justify-center items-center"}}},{header:s(()=>[e[13]||(e[13]=d("h3",{class:"font-bold font-mono",textContent:"Add Item(s)"},null,-1)),t(n,{icon:"i-heroicons-x-mark",color:"gray",variant:"link",onClick:le})]),footer:s(()=>[t(n,{label:"Confirm",onClick:ve})]),default:s(()=>[(_(!0),F(X,null,Ae(a(c),(l,r)=>{var P;return _(),B(x,{key:`input-${l.id}`,label:"Enter Product ID/URL(s)",required:!0,error:(P=l.error)==null?void 0:P.message},{default:s(()=>[d("div",co,[t(g,{class:"grow font-mono","model-value":l.value,placeholder:"https://liker.land/nft/class/likenft....","onUpdate:modelValue":f=>_e(r,f)},null,8,["model-value","onUpdate:modelValue"]),a(c).length>1?(_(),B(n,{key:0,icon:"i-heroicons-x-circle",variant:"link",onClick:f=>fe(r)},null,8,["onClick"])):M("",!0)])]),_:2},1032,["error"])}),128)),d("div",mo,[t(n,{icon:"i-heroicons-plus-circle",label:"Add",variant:"outline",onClick:pe})])]),_:1})]),_:1},8,["modelValue"]),t(H,{modelValue:a(h),"onUpdate:modelValue":e[11]||(e[11]=l=>v(h)?h.value=l:null),ui:{padding:"p-0",rounded:"max-sm:rounded-b-none"}},{default:s(()=>[t(K,{ui:{rounded:"max-sm:rounded-b-none",header:{base:"flex justify-between items-center gap-4"},body:{base:"space-y-4"},footer:{base:"flex justify-end items-center gap-4"}}},{header:s(()=>[e[14]||(e[14]=d("h3",{class:"font-bold",textContent:"Add Coupon"},null,-1)),t(n,{icon:"i-heroicons-x-mark-16-solid",color:"gray",size:"xl",padded:!1,variant:"link",onClick:e[8]||(e[8]=l=>h.value=!1)})]),footer:s(()=>[t(n,{icon:"i-heroicons-plus-circle",label:"Add Coupon",disabled:!a(C)||!a(y),onClick:Ie},null,8,["disabled"])]),default:s(()=>[t(x,{label:"Coupon Name",help:"For POS Display Only",required:!0},{default:s(()=>[t(g,{modelValue:a(C),"onUpdate:modelValue":e[9]||(e[9]=l=>v(C)?C.value=l:null),placeholder:"Fall Promotion"},null,8,["modelValue"])]),_:1}),t(x,{label:"Coupon Code",required:!0},{default:s(()=>[t(g,{modelValue:a(y),"onUpdate:modelValue":e[10]||(e[10]=l=>v(y)?y.value=l:null),class:"font-mono",placeholder:"FALLPROMO"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{Lo as default};
//# sourceMappingURL=NFrCoF7a.js.map
