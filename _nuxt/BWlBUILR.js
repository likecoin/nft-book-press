import{a_ as Ae,bj as De,bi as Ee,bv as Me,bl as oe,a$ as Ne,b5 as s,b6 as $,b0 as Be,b7 as Re,b8 as Fe,b1 as I,aX as a,bL as Oe,aT as _,bp as T,aS as H,bd as o,bq as We,bM as $e,aY as A,bg as Le,aW as l,br as ze,aU as r,bc as f,be as je,cO as qe,bO as L,bP as Ke,bB as Ge,bo as He,cP as Xe,bK as Ye,aQ as Ze}from"./Dm55n_q7.js";import{_ as Qe,a as Je}from"./p9-vOCy2.js";import{_ as eo}from"./BeJGAGuW.js";import{_ as oo}from"./BNRh5wRg.js";import{_ as lo}from"./DEPwAapD.js";import{c as to,_ as ao,E as no,p as so}from"./BdiLvJkd.js";import{_ as io}from"./C4DGkdUg.js";import{_ as ro}from"./ClRMv8VZ.js";import{_ as uo}from"./BrbWWaox.js";import{_ as mo,a as co,b as po}from"./R5tSbLe2.js";import{u as fo}from"./BZ3sWSG7.js";import{u as bo}from"./BfIUIP0I.js";import"./DGf9HjKN.js";import"./Dbnh4rXa.js";import"./vDgaBV0F.js";import"./ClLRtDMI.js";import"./FexUiCd7.js";(function(){try{var w=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},D=new w.Error().stack;D&&(w._sentryDebugIds=w._sentryDebugIds||{},w._sentryDebugIds[D]="a2a748ac-eb0e-4ef7-9d9b-b771ef252505",w._sentryDebugIdIdentifier="sentry-dbid-a2a748ac-eb0e-4ef7-9d9b-b771ef252505")}catch{}})();const vo={class:"flex items-start gap-[12px] w-full px-[12px] mb-[12px]"},go=["src"],yo={class:"flex gap-2"},_o={class:"flex justify-end items-center"},ho={class:"flex justify-between items-center w-full"},wo={key:0,class:"mt-[24px] flex flex-col gap-[12px]"},xo={class:"flex gap-2"},ko={class:"flex justify-end items-center"},Co={class:"grid md:grid-cols-2 gap-4"},Vo=Ae({__name:"new",setup(w){const D=De(),X=Ee(),le=Me(),te=fo(),Y=bo(),{wallet:V}=oe(D),{newNFTBookCollection:ae}=le,{getClassMetadataById:ne,lazyFetchClassMetadataById:Z}=te,{fetchStripeConnectStatusByWallet:se}=Y,{getStripeConnectStatusByWallet:ie}=oe(Y),re=Ne(),h=s(""),v=s(!1),ue=s({en:"Collection description in English...",zh:"套裝中文描述..."}),de=s("New Book Collection Name"),E=s("新書集名稱"),me=s(""),M=s(""),x=s(""),m=s(""),k=s([]),i=s({price:Ye,stock:Xe,hasShipping:!1,isPhysicalOnly:!1,isAllowCustomPrice:!0,isUnlisted:!1,deliveryMethod:"auto",autoMemo:"Thank you for your support. It means a lot to me."}),C=s([]),N=s([]),B=s([]),c=s(""),p=s(""),R=s(!0),F=s(!1),O=s(!1),U=s(!1),S=s(""),z=s(!1),j=s(!0),ce=["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"],pe=$(()=>"Submit"),fe=$(()=>[{key:"wallet",label:"Wallet",sortable:!0},{key:"remove",label:"",sortable:!1}]),be=$(()=>N.value.map((n,e)=>({index:e,wallet:n,walletLink:Oe(n)}))),ve=$(()=>B.value.map((n,e)=>({index:e,email:n})));to({markdownItConfig(n){n.options.html=!1}}),Be(async()=>{try{if(v.value=!0,V.value){try{await se(V.value)}catch(n){console.error(n)}ie.value(V.value).isReady&&(U.value=!0,S.value=V.value)}}catch(n){console.error(n)}finally{v.value=!1}}),Re(v,n=>{n&&(h.value="")}),Fe({title:"New Book Collection",ogTitle:"New Book Collection"});function ge(n){Number(n.data)===0&&(i.value.isAllowCustomPrice=!0)}function ye(){if(m.value){if(k.value.includes(m.value)){h.value="Class ID already exists";return}if(!m.value.startsWith("0x")){h.value="Invalid Class ID";return}k.value.push(m.value),Z(m.value),m.value=""}}function _e(n){C.value=n}function he(){c.value&&(N.value.push(c.value),c.value="")}function we(){p.value&&(B.value.push(p.value),p.value="")}function xe(n){S.value=n,z.value=!0}function ke(n){return{priceInDecimal:Math.round(Number(n.price)*100),stock:Number(n.stock),hasShipping:!!(n.hasShipping||C.value.length),isPhysicalOnly:!!n.isPhysicalOnly,isAllowCustomPrice:!!(n.isAllowCustomPrice??!0),isUnlisted:!!(n.isUnlisted??!1),isAutoDeliver:!n.isPhysicalOnly&&n.deliveryMethod==="auto",autoMemo:n.autoMemo}}function Q(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ce(n){return so.sanitize(n)}async function Ve(){try{if(m.value)throw new Error('Please press "Add" button to add NFT class ID');if(!k.value.length)throw new Error('Please press "Add" button to add NFT class ID');if(c.value)throw new Error('Please press "Add" button to add moderator wallet');if(p.value)throw new Error('Please press "Add" button to add notification email');if(v.value=!0,await Promise.all(k.value.map(async g=>{const u=(await Z(g)).nft_meta_collection_id||"";if(!u.includes("nft_book")&&!u.includes("book_nft"))throw new Error("NFT Class not in NFT BOOK meta collection")})),Number(i.value.price)!==0&&i.value.price<L)throw new Error(`Price of each edition must be at least $${L} or $0 (free)`);const n=U.value&&S.value?{[S.value]:100}:null,e=C.value.length?C.value.map(g=>({name:{en:g.name.en,zh:g.name.zh},priceInDecimal:Math.round(Number(g.price)*100),price:Number(g.price)})):void 0,q=ke(i.value);await ae({classIds:k.value,defaultPaymentCurrency:"USD",connectedWallets:n,moderatorWallets:N.value,notificationEmails:B.value,shippingRates:e,name:{en:de.value,zh:E.value},description:{en:Q(me.value),zh:Q(M.value)},image:x.value,hideDownload:F.value,mustClaimToView:R.value,...q}),re.push({name:"nft-book-store-collection"})}catch(n){const e=n.data||n;console.error(e),h.value=e}finally{z.value=!1,v.value=!1}}function Ue(){return Ve()}return(n,e)=>{const q=We,g=$e,W=Qe,u=eo,b=je,y=ze,d=oo,Se=lo,K=Ge,G=ao,P=Je,J=io,Pe=ro,Ie=uo;return _(),I(Ie,null,{default:a(()=>[o(h)?(_(),I(q,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${o(h)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:e[0]||(e[0]=t=>h.value="")},null,8,["title"])):T("",!0),o(v)?(_(),I(g,{key:1,animation:"carousel"},{indicator:a(()=>e[20]||(e[20]=[A(" Loading... ")])),_:1})):T("",!0),o(X).isAuthenticated?(_(),H(Le,{key:2},[l(y,{ui:{body:{base:"space-y-4"}}},{header:a(()=>e[21]||(e[21]=[r("h2",{class:"font-bold font-mono"}," New Book Collection Info ",-1)])),default:a(()=>[l(d,{label:"Books in Collection"},{default:a(()=>[l(y,{ui:{body:{padding:""}}},{default:a(()=>[l(W,{columns:[{key:"classId",label:"Class ID"},{key:"name",label:"Book Name"}],rows:o(k).map((t,Te)=>{var ee;return{index:Te,classId:t,name:(ee=o(ne)(t))==null?void 0:ee.name}})},null,8,["rows"]),r("div",vo,[l(u,{modelValue:o(m),"onUpdate:modelValue":e[1]||(e[1]=t=>f(m)?m.value=t:null),class:"font-mono w-full",placeholder:"0x...."},null,8,["modelValue"]),l(b,{onClick:ye},{default:a(()=>e[22]||(e[22]=[A(" Add ")])),_:1,__:[22]})])]),_:1})]),_:1}),l(d,{label:"Total number of packages available for sale"},{default:a(()=>[l(u,{modelValue:o(i).stock,"onUpdate:modelValue":e[2]||(e[2]=t=>o(i).stock=t),type:"number",step:"1",min:0,max:o(qe)},null,8,["modelValue","max"])]),_:1})]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[23]||(e[23]=[r("h3",{class:"font-bold font-mono"}," Pricing and Availability ",-1)])),default:a(()=>[l(d,{label:`Price(USD) of this collection (Minimal ${o(L)} or $0 (free)) / 版本定價（美金）`},{default:a(()=>[l(u,{modelValue:o(i).price,"onUpdate:modelValue":e[3]||(e[3]=t=>o(i).price=t),type:"number",step:"0.01",min:o(L),onInput:ge},null,8,["modelValue","min"])]),_:1},8,["label"]),l(Se,{modelValue:o(i).deliveryMethod,"onUpdate:modelValue":e[4]||(e[4]=t=>o(i).deliveryMethod=t),disabled:o(i).isPhysicalOnly,legend:"Delivery method of this collection / 自動或手動發書",options:o(Ke)},null,8,["modelValue","disabled","options"]),o(i).deliveryMethod==="auto"?(_(),I(d,{key:0},{label:a(()=>[e[25]||(e[25]=A(" Memo of this collection / 自動發書留言 ")),l(G,null,{image:a(()=>e[24]||(e[24]=[r("img",{src:mo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(K,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(u,{modelValue:o(i).autoMemo,"onUpdate:modelValue":e[5]||(e[5]=t=>o(i).autoMemo=t)},null,8,["modelValue"])]),_:1})):(_(),I(d,{key:1,label:"Is Physical only good / 只含實體書",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(P,{modelValue:o(i).isPhysicalOnly,"onUpdate:modelValue":e[6]||(e[6]=t=>o(i).isPhysicalOnly=t),name:"isPhysicalOnly",label:"This collection does not contain any digital file/NFT"},null,8,["modelValue"])]),_:1})),l(d,null,{label:a(()=>[e[27]||(e[27]=A(" Allow custom price / 開啟打賞功能 ")),l(G,{"image-style":{width:"300px"}},{image:a(()=>e[26]||(e[26]=[r("img",{src:co,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(K,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(P,{modelValue:o(i).isAllowCustomPrice,"onUpdate:modelValue":e[7]||(e[7]=t=>o(i).isAllowCustomPrice=t),name:"isAllowCustomPrice",label:"Allow user to pay more than defined price"},null,8,["modelValue"])]),_:1}),l(d,{label:"Unlist Edition / 暫時下架"},{default:a(()=>[l(P,{modelValue:o(i).isUnlisted,"onUpdate:modelValue":e[8]||(e[8]=t=>o(i).isUnlisted=t),name:"isUnlisted",label:"Pause selling of this Edition"},null,8,["modelValue"])]),_:1})]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[28]||(e[28]=[r("h3",{class:"font-bold font-mono"}," Product Information ",-1)])),default:a(()=>[l(d,{ui:{container:"space-y-2 my-[20px]"}},{label:a(()=>[e[30]||(e[30]=A(" 產品名稱（中文） ")),l(G,{"image-style":{width:"250px"}},{image:a(()=>e[29]||(e[29]=[r("img",{src:po,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(K,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(u,{modelValue:o(E),"onUpdate:modelValue":e[9]||(e[9]=t=>f(E)?E.value=t:null),placeholder:"產品中文名字"},null,8,["modelValue"]),e[31]||(e[31]=r("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),l(o(no),{modelValue:o(M),"onUpdate:modelValue":e[10]||(e[10]=t=>f(M)?M.value=t:null),language:"en-US","editor-id":"zh",placeholder:o(ue).zh,toolbars:ce,sanitize:Ce,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder"])]),_:1,__:[31]}),l(d,{label:"Image of this book collection",ui:{container:"space-y-2"}},{default:a(()=>[l(u,{modelValue:o(x),"onUpdate:modelValue":e[11]||(e[11]=t=>f(x)?x.value=t:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),o(x)?(_(),H("img",{key:0,src:o(He)(o(x)),class:"w-1/3"},null,8,go)):T("",!0)]),_:1}),l(J,{modelValue:o(i).hasShipping,"onUpdate:modelValue":e[12]||(e[12]=t=>o(i).hasShipping=t),"is-show-physical-goods-checkbox":!0,"is-show-setting-modal-button":!0,"shipping-info":o(C)},null,8,["modelValue","shipping-info"])]),_:1}),l(Pe,{"is-stripe-connect-checked":o(U),"onUpdate:isStripeConnectChecked":e[13]||(e[13]=t=>f(U)?U.value=t:null),"is-using-default-account":o(j),"onUpdate:isUsingDefaultAccount":e[14]||(e[14]=t=>f(j)?j.value=t:null),"stripe-connect-wallet":o(S),"should-disable-setting":o(z),"login-address":o(V),onSave:xe},null,8,["is-stripe-connect-checked","is-using-default-account","stripe-connect-wallet","should-disable-setting","login-address"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:""}}},{header:a(()=>[e[32]||(e[32]=r("h4",{class:"text-sm font-bold font-mono"}," Email to receive sales notifications / 欲收到銷售通知的電郵 ",-1)),r("div",yo,[l(u,{modelValue:o(p),"onUpdate:modelValue":e[15]||(e[15]=t=>f(p)?p.value=t:null),placeholder:"abc@example.com"},null,8,["modelValue"]),l(b,{label:"Add",variant:o(p)?"outline":"solid",color:o(p)?"primary":"gray",disabled:!o(p),onClick:we},null,8,["variant","color","disabled"])])]),default:a(()=>[l(W,{columns:[{key:"email",label:"Email",sortable:!0},{key:"action"}],rows:o(ve)},{"email-data":a(({row:t})=>[l(b,{label:t.email,to:`mailto:${t.email}`,variant:"link",padded:!1},null,8,["label","to"])]),"action-data":a(({row:t})=>[r("div",_o,[l(b,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(B).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["rows"])]),_:1}),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"12px"}}},{default:a(()=>[r("div",ho,[e[33]||(e[33]=r("h3",{class:"font-bold font-mono"}," Advanced Settings ",-1)),l(b,{color:"gray",variant:"ghost",icon:o(O)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:e[16]||(e[16]=()=>{O.value=!o(O)})},null,8,["icon"])]),o(O)?(_(),H("div",wo,[l(J,{"is-show-physical-goods-checkbox":!1,"shipping-info":o(C),"is-show-setting-modal-button":!0,onUpdateShippingRates:_e},{header:a(()=>e[34]||(e[34]=[r("span",{class:"text-[14px] text-gray-500"}," (Includes physical good that requires shipping) ",-1)])),_:1},8,["shipping-info"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"",base:"space-y-8"}}},{header:a(()=>[e[35]||(e[35]=r("h4",{class:"text-sm font-bold font-mono"}," Share sales data to wallets / 分享銷售數據給特定地址 ",-1)),r("div",xo,[l(u,{modelValue:o(c),"onUpdate:modelValue":e[17]||(e[17]=t=>f(c)?c.value=t:null),class:"font-mono",placeholder:"0x..."},null,8,["modelValue"]),l(b,{label:"Add",variant:o(c)?"outline":"solid",color:o(c)?"primary":"gray",disabled:!o(c),onClick:he},null,8,["variant","color","disabled"])])]),default:a(()=>[l(W,{columns:o(fe),rows:o(be)},{"wallet-data":a(({row:t})=>[l(b,{class:"font-mono",label:t.wallet,to:t.walletLink,variant:"link",padded:!1},null,8,["label","to"])]),"remove-data":a(({row:t})=>[r("div",ko,[l(b,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>o(N).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(y,{ui:{body:{base:"space-y-8"}}},{header:a(()=>e[36]||(e[36]=[r("h3",{class:"font-bold font-mono"}," DRM Options / 數位版權管理選項 ",-1)])),default:a(()=>[r("div",Co,[l(d,{label:"Force NFT claim before view",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(P,{modelValue:o(R),"onUpdate:modelValue":e[18]||(e[18]=t=>f(R)?R.value=t:null),name:"mustClaimToView",label:"Must claim NFT to view"},null,8,["modelValue"])]),_:1}),l(d,{label:"Disable File Download",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(P,{modelValue:o(F),"onUpdate:modelValue":e[19]||(e[19]=t=>f(F)?F.value=t:null),name:"hideDownload",label:"Disable Download"},null,8,["modelValue"])]),_:1})])]),_:1})])):T("",!0)]),_:1}),l(b,{label:o(pe),loading:o(v),size:"lg",disabled:o(v),onClick:Ue},null,8,["label","loading","disabled"])],64)):T("",!0)]),_:1})}}}),zo=Ze(Vo,[["__scopeId","data-v-4261cac5"]]);export{zo as default};
