import{a_ as A,b9 as _,b1 as j,bV as ne,b4 as a,bk as le,b0 as re,a$ as ce,bz as ie,b8 as de,bh as ue,ba as i,bb as N,b3 as v,aT as d,aX as r,bi as P,aW as u,bj as _e,bg as me,aY as pe,bd as S,bA as be,aS as V,aV as D,aU as T,bo as fe,bp as ge,bv as ye,b2 as F,bf as ve}from"./CdYtZq0D.js";import{_ as ke}from"./QMlNbNdW.js";import{a as z}from"./BAP3jfZe.js";import{_ as Ie}from"./Czmh6y2h.js";import{_ as we}from"./4hDiXjw5.js";import{_ as xe}from"./BoePP6o3.js";import"./hfcAh15g.js";import"./D413nbYB.js";(function(){try{var c=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},m=new c.Error().stack;m&&(c._sentryDebugIds=c._sentryDebugIds||{},c._sentryDebugIds[m]="4c07f59f-7d05-4bcb-a8ce-683cd5b7ab76",c._sentryDebugIdIdentifier="sentry-dbid-4c07f59f-7d05-4bcb-a8ce-683cd5b7ab76")}catch{}})();const he=A({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(c){const m=z(),f=c,s=_(!1);return j(async()=>{try{s.value=!0,await m.lazyFetchClassMetadataById(f.classId)}catch{}finally{s.value=!1}}),(k,U)=>ne(k.$slots,"default",{isLoading:a(s)})}}),Le=Object.assign(he,{__name:"NFTClassMetadataLoader"}),Ce={class:"flex justify-between items-center w-full"},Se={class:"flex gap-2 items-center"},Te={class:"text-sm leading-5"},Ue={class:"flex gap-1"},Ne={key:1,class:"max-w-xs truncate"},Ae=A({__name:"index",setup(c){const m=le(),f=re(),{t:s}=ce(),k=ie(),U=z(),{listingList:B,moderatedBookList:R,token:q}=de(k),{lazyFetchClassMetadataById:E}=U,{fetchBookListing:O,fetchModeratedBookList:W}=k,I=_(""),$=_(!1);ue({title:()=>s("seo_titles.book_listing_management"),ogTitle:()=>s("seo_titles.book_listing_management")});const w=i(()=>[{label:s("bookstore.current_listing"),key:"current"},{label:s("bookstore.viewable_listing"),key:"viewable"}]),g=i({get(){const e=w.value.findIndex(t=>t.key===m.query.tab);return e===-1?0:e},set(e){const t=w.value[e];t&&F(f({query:{tab:t.key}}),{replace:!0})}}),p=_(""),x=_({column:"pendingAction",direction:"desc"}),b=_(50),l=_(1),X=i(()=>(l.value-1)*b.value+1),Y=i(()=>Math.min(l.value*b.value,h.value.length)),h=i(()=>(w.value[g.value]?.key==="viewable"?R:B).value.map(e=>({classId:e.classId,className:U.getClassMetadataById(e.classId)?.name,priceInUSD:e.prices?.[0].price,prices:e.prices?.map(t=>t.price),pendingAction:e.pendingNFTCount,sold:e.sold})).filter(e=>{if(!p.value)return!0;const t=p.value.toLowerCase();return e.classId.toLowerCase().includes(t)||e.className.toLowerCase().includes(t)})),G=i(()=>{const{column:e,direction:t}=x.value;return h.value.sort((n,y)=>n[e]<y[e]?t==="asc"?-1:1:n[e]>y[e]?t==="asc"?1:-1:0)}),H=i(()=>G.value.slice((l.value-1)*b.value,l.value*b.value)),J=i(()=>[{key:"pendingAction",label:s("table.pending_action"),sortable:!0},{key:"className",label:s("table.class_name"),sortable:!0},{key:"priceInUSD",label:s("table.price_in_usd"),sortable:!0},{key:"sold",label:s("table.sold"),sortable:!0},{key:"classId",label:s("bookstore.class_id"),sortable:!0,class:"font-mono"}]);N($,e=>{e&&(I.value="")}),N(g,()=>{p.value="",l.value=1}),N(b,()=>{l.value=1}),j(async()=>{const e=[O()];q.value&&e.push(W()),await Promise.all(e),new Set(B.value.map(n=>n.classId).concat(R.value.map(n=>n.classId))).forEach(n=>E(n))});async function K(e){await F(f({name:"my-books-status-classId",params:{classId:e.classId}}))}return(e,t)=>{const n=_e,y=me,Q=ke,Z=ye,ee=ve,te=Le,ae=Ie,M=be,se=we,oe=xe;return d(),v(oe,{ui:{constrained:""}},{default:r(()=>[a(I)?(d(),v(n,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${a(I)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:t[0]||(t[0]=L=>I.value="")},null,8,["title"])):P("",!0),a($)?(d(),v(y,{key:1,animation:"carousel"},{indicator:r(()=>[...t[5]||(t[5]=[pe(" Loading... ",-1)])]),_:1})):P("",!0),u(M,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:r(()=>[u(se,{modelValue:a(g),"onUpdate:modelValue":t[4]||(t[4]=L=>S(g)?g.value=L:null),class:"w-full",items:a(w)},{item:r(({item:L})=>[(d(),v(M,{key:L.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:r(()=>[T("div",Ce,[T("div",Se,[u(Q,{modelValue:a(l),"onUpdate:modelValue":t[1]||(t[1]=o=>S(l)?l.value=o:null),"page-count":a(b),total:a(h).length},null,8,["modelValue","page-count","total"]),T("span",Te,D(a(s)("table.showing_rows",{from:a(X),to:a(Y),total:a(h).length})),1)]),u(Z,{modelValue:a(p),"onUpdate:modelValue":t[2]||(t[2]=o=>S(p)?p.value=o:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:a(s)("table.search_placeholder")},null,8,["modelValue","placeholder"])])]),default:r(()=>[u(ae,{sort:a(x),"onUpdate:sort":t[3]||(t[3]=o=>S(x)?x.value=o:null),columns:a(J),rows:a(H),onSelect:K},{"priceInUSD-data":r(({row:o})=>[T("ul",Ue,[(d(!0),V(ge,null,fe(o.prices,C=>(d(),V("li",{key:C},[u(ee,{label:`$${C}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":r(({row:o})=>[u(te,{"class-id":o.classId},{default:r(({isLoading:C})=>[C||!o.className?(d(),v(y,{key:0})):(d(),V("div",Ne,D(o.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:1}))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})}}});export{Ae as default};
