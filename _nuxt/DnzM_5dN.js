import{a_ as ge,a$ as ye,bx as he,bm as xe,b0 as ke,b7 as we,b8 as s,b9 as oe,ba as Ve,b1 as Ue,aS as le,aW as l,aX as a,bh as Ie,aT as D,bt as Pe,b3 as q,br as ae,b4 as o,bL as Se,aY as A,aV as G,aU as p,bf as u,bN as Te,bB as Ce,bq as Ee,bg as Ne,b2 as te}from"./QxK_I3gi.js";import{_ as De}from"./CAzzC2B-.js";import{_ as Ae}from"./BJ1ENjzX.js";import{_ as Re,a as Me}from"./Dk-qhQ1X.js";import{_ as Be}from"./5_6xi6V2.js";import{_ as ze}from"./DmbTrNkJ.js";import{c as $e,_ as Le,E as ne,p as Fe}from"./kdwN_P90.js";import{_ as Oe}from"./DpY-OMgW.js";import{_ as je,a as qe,b as Ge}from"./DQNBlNpQ.js";import{_ as He}from"./DImYB8ZL.js";import{M as H,U as Xe,b as Ye,D as Ze}from"./TgqKz_FJ.js";import{u as We}from"./Czjw8vXH.js";import"./B_6mHhFI.js";import"./CUiJuOdN.js";import"./DRLJ4vki.js";import"./66zSZ_H0.js";import"./UwgYfZC9.js";(function(){try{var h=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c=new h.Error().stack;c&&(h._sentryDebugIds=h._sentryDebugIds||{},h._sentryDebugIds[c]="7b825a63-3655-4c67-b6c0-af237f9bcb88",h._sentryDebugIdIdentifier="sentry-dbid-7b825a63-3655-4c67-b6c0-af237f9bcb88")}catch{}})();const Je={class:"font-bold font-mono"},Ke={class:"font-bold font-mono"},Qe=["src"],go=ge({__name:"edit",setup(h){const{t:c}=ye(),k=he(),se=We(),B=xe(),X=ke(),z=we(),f=s(Array.isArray(B.params.collectionId)?B.params.collectionId[0]:B.params.collectionId),b=s(!1),i=s({}),$=s([]),v=s(Ze),w=s(1),V=s("auto"),U=s("Thanks for purchasing this NFT ebook."),I=s("Standard Edition"),P=s("標準版"),S=s(""),T=s(""),_=s(""),C=s(!1),x=s(!0),E=s(!1),g=s(!1),L=s([]),F=s(!1),Y=s(0),O=s(!1),Z=s(["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"]),W=s({en:"Product description in English...",zh:"產品中文描述..."}),J=oe(()=>V.value==="auto"),ie=oe(()=>O.value?Y.value:0),{getClassMetadataById:ue}=se;$e({markdownItConfig(n){n.options.html=!1}}),Ve(v,(n,e)=>{Number(e)!==0&&Number(n)===0&&(x.value=!0)}),Ue(async()=>{var n,e,r,y;try{b.value=!0,i.value=await k.fetchCollectionById(f.value);const d=i.value.typePayload;d&&(i.value={...i.value,...d}),$.value=i.value.classIds||[],v.value=i.value.priceInDecimal/100||0,w.value=i.value.stock||0,I.value=((n=i.value.name)==null?void 0:n.en)||"",P.value=((e=i.value.name)==null?void 0:e.zh)||"",_.value=i.value.image||"",S.value=((r=i.value.description)==null?void 0:r.en)||" ",T.value=((y=i.value.description)==null?void 0:y.zh)||" ",C.value=i.value.hasShipping||!1,L.value=i.value.shippingRates||[],g.value=i.value.isPhysicalOnly||!1,x.value=i.value.isAllowCustomPrice||!1,E.value=i.value.isUnlisted||!1,V.value=i.value.isAutoDeliver?"auto":"manual",U.value=i.value.autoMemo||"",Y.value=i.value.stock,O.value=i.value.isAutoDeliver}catch(d){console.error(d),z.add({icon:"i-heroicons-exclamation-circle",title:d.toString(),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}finally{b.value=!1}});function K(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Q(n){return Fe.sanitize(n)}async function re(){await te(X({name:"nft-book-store-collection-status-collectionId",params:{collectionId:f.value}}))}async function de(n){var e;F.value=!0;try{await k.updateNFTBookCollectionById(f.value,{shippingRates:n});const r=await k.fetchCollectionById(f.value);L.value=(e=r==null?void 0:r.typePayload)==null?void 0:e.shippingRates}catch(r){const y=r.data||r;console.error(y),z.add({icon:"i-heroicons-exclamation-circle",title:y,timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}finally{F.value=!1}}async function ce(){try{const n={classIds:$.value,name:{en:I.value,zh:P.value},description:{en:K(S.value),zh:K(T.value)},image:_.value,priceInDecimal:Math.round(Number(v.value)*100),price:Number(v.value),stock:Number(w.value),isAutoDeliver:!g.value&&J.value,autoMemo:U.value||"",hasShipping:C.value||!1,isPhysicalOnly:g.value||!1,isAllowCustomPrice:x.value??!0,isUnlisted:E.value??!1};if(!n||n.price===void 0)throw new Error("Please input price of edition");if(n.price!==0&&n.price<H)throw new Error(`Price of each edition must be at least $${H} or $0 (free)`);if(!n.stock&&n.stock!==0)throw new Error("Please input stock of edition");if(n.stock<0)throw new Error("Stock cannot be negative");if(!n.name.en||!n.name.zh)throw new Error("Please input product name");b.value=!0,await k.updateNFTBookCollectionById(f.value,n),await te(X({name:"nft-book-store-collection-status-collectionId",params:{collectionId:f.value}}))}catch(n){const e=n.data||n;console.error(e),z.add({icon:"i-heroicons-exclamation-circle",title:e,timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}finally{b.value=!1}}return(n,e)=>{const r=Ne,y=Se,d=De,m=Ae,me=Re,N=Pe,pe=Be,fe=ze,R=Ce,M=Le,j=Me,be=Oe,ve=Ie;return D(),le("div",null,[l(ve,{"model-value":!0,ui:{width:"sm:max-w-7xl"}},{default:a(()=>[l(N,{ui:{header:{base:"flex justify-between items-center"},body:{base:"space-y-4"},footer:{base:"flex justify-end items-center"}}},{header:a(()=>[p("h2",Je,G(o(c)("pages.edit_collection_info")),1),l(r,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:re})]),footer:a(()=>[l(r,{label:o(c)("common.save"),loading:o(b),size:"lg",disabled:o(b),onClick:ce},null,8,["label","loading","disabled"])]),default:a(()=>[o(b)?(D(),q(y,{key:0,animation:"carousel"},{indicator:a(()=>[A(G(o(c)("loading.progress")),1)]),_:1})):ae("",!0),l(N,{ui:{body:{base:"space-y-4"}}},{header:a(()=>[p("h2",Ke,G(o(c)("pages.class_info")),1)]),default:a(()=>[l(m,{label:o(c)("form.nft_collection_id")},{default:a(()=>[l(d,{class:"font-mono","model-value":o(f),readonly:!0,disabled:!0},null,8,["model-value"])]),_:1},8,["label"]),l(m,{label:o(c)("form.books_in_collection")},{default:a(()=>[l(N,{ui:{body:{padding:""}}},{default:a(()=>[l(me,{columns:[{key:"classId",label:o(c)("table.class_id")},{key:"name",label:o(c)("table.book_name")}],rows:o($).map((t,_e)=>{var ee;return{index:_e,classId:t,name:(ee=o(ue)(t))==null?void 0:ee.name}})},null,8,["columns","rows"])]),_:1})]),_:1},8,["label"])]),_:1}),l(N,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[13]||(e[13]=[p("h3",{class:"font-bold font-mono"}," Pricing and Availability ",-1)])),default:a(()=>[l(m,{label:`Price(USD) of this collection (Minimal ${o(H)} or $0 (free)) / 版本定價（美金）`},{default:a(()=>[l(pe,{modelValue:o(v),"onUpdate:modelValue":e[0]||(e[0]=t=>u(v)?v.value=t:null),options:o(Xe),"value-attribute":"value"},null,8,["modelValue","options"])]),_:1},8,["label"]),l(m,{label:"Total number of NFT for sale of this collection / 此定價上架的數量"},{default:a(()=>[l(d,{modelValue:o(w),"onUpdate:modelValue":e[1]||(e[1]=t=>u(w)?w.value=t:null),type:"number",step:"1",min:o(ie),max:o(Ye)},null,8,["modelValue","min","max"])]),_:1}),l(fe,{modelValue:o(V),"onUpdate:modelValue":e[2]||(e[2]=t=>u(V)?V.value=t:null),disabled:o(O)||o(g),legend:"Delivery method of this collection / 自動或手動發書",options:o(Te)},null,8,["modelValue","disabled","options"]),o(J)?(D(),q(m,{key:0},{label:a(()=>[e[15]||(e[15]=A(" Memo of this collection / 自動發書留言 ")),l(M,null,{image:a(()=>e[14]||(e[14]=[p("img",{src:je,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(d,{modelValue:o(U),"onUpdate:modelValue":e[3]||(e[3]=t=>u(U)?U.value=t:null)},null,8,["modelValue"])]),_:1})):(D(),q(m,{key:1,label:"Is Physical only good / 只含實體書",ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(j,{modelValue:o(g),"onUpdate:modelValue":e[4]||(e[4]=t=>u(g)?g.value=t:null),name:"isPhysicalOnly",label:"This collection does not contain any digital file/NFT"},null,8,["modelValue"])]),_:1})),l(m,null,{label:a(()=>[e[17]||(e[17]=A(" Allow custom price / 開啟打賞功能 ")),l(M,{"image-style":{width:"300px"}},{image:a(()=>e[16]||(e[16]=[p("img",{src:qe,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(j,{modelValue:o(x),"onUpdate:modelValue":e[5]||(e[5]=t=>u(x)?x.value=t:null),name:"isAllowCustomPrice",label:"Allow user to pay more than defined price"},null,8,["modelValue"])]),_:1}),l(m,{label:"Unlist Edition / 暫時下架"},{default:a(()=>[l(j,{modelValue:o(E),"onUpdate:modelValue":e[6]||(e[6]=t=>u(E)?E.value=t:null),name:"isUnlisted",label:"Pause selling of this Edition"},null,8,["modelValue"])]),_:1})]),_:1}),l(N,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>e[18]||(e[18]=[p("h3",{class:"font-bold font-mono"}," Product Information ",-1)])),default:a(()=>[l(m,{label:"Product Name",ui:{container:"space-y-2"}},{label:a(()=>[e[20]||(e[20]=A(" Product Name / 產品名稱（英文） ")),l(M,{"image-style":{width:"250px"}},{image:a(()=>e[19]||(e[19]=[p("img",{src:He,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(d,{modelValue:o(I),"onUpdate:modelValue":e[7]||(e[7]=t=>u(I)?I.value=t:null),placeholder:"Product name in English"},null,8,["modelValue"]),e[21]||(e[21]=p("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"Description (Optional) / 描述（選填）",-1)),l(o(ne),{modelValue:o(S),"onUpdate:modelValue":e[8]||(e[8]=t=>u(S)?S.value=t:null),language:"en-US","editor-id":"en",placeholder:o(W).en,toolbars:o(Z),sanitize:Q,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder","toolbars"])]),_:1,__:[21]}),l(m,{ui:{container:"space-y-2 my-[20px]"}},{label:a(()=>[e[23]||(e[23]=A(" 產品名稱（中文） ")),l(M,{"image-style":{width:"250px"}},{image:a(()=>e[22]||(e[22]=[p("img",{src:Ge,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(R,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(d,{modelValue:o(P),"onUpdate:modelValue":e[9]||(e[9]=t=>u(P)?P.value=t:null),placeholder:"產品中文名字"},null,8,["modelValue"]),e[24]||(e[24]=p("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),l(o(ne),{modelValue:o(T),"onUpdate:modelValue":e[10]||(e[10]=t=>u(T)?T.value=t:null),language:"en-US","editor-id":"zh",placeholder:o(W).zh,toolbars:o(Z),sanitize:Q,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder","toolbars"])]),_:1,__:[24]}),l(m,{label:"Image of this book collection",ui:{container:"space-y-2"}},{default:a(()=>[l(d,{modelValue:o(_),"onUpdate:modelValue":e[11]||(e[11]=t=>u(_)?_.value=t:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),o(_)?(D(),le("img",{key:0,src:o(Ee)(o(_)),class:"w-1/3"},null,8,Qe)):ae("",!0)]),_:1})]),_:1}),l(be,{modelValue:o(C),"onUpdate:modelValue":e[12]||(e[12]=t=>u(C)?C.value=t:null),"is-show-physical-goods-checkbox":!0,"shipping-info":o(L),"is-loading":o(F),onUpdateShippingRates:de},null,8,["modelValue","shipping-info","is-loading"])]),_:1})]),_:1})])}}});export{go as default};
