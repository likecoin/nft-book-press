const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D38QZzjy.js","./C_iIk3B2.js","./entry.BY492grj.css","./DfuX-4sF.js","./rxTeog4L.js","./CDmhjFLy.js","./DoLT8sxl.js","./jkTzhJ-8.js","./DR6NZU1W.js","./Select.qOczc23w.css"])))=>i.map(i=>d[i]);
import{a_ as G,a$ as N,b6 as H,b7 as K,b8 as v,b9 as W,ba as B,bb as X,b1 as J,bc as Y,bd as Z,b3 as S,aX as h,aT as _,aU as p,aW as l,aV as q,b4 as t,be as ee,bf as R,bg as te,bh as oe,aS as y,bi as w,bj as $}from"./C_iIk3B2.js";import{_ as ne}from"./jkTzhJ-8.js";import{_ as ae}from"./DoLT8sxl.js";import{_ as le}from"./DN_YN0gu.js";import{g as re,a as se,_ as ce,d as ie,D as de,b as ue}from"./D38QZzjy.js";import{_ as _e}from"./D7FwGhZR.js";import{p as pe}from"./CUxdmJDi.js";import"./CDmhjFLy.js";import"./DfuX-4sF.js";import"./rxTeog4L.js";import"./DR6NZU1W.js";(function(){try{var f=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new f.Error().stack;n&&(f._sentryDebugIds=f._sentryDebugIds||{},f._sentryDebugIds[n]="cb85cb39-586e-46bf-9f8d-e89ad3d5eb5d",f._sentryDebugIdIdentifier="sentry-dbid-cb85cb39-586e-46bf-9f8d-e89ad3d5eb5d")}catch{}})();const fe={class:"text-lg font-bold font-mono print:hidden"},me={class:"print:hidden flex justify-center"},be={class:"font-bold font-mono"},ge={class:"flex justify-center items-center gap-2 print:hidden"},ve={class:"flex flex-col items-center gap-[2cm] print:gap-0"},he={class:"text-xs text-center font-mono"},I="key,url",V=12,Ue=G({__name:"batch-qrcode",setup(f){const{t:n}=N(),{BOOK3_URL:E}=H().public,T=K(),r=v(""),O=`${I}
example01,https://example01.com
example02,https://example02.com`,m=v(de),C=v(ue),b=v(!1),D=v(void 0),c=v([]),P=W(()=>{const o=[];for(let e=0;e<c.value.length;e+=V)o.push(c.value.slice(e,e+V));return o});B(r,()=>{c.value=[]}),B(m,()=>{c.value=[]}),X({title:"Batch Create Book QR Codes",ogTitle:"Batch Create Book QR Codes"}),J(()=>{try{const o=sessionStorage.getItem("nft_book_press_batch_qrcode");o&&(r.value=o,sessionStorage.removeItem("nft_book_press_batch_qrcode")),Y(()=>{r.value&&Q()})}catch(o){console.error(o)}});async function Q(){try{let e=r.value;e.includes(I)||(e=`${I}
${e}`),c.value=pe(e,{columns:!0,skip_empty_lines:!0})}catch(e){console.error(e),T.add({icon:"i-heroicons-exclamation-circle",title:n("batch_qrcode.parse_csv_error"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}const{default:o}=await Z(async()=>{const{default:e}=await import("./D38QZzjy.js").then(i=>i.q);return{default:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url);c.value.forEach((e,i)=>{var u,d,k;const g=new o(re({margin:0,data:e.url,image:m.value==="none"?void 0:se(m.value),fillColor:C.value})),s=(u=D.value)==null?void 0:u[i];s&&((d=s.querySelector("svg"))==null||d.remove(),g.append(s),(k=s.querySelector("svg"))==null||k.setAttribute("viewBox","0 0 300 300"))})}function A(o){if(!o)return;const[e]=o,i=new FileReader;i.onload=g=>{var u;const s=(u=g.target)==null?void 0:u.result;typeof s=="string"&&(r.value=s)},i.readAsText(e)}function F(){r.value&&window.print()}function L(){ie(c.value.map(o=>({filename:o.key,url:o.url})))}return(o,e)=>{const i=ne,g=ae,s=ee,u=le,d=te,k=ce,z=oe,M=_e;return _(),S(M,{class:"print:space-y-0 print:p-0"},{default:h(()=>{var U;return[p("h1",fe,q(t(n)("batch_qrcode.page_title")),1),l(g,{label:t(n)("batch_qrcode.upload_csv"),class:"print:hidden"},{default:h(()=>[l(i,{type:"file",accept:"csv",onChange:A})]),_:1},8,["label"]),l(s,{class:"print:hidden",label:t(n)("batch_qrcode.or_divider")},null,8,["label"]),l(g,{class:"print:hidden",label:t(n)("batch_qrcode.input_csv")},{default:h(()=>[l(u,{modelValue:t(r),"onUpdate:modelValue":e[0]||(e[0]=a=>R(r)?r.value=a:null),class:"font-mono",placeholder:O,resize:!0},null,8,["modelValue"])]),_:1},8,["label"]),p("div",me,[l(d,{label:t(n)("batch_qrcode.qr_appearance"),variant:"outline",onClick:e[1]||(e[1]=a=>b.value=!0)},null,8,["label"])]),l(z,{modelValue:t(b),"onUpdate:modelValue":e[6]||(e[6]=a=>R(b)?b.value=a:null)},{default:h(()=>[l(k,{icon:t(m),"onUpdate:icon":e[3]||(e[3]=a=>R(m)?m.value=a:null),color:t(C),"onUpdate:color":e[4]||(e[4]=a=>R(C)?C.value=a:null),data:`${t(E)}/store`,width:500,height:500,mode:"config",onSave:e[5]||(e[5]=a=>b.value=!1)},{header:h(()=>[p("h3",be,q(t(n)("batch_qrcode.qr_config")),1),l(d,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:e[2]||(e[2]=a=>b.value=!1)})]),_:1},8,["icon","color","data"])]),_:1},8,["modelValue"]),p("nav",ge,[(U=t(c))!=null&&U.length?(_(),y(w,{key:1},[l(d,{label:t(n)("batch_qrcode.print"),size:"lg",variant:"outline",onClick:F},null,8,["label"]),l(d,{label:t(n)("batch_qrcode.download"),size:"lg",variant:"outline",onClick:L},null,8,["label"])],64)):(_(),S(d,{key:0,label:t(n)("batch_qrcode.generate"),size:"lg",disabled:!t(r),onClick:Q},null,8,["label","disabled"]))]),p("div",ve,[(_(!0),y(w,null,$(t(P),(a,j)=>(_(),y("ul",{key:j,class:"w-[20cm] grid grid-cols-3 items-center gap-[0.25cm] py-[0.5cm] break-before-page"},[(_(!0),y(w,null,$(a,x=>(_(),y("li",{key:x.key||x.url},[p("figure",{ref_for:!0,ref_key:"qrCodeRef",ref:D,class:"qrcode"},[p("figcaption",he,q(x.key||x.url),1)],512)]))),128))]))),128))])]}),_:1})}}});export{Ue as default};
