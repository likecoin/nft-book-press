import{_ as P}from"./BGvLb1iv.js";import{a_ as D,b7 as L,a$ as V,bw as z,b8 as x,b9 as C,bb as j,b1 as G,ba as y,b3 as _,aX as f,aT as d,bi as p,b4 as t,bA as W,aU as k,aS as q,aW as v,aV as T,bq as K}from"./vhOorvi_.js";import{_ as M}from"./CkLKk2CA.js";import{_ as X}from"./D5lxkC6t.js";import{u as F}from"./CsfjDUEA.js";import"./DMsoXCe8.js";import"./CS-5r1o0.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new r.Error().stack;l&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[l]="057d580e-0c64-427d-94fd-75f8da331097",r._sentryDebugIdIdentifier="sentry-dbid-057d580e-0c64-427d-94fd-75f8da331097")}catch{}})();const H={class:"text-center font-bold font-mono"},J={class:"flex justify-center items-center gap-4"},Q=["textContent"],se=D({__name:"index",setup(r){const{LIKE_CO_API:l}=L().public,{t:s}=V(),g=z(),m=F(),{token:S,wallet:b}=x(g),{getStripeConnectStatusByWallet:A}=x(m),a=C(""),o=C(!1);j(o,e=>{e&&(a.value="")}),G(async()=>{await m.refreshStripeConnectStatus(b.value)});const i=y(()=>A.value(b.value)),c=y(()=>{var e;return(e=i.value)==null?void 0:e.isReady}),B=y(()=>{var e,n,u;if(!((e=i.value)!=null&&e.hasAccount)&&!c.value)return s("user_settings.setup_stripe_connect");if((n=i.value)!=null&&n.hasAccount&&!c.value)return s("user_settings.resume_stripe_connect_setup");if((u=i.value)!=null&&u.hasAccount&&c.value)return s("user_settings.login_to_stripe")});async function E(){try{o.value=!0,await m.refreshStripeConnectStatus(b.value)}catch(e){a.value=e.toString()}finally{o.value=!1}}async function N(){try{o.value=!0;const n=(await $fetch(`${l}/likernft/book/user/connect/login`,{method:"POST",headers:{authorization:`Bearer ${S.value}`}})).url;if(n)window.open(n);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString()}finally{o.value=!1}}async function $(){try{o.value=!0;const n=(await $fetch(`${l}/likernft/book/user/connect/new`,{method:"POST",headers:{authorization:`Bearer ${S.value}`}})).url;if(n)window.open(n);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString()}finally{o.value=!1}}async function I(){o.value=!0;try{c.value?await N():await $()}catch(e){console.error(e),a.value=e.toString()}finally{o.value=!1}}return(e,n)=>{const u=P,w=K,R=M,O=W,U=X;return d(),_(U,null,{default:f(()=>[t(a)?(d(),_(u,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${t(a)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:n[0]||(n[0]=h=>a.value="")},null,8,["title"])):p("",!0),t(c)?p("",!0):(d(),_(u,{key:1,icon:"i-heroicons-exclamation-circle",color:"orange",variant:"soft",title:t(s)("user_settings.stripe_express_notice"),description:t(s)("user_settings.stripe_express_description")},null,8,["title","description"])),t(g).isAuthenticated?(d(),_(O,{key:2,ui:{header:{base:"flex justify-between items-center"},body:{padding:""},footer:{base:"text-center"}}},{header:f(()=>[k("h1",H,T(t(s)("user_settings.stripe_payout_status")),1),v(R,{text:"Refresh Status",popper:{placement:"left"}},{default:f(()=>[v(w,{icon:"i-heroicons-arrow-path",variant:"outline",disabled:t(o),onClick:E},null,8,["disabled"])]),_:1})]),footer:f(()=>{var h;return[k("div",J,[(h=t(i))!=null&&h.hasAccount&&t(c)?(d(),q("span",{key:0,class:"text-sm text-gray-500",textContent:T(t(i).email)},null,8,Q)):p("",!0),v(w,{label:t(B),size:"md",loading:t(o),disabled:t(o),color:"black",onClick:I},null,8,["label","loading","disabled"])])]}),_:1})):p("",!0)]),_:1})}}});export{se as default};
