const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./nnICj_Ut.js","./DOA8qu7o.js","./entry.BY492grj.css","./BKZhm6cj.js","./5x3xSctR.js","./Select.qOczc23w.css"])))=>i.map(i=>d[i]);
import{a_ as H,a$ as K,b7 as W,bt as X,b9 as _,ba as Y,bb as T,bh as J,b1 as Z,bn as ee,bu as te,b3 as B,aX as h,aT as p,aU as f,aW as l,aV as w,b4 as t,bv as oe,bw as ne,bx as ae,bd as y,br as le,bg as se,aS as C,bo as D,bp as V}from"./DOA8qu7o.js";import{_ as re}from"./CVaQ780k.js";import{g as ce,a as ie,_ as de,d as ue,D as _e,b as pe,c as fe}from"./nnICj_Ut.js";import{_ as me}from"./BmpMWbs9.js";import{p as be}from"./CUxdmJDi.js";import"./BKZhm6cj.js";import"./5x3xSctR.js";(function(){try{var m=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new m.Error().stack;a&&(m._sentryDebugIds=m._sentryDebugIds||{},m._sentryDebugIds[a]="0e799ca1-6e93-4c53-a721-c1e4a4198951",m._sentryDebugIdIdentifier="sentry-dbid-0e799ca1-6e93-4c53-a721-c1e4a4198951")}catch{}})();const ge={class:"text-lg font-bold font-mono print:hidden"},ve={class:"print:hidden flex justify-center"},he={class:"font-bold font-mono"},ye={class:"flex justify-center items-center gap-2 print:hidden"},Ce={class:"flex flex-col items-center gap-[2cm] print:gap-0"},xe={class:"text-xs text-center font-mono"},E="key,url",$=12,Qe=H({__name:"batch-qrcode",setup(m){const{t:a}=K(),{BOOK3_URL:I}=W().public,A=X(),s=_(""),F=`${E}
example01,https://example01.com
example02,https://example02.com`,b=_(_e),x=_(pe),k=_(fe),g=_(!1),Q=_(void 0),c=_([]),L=Y(()=>{const o=[];for(let e=0;e<c.value.length;e+=$)o.push(c.value.slice(e,e+$));return o});T(s,()=>{c.value=[]}),T(b,()=>{c.value=[]}),J({title:"Batch Create Book QR Codes",ogTitle:"Batch Create Book QR Codes"}),Z(()=>{try{const o=sessionStorage.getItem("nft_book_press_batch_qrcode");o&&(s.value=o,sessionStorage.removeItem("nft_book_press_batch_qrcode")),ee(()=>{s.value&&U()})}catch(o){console.error(o)}});function S(){return{image:b.value==="none"?void 0:ie(b.value),fillColor:x.value,dotStyle:k.value}}async function U(){try{let e=s.value;e.includes(E)||(e=`${E}
${e}`),c.value=be(e,{columns:!0,skip_empty_lines:!0})}catch(e){console.error(e),A.add({icon:"i-heroicons-exclamation-circle",title:a("batch_qrcode.parse_csv_error"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}const{default:o}=await te(async()=>{const{default:e}=await import("./nnICj_Ut.js").then(i=>i.q);return{default:e}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);c.value.forEach((e,i)=>{var u,d,R;const v=new o(ce({margin:0,data:e.url,...S()})),r=(u=Q.value)==null?void 0:u[i];r&&((d=r.querySelector("svg"))==null||d.remove(),v.append(r),(R=r.querySelector("svg"))==null||R.setAttribute("viewBox","0 0 300 300"))})}function P(o){if(!o)return;const[e]=o,i=new FileReader;i.onload=v=>{var u;const r=(u=v.target)==null?void 0:u.result;typeof r=="string"&&(s.value=r)},i.readAsText(e)}function z(){s.value&&window.print()}function M(){ue(c.value.map(o=>({filename:o.key,url:o.url})),{qrCodeOptions:{...S(),margin:40,width:1024,height:1024}})}return(o,e)=>{const i=ne,v=oe,r=ae,u=re,d=le,R=de,G=se,N=me;return p(),B(N,{class:"print:space-y-0 print:p-0"},{default:h(()=>{var O;return[f("h1",ge,w(t(a)("batch_qrcode.page_title")),1),l(v,{label:t(a)("batch_qrcode.upload_csv"),class:"print:hidden"},{default:h(()=>[l(i,{type:"file",accept:"csv",onChange:P})]),_:1},8,["label"]),l(r,{class:"print:hidden",label:t(a)("batch_qrcode.or_divider")},null,8,["label"]),l(v,{class:"print:hidden",label:t(a)("batch_qrcode.input_csv")},{default:h(()=>[l(u,{modelValue:t(s),"onUpdate:modelValue":e[0]||(e[0]=n=>y(s)?s.value=n:null),class:"font-mono",placeholder:F,resize:!0},null,8,["modelValue"])]),_:1},8,["label"]),f("div",ve,[l(d,{label:t(a)("batch_qrcode.qr_appearance"),variant:"outline",onClick:e[1]||(e[1]=n=>g.value=!0)},null,8,["label"])]),l(G,{modelValue:t(g),"onUpdate:modelValue":e[7]||(e[7]=n=>y(g)?g.value=n:null)},{default:h(()=>[l(R,{icon:t(b),"onUpdate:icon":e[3]||(e[3]=n=>y(b)?b.value=n:null),color:t(x),"onUpdate:color":e[4]||(e[4]=n=>y(x)?x.value=n:null),"dot-style":t(k),"onUpdate:dotStyle":e[5]||(e[5]=n=>y(k)?k.value=n:null),data:`${t(I)}/store`,width:500,height:500,mode:"config",onSave:e[6]||(e[6]=n=>g.value=!1)},{header:h(()=>[f("h3",he,w(t(a)("batch_qrcode.qr_config")),1),l(d,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:e[2]||(e[2]=n=>g.value=!1)})]),_:1},8,["icon","color","dot-style","data"])]),_:1},8,["modelValue"]),f("nav",ye,[(O=t(c))!=null&&O.length?(p(),C(D,{key:1},[l(d,{label:t(a)("batch_qrcode.print"),size:"lg",variant:"outline",onClick:z},null,8,["label"]),l(d,{label:t(a)("batch_qrcode.download"),size:"lg",variant:"outline",onClick:M},null,8,["label"])],64)):(p(),B(d,{key:0,label:t(a)("batch_qrcode.generate"),size:"lg",disabled:!t(s),onClick:U},null,8,["label","disabled"]))]),f("div",Ce,[(p(!0),C(D,null,V(t(L),(n,j)=>(p(),C("ul",{key:j,class:"w-[20cm] grid grid-cols-3 items-center gap-[0.25cm] py-[0.5cm] break-before-page"},[(p(!0),C(D,null,V(n,q=>(p(),C("li",{key:q.key||q.url},[f("figure",{ref_for:!0,ref_key:"qrCodeRef",ref:Q,class:"qrcode"},[f("figcaption",xe,w(q.key||q.url),1)],512)]))),128))]))),128))])]}),_:1})}}});export{Qe as default};
