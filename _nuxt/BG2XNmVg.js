import{a_ as Ne,bl as Ae,bk as Be,bx as Re,bn as te,b0 as Oe,a$ as $e,b8 as r,b9 as j,b1 as We,ba as ae,bb as Le,b3 as D,aX as a,bN as ze,aT as h,br as T,aS as X,b4 as e,bs as je,bO as qe,aY as E,aV as x,bi as Fe,aW as l,bt as Ge,aU as u,bf as b,bg as He,c3 as Qe,bQ as Y,bR as Xe,bS as Ye,bD as Ze,bq as Ke,b2 as Je,c4 as eo,bM as oo,aQ as lo}from"./Az-85_4d.js";import{_ as to,a as ao}from"./9SneTykk.js";import{_ as no}from"./BdyFHrcF.js";import{_ as so}from"./BK9DMPHQ.js";import{_ as io}from"./B8lkmk5M.js";import{_ as ro}from"./CWwQtHoh.js";import{c as uo,_ as co,E as mo,p as po}from"./DFXZx7zr.js";import{_ as fo}from"./3OVU0YJE.js";import{_ as bo}from"./CHo4XX-Y.js";import{_ as _o}from"./CPUztzZB.js";import{_ as vo,a as go,b as yo}from"./ClqkwLj0.js";import{u as ho}from"./zHUb0hRl.js";import{u as wo}from"./DRDTTLpb.js";import"./hJWsrnRg.js";import"./BnruzS3p.js";import"./BxqrQ5Xx.js";import"./B7yR-udj.js";import"./sptdRtwV.js";import"./jtRTBT7R.js";(function(){try{var k=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},N=new k.Error().stack;N&&(k._sentryDebugIds=k._sentryDebugIds||{},k._sentryDebugIds[N]="b8a3aed9-14a3-4f0f-9378-d6c10248da77",k._sentryDebugIdIdentifier="sentry-dbid-b8a3aed9-14a3-4f0f-9378-d6c10248da77")}catch{}})();const xo={class:"font-bold font-mono"},ko={class:"flex items-start gap-[12px] w-full px-[12px] mb-[12px]"},Co={class:"font-bold font-mono"},Vo={class:"font-bold font-mono"},Uo=["src"],So={class:"text-sm font-bold font-mono"},Io={class:"flex gap-2"},Po={class:"flex justify-end items-center"},Mo={class:"flex justify-between items-center w-full"},Do={class:"font-bold font-mono"},To={key:0,class:"mt-[24px] flex flex-col gap-[12px]"},Eo={class:"flex gap-2"},No={class:"flex justify-end items-center"},Ao={class:"grid md:grid-cols-2 gap-4"},Bo=Ne({__name:"new",setup(k){const N=Ae(),Z=Be(),ne=Re(),se=ho(),K=wo(),{wallet:S}=te(N),{newNFTBookCollection:ie}=ne,{getClassMetadataById:re,lazyFetchClassMetadataById:J}=se,{fetchStripeConnectStatusByWallet:ue}=K,{getStripeConnectStatusByWallet:de}=te(K),ce=Oe(),{t:s}=$e(),w=r(""),v=r(!1),me=r({en:"Collection description in English...",zh:"套裝中文描述..."}),pe=r("New Book Collection Name"),A=r("新書集名稱"),fe=r(""),B=r(""),C=r(""),c=r(""),V=r([]),i=r({price:oo,stock:eo,hasShipping:!1,isPhysicalOnly:!1,isAllowCustomPrice:!0,isUnlisted:!1,deliveryMethod:"auto",autoMemo:"Thank you for your support. It means a lot to me."}),U=r([]),R=r([]),O=r([]),m=r(""),p=r(""),$=r(!0),W=r(!1),L=r(!1),I=r(!1),P=r(""),q=r(!1),F=r(!0),be=["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"],_e=j(()=>s("common.submit")),ve=j(()=>[{key:"wallet",label:s("common.wallet"),sortable:!0},{key:"remove",label:"",sortable:!1}]),ge=j(()=>R.value.map((n,o)=>({index:o,wallet:n,walletLink:ze(n)}))),ye=j(()=>O.value.map((n,o)=>({index:o,email:n})));uo({markdownItConfig(n){n.options.html=!1}}),We(async()=>{try{if(v.value=!0,S.value){try{await ue(S.value)}catch(n){console.error(n)}de.value(S.value).isReady&&(I.value=!0,P.value=S.value)}}catch(n){console.error(n)}finally{v.value=!1}}),ae(v,n=>{n&&(w.value="")}),Le({title:"New Book Collection",ogTitle:"New Book Collection"}),ae(()=>i.value.price,n=>{Number(n)===0&&(i.value.isAllowCustomPrice=!0)});function he(){if(c.value){if(V.value.includes(c.value)){w.value="Class ID already exists";return}if(!c.value.startsWith("0x")){w.value="Invalid Class ID";return}V.value.push(c.value),J(c.value),c.value=""}}function we(n){U.value=n}function xe(){m.value&&(R.value.push(m.value),m.value="")}function ke(){p.value&&(O.value.push(p.value),p.value="")}function Ce(n){P.value=n,q.value=!0}function Ve(n){return{priceInDecimal:Math.round(Number(n.price)*100),stock:Number(n.stock),hasShipping:!!(n.hasShipping||U.value.length),isPhysicalOnly:!!n.isPhysicalOnly,isAllowCustomPrice:!!(n.isAllowCustomPrice??!0),isUnlisted:!!(n.isUnlisted??!1),isAutoDeliver:!n.isPhysicalOnly&&n.deliveryMethod==="auto",autoMemo:n.autoMemo}}function ee(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ue(n){return po.sanitize(n)}async function Se(){try{if(c.value)throw new Error(s("errors.nft_class_id_required"));if(!V.value.length)throw new Error(s("errors.nft_class_id_required"));if(m.value)throw new Error(s("errors.add_moderator_wallet"));if(p.value)throw new Error(s("errors.add_notification_email"));if(v.value=!0,await Promise.all(V.value.map(async g=>{const f=(await J(g)).nft_meta_collection_id||"";if(!f.includes("nft_book")&&!f.includes("book_nft"))throw new Error(s("errors.not_nft_book_collection"))})),Number(i.value.price)!==0&&i.value.price<Y)throw new Error(s("errors.price_validation",{minPrice:`$${Y}`}));const n=I.value&&P.value?{[P.value]:100}:null,o=U.value.length?U.value.map(g=>({name:{en:g.name.en,zh:g.name.zh},priceInDecimal:Math.round(Number(g.price)*100),price:Number(g.price)})):void 0,G=Ve(i.value);await ie({classIds:V.value,defaultPaymentCurrency:"USD",connectedWallets:n,moderatorWallets:R.value,notificationEmails:O.value,shippingRates:o,name:{en:pe.value,zh:A.value},description:{en:ee(fe.value),zh:ee(B.value)},image:C.value,hideDownload:W.value,mustClaimToView:$.value,...G}),await Je(ce({name:"nft-book-store-collection"}))}catch(n){const o=n.data||n;console.error(o),w.value=o}finally{q.value=!1,v.value=!1}}function Ie(){return Se()}return(n,o)=>{const G=je,g=qe,z=to,f=no,_=He,y=Ge,d=so,Pe=io,Me=ro,H=Ze,Q=co,M=ao,oe=fo,De=bo,Te=_o;return h(),D(Te,null,{default:a(()=>[e(w)?(h(),D(G,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${e(w)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:o[0]||(o[0]=t=>w.value="")},null,8,["title"])):T("",!0),e(v)?(h(),D(g,{key:1,animation:"carousel"},{indicator:a(()=>[E(x(e(s)("common.loading")),1)]),_:1})):T("",!0),e(Z).isAuthenticated?(h(),X(Fe,{key:2},[l(y,{ui:{body:{base:"space-y-4"}}},{header:a(()=>[u("h2",xo,x(e(s)("collection.new_collection_info")),1)]),default:a(()=>[l(d,{label:e(s)("form.books_in_collection")},{default:a(()=>[l(y,{ui:{body:{padding:""}}},{default:a(()=>[l(z,{columns:[{key:"classId",label:"Class ID"},{key:"name",label:"Book Name"}],rows:e(V).map((t,Ee)=>{var le;return{index:Ee,classId:t,name:(le=e(re)(t))==null?void 0:le.name}})},null,8,["rows"]),u("div",ko,[l(f,{modelValue:e(c),"onUpdate:modelValue":o[1]||(o[1]=t=>b(c)?c.value=t:null),class:"font-mono w-full",placeholder:"0x...."},null,8,["modelValue"]),l(_,{onClick:he},{default:a(()=>[E(x(e(s)("common.add")),1)]),_:1})])]),_:1})]),_:1},8,["label"]),l(d,{label:"Total number of packages available for sale"},{default:a(()=>[l(f,{modelValue:e(i).stock,"onUpdate:modelValue":o[2]||(o[2]=t=>e(i).stock=t),type:"number",step:"1",min:0,max:e(Qe)},null,8,["modelValue","max"])]),_:1})]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>[u("h3",Co,x(e(s)("form.pricing_availability")),1)]),default:a(()=>[l(d,{label:`Price(USD) of this collection (Minimal ${e(Y)} or $0 (free)) / 版本定價（美金）`},{default:a(()=>[l(Pe,{modelValue:e(i).price,"onUpdate:modelValue":o[3]||(o[3]=t=>e(i).price=t),options:e(Xe),"value-attribute":"value"},null,8,["modelValue","options"])]),_:1},8,["label"]),l(Me,{modelValue:e(i).deliveryMethod,"onUpdate:modelValue":o[4]||(o[4]=t=>e(i).deliveryMethod=t),disabled:e(i).isPhysicalOnly,legend:"Delivery method of this collection / 自動或手動發書",options:e(Ye)},null,8,["modelValue","disabled","options"]),e(i).deliveryMethod==="auto"?(h(),D(d,{key:0},{label:a(()=>[o[21]||(o[21]=E(" Memo of this collection / 自動發書留言 ")),l(Q,null,{image:a(()=>o[20]||(o[20]=[u("img",{src:vo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(H,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(f,{modelValue:e(i).autoMemo,"onUpdate:modelValue":o[5]||(o[5]=t=>e(i).autoMemo=t)},null,8,["modelValue"])]),_:1})):(h(),D(d,{key:1,label:e(s)("collection.is_physical_only"),ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(M,{modelValue:e(i).isPhysicalOnly,"onUpdate:modelValue":o[6]||(o[6]=t=>e(i).isPhysicalOnly=t),name:"isPhysicalOnly",label:e(s)("collection.no_digital_files")},null,8,["modelValue","label"])]),_:1},8,["label"])),l(d,null,{label:a(()=>[o[23]||(o[23]=E(" Allow custom price / 開啟打賞功能 ")),l(Q,{"image-style":{width:"300px"}},{image:a(()=>o[22]||(o[22]=[u("img",{src:go,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(H,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(M,{modelValue:e(i).isAllowCustomPrice,"onUpdate:modelValue":o[7]||(o[7]=t=>e(i).isAllowCustomPrice=t),name:"isAllowCustomPrice",label:e(s)("form.allow_pay_more")},null,8,["modelValue","label"])]),_:1}),l(d,{label:e(s)("collection.unlist_edition")},{default:a(()=>[l(M,{modelValue:e(i).isUnlisted,"onUpdate:modelValue":o[8]||(o[8]=t=>e(i).isUnlisted=t),name:"isUnlisted",label:e(s)("form.pause_selling_edition")},null,8,["modelValue","label"])]),_:1},8,["label"])]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>[u("h3",Vo,x(e(s)("form.product_information")),1)]),default:a(()=>[l(d,{ui:{container:"space-y-2 my-[20px]"}},{label:a(()=>[o[25]||(o[25]=E(" 產品名稱（中文） ")),l(Q,{"image-style":{width:"250px"}},{image:a(()=>o[24]||(o[24]=[u("img",{src:yo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(H,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(f,{modelValue:e(A),"onUpdate:modelValue":o[9]||(o[9]=t=>b(A)?A.value=t:null),placeholder:"產品中文名字"},null,8,["modelValue"]),o[26]||(o[26]=u("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),l(e(mo),{modelValue:e(B),"onUpdate:modelValue":o[10]||(o[10]=t=>b(B)?B.value=t:null),language:"en-US","editor-id":"zh",placeholder:e(me).zh,toolbars:be,sanitize:Ue,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder"])]),_:1,__:[26]}),l(d,{label:e(s)("form.cover_image"),ui:{container:"space-y-2"}},{default:a(()=>[l(f,{modelValue:e(C),"onUpdate:modelValue":o[11]||(o[11]=t=>b(C)?C.value=t:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),e(C)?(h(),X("img",{key:0,src:e(Ke)(e(C)),class:"w-1/3"},null,8,Uo)):T("",!0)]),_:1},8,["label"]),l(oe,{modelValue:e(i).hasShipping,"onUpdate:modelValue":o[12]||(o[12]=t=>e(i).hasShipping=t),"is-show-physical-goods-checkbox":!0,"is-show-setting-modal-button":!0,"shipping-info":e(U)},null,8,["modelValue","shipping-info"])]),_:1}),l(De,{"is-stripe-connect-checked":e(I),"onUpdate:isStripeConnectChecked":o[13]||(o[13]=t=>b(I)?I.value=t:null),"is-using-default-account":e(F),"onUpdate:isUsingDefaultAccount":o[14]||(o[14]=t=>b(F)?F.value=t:null),"stripe-connect-wallet":e(P),"should-disable-setting":e(q),"login-address":e(S),onSave:Ce},null,8,["is-stripe-connect-checked","is-using-default-account","stripe-connect-wallet","should-disable-setting","login-address"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:""}}},{header:a(()=>[u("h4",So,x(e(s)("form.email_notifications"))+" / 欲收到銷售通知的電郵 ",1),u("div",Io,[l(f,{modelValue:e(p),"onUpdate:modelValue":o[15]||(o[15]=t=>b(p)?p.value=t:null),placeholder:"abc@example.com"},null,8,["modelValue"]),l(_,{label:e(s)("common.add"),variant:e(p)?"outline":"solid",color:e(p)?"primary":"gray",disabled:!e(p),onClick:ke},null,8,["label","variant","color","disabled"])])]),default:a(()=>[l(z,{columns:[{key:"email",label:e(s)("common.email"),sortable:!0},{key:"action"}],rows:e(ye)},{"email-data":a(({row:t})=>[l(_,{label:t.email,to:`mailto:${t.email}`,variant:"link",padded:!1},null,8,["label","to"])]),"action-data":a(({row:t})=>[u("div",Po,[l(_,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>e(O).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"12px"}}},{default:a(()=>[u("div",Mo,[u("h3",Do,x(e(s)("nft_book_form.advanced_settings")),1),l(_,{color:"gray",variant:"ghost",icon:e(L)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:o[16]||(o[16]=()=>{L.value=!e(L)})},null,8,["icon"])]),e(L)?(h(),X("div",To,[l(oe,{"is-show-physical-goods-checkbox":!1,"shipping-info":e(U),"is-show-setting-modal-button":!0,onUpdateShippingRates:we},{header:a(()=>o[27]||(o[27]=[u("span",{class:"text-[14px] text-gray-500"}," (Includes physical good that requires shipping) ",-1)])),_:1},8,["shipping-info"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"",base:"space-y-8"}}},{header:a(()=>[o[28]||(o[28]=u("h4",{class:"text-sm font-bold font-mono"}," Share sales data to wallets / 分享銷售數據給特定地址 ",-1)),u("div",Eo,[l(f,{modelValue:e(m),"onUpdate:modelValue":o[17]||(o[17]=t=>b(m)?m.value=t:null),class:"font-mono",placeholder:"0x..."},null,8,["modelValue"]),l(_,{label:e(s)("common.add"),variant:e(m)?"outline":"solid",color:e(m)?"primary":"gray",disabled:!e(m),onClick:xe},null,8,["label","variant","color","disabled"])])]),default:a(()=>[l(z,{columns:e(ve),rows:e(ge)},{"wallet-data":a(({row:t})=>[l(_,{class:"font-mono",label:t.wallet,to:t.walletLink,variant:"link",padded:!1},null,8,["label","to"])]),"remove-data":a(({row:t})=>[u("div",No,[l(_,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>e(R).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(y,{ui:{body:{base:"space-y-8"}}},{header:a(()=>o[29]||(o[29]=[u("h3",{class:"font-bold font-mono"}," DRM Options / 數位版權管理選項 ",-1)])),default:a(()=>[u("div",Ao,[l(d,{label:e(s)("form.force_nft_claim"),ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(M,{modelValue:e($),"onUpdate:modelValue":o[18]||(o[18]=t=>b($)?$.value=t:null),name:"mustClaimToView",label:e(s)("form.must_claim_to_view")},null,8,["modelValue","label"])]),_:1},8,["label"]),l(d,{label:e(s)("form.disable_file_download"),ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(M,{modelValue:e(W),"onUpdate:modelValue":o[19]||(o[19]=t=>b(W)?W.value=t:null),name:"hideDownload",label:e(s)("form.disable_download")},null,8,["modelValue","label"])]),_:1},8,["label"])])]),_:1})])):T("",!0)]),_:1}),l(_,{label:e(_e),loading:e(v),size:"lg",disabled:e(v),onClick:Ie},null,8,["label","loading","disabled"])],64)):T("",!0)]),_:1})}}}),ll=lo(Bo,[["__scopeId","data-v-a96a1d29"]]);export{ll as default};
