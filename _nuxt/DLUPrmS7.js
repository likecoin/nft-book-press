import{a_ as Ee,bl as Ae,bk as Be,bx as Ne,bn as te,b0 as Re,a$ as $e,b8 as i,b9 as j,b1 as We,ba as Le,bb as Oe,b3 as D,aX as a,bN as ze,aT as h,br as T,aS as Y,b4 as e,bs as je,bO as qe,aY as E,aV as x,bi as Fe,aW as l,bt as Qe,aU as u,bf as b,bg as Ge,cQ as He,bQ as q,bR as Xe,bD as Ye,bq as Ze,b2 as Ke,cR as Je,bM as eo,aQ as oo}from"./BXDK4RbP.js";import{_ as lo,a as to}from"./CF17O8i8.js";import{_ as ao}from"./BkeRDD7n.js";import{_ as no}from"./BJqIYAeC.js";import{_ as so}from"./gMUVMSEF.js";import{c as io,_ as ro,E as uo,p as co}from"./BM4CTzcJ.js";import{_ as mo}from"./BBmPVJsy.js";import{_ as po}from"./B0wQKgSe.js";import{_ as fo}from"./BePgjmyU.js";import{_ as bo,a as _o,b as vo}from"./scB716IZ.js";import{u as go}from"./BCCmrpBr.js";import{u as yo}from"./DSf69RRT.js";import"./BNK4rP4b.js";import"./BNKzJH8P.js";import"./D1kBxfn2.js";import"./C1BiHrWg.js";import"./BQgXZL-e.js";(function(){try{var k=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},A=new k.Error().stack;A&&(k._sentryDebugIds=k._sentryDebugIds||{},k._sentryDebugIds[A]="91222c3e-75cb-4381-8452-737ec6aaf0e8",k._sentryDebugIdIdentifier="sentry-dbid-91222c3e-75cb-4381-8452-737ec6aaf0e8")}catch{}})();const ho={class:"font-bold font-mono"},wo={class:"flex items-start gap-[12px] w-full px-[12px] mb-[12px]"},xo={class:"font-bold font-mono"},ko={class:"font-bold font-mono"},Co=["src"],Vo={class:"text-sm font-bold font-mono"},Uo={class:"flex gap-2"},So={class:"flex justify-end items-center"},Io={class:"flex justify-between items-center w-full"},Po={class:"font-bold font-mono"},Mo={key:0,class:"mt-[24px] flex flex-col gap-[12px]"},Do={class:"flex gap-2"},To={class:"flex justify-end items-center"},Eo={class:"grid md:grid-cols-2 gap-4"},Ao=Ee({__name:"new",setup(k){const A=Ae(),Z=Be(),ae=Ne(),ne=go(),K=yo(),{wallet:S}=te(A),{newNFTBookCollection:se}=ae,{getClassMetadataById:ie,lazyFetchClassMetadataById:J}=ne,{fetchStripeConnectStatusByWallet:re}=K,{getStripeConnectStatusByWallet:ue}=te(K),de=Re(),{t:s}=$e(),w=i(""),v=i(!1),ce=i({en:"Collection description in English...",zh:"套裝中文描述..."}),me=i("New Book Collection Name"),B=i("新書集名稱"),pe=i(""),N=i(""),C=i(""),m=i(""),V=i([]),r=i({price:eo,stock:Je,hasShipping:!1,isPhysicalOnly:!1,isAllowCustomPrice:!0,isUnlisted:!1,deliveryMethod:"auto",autoMemo:"Thank you for your support. It means a lot to me."}),U=i([]),R=i([]),$=i([]),p=i(""),f=i(""),W=i(!0),L=i(!1),O=i(!1),I=i(!1),P=i(""),F=i(!1),Q=i(!0),fe=["bold","italic","strikeThrough","title","-","unorderedList","orderedList","-","code","link","=","preview"],be=j(()=>s("common.submit")),_e=j(()=>[{key:"wallet",label:s("common.wallet"),sortable:!0},{key:"remove",label:"",sortable:!1}]),ve=j(()=>R.value.map((n,o)=>({index:o,wallet:n,walletLink:ze(n)}))),ge=j(()=>$.value.map((n,o)=>({index:o,email:n})));io({markdownItConfig(n){n.options.html=!1}}),We(async()=>{try{if(v.value=!0,S.value){try{await re(S.value)}catch(n){console.error(n)}ue.value(S.value).isReady&&(I.value=!0,P.value=S.value)}}catch(n){console.error(n)}finally{v.value=!1}}),Le(v,n=>{n&&(w.value="")}),Oe({title:"New Book Collection",ogTitle:"New Book Collection"});function ye(n){Number(n.data)===0&&(r.value.isAllowCustomPrice=!0)}function he(){if(m.value){if(V.value.includes(m.value)){w.value="Class ID already exists";return}if(!m.value.startsWith("0x")){w.value="Invalid Class ID";return}V.value.push(m.value),J(m.value),m.value=""}}function we(n){U.value=n}function xe(){p.value&&(R.value.push(p.value),p.value="")}function ke(){f.value&&($.value.push(f.value),f.value="")}function Ce(n){P.value=n,F.value=!0}function Ve(n){return{priceInDecimal:Math.round(Number(n.price)*100),stock:Number(n.stock),hasShipping:!!(n.hasShipping||U.value.length),isPhysicalOnly:!!n.isPhysicalOnly,isAllowCustomPrice:!!(n.isAllowCustomPrice??!0),isUnlisted:!!(n.isUnlisted??!1),isAutoDeliver:!n.isPhysicalOnly&&n.deliveryMethod==="auto",autoMemo:n.autoMemo}}function ee(n=""){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function Ue(n){return co.sanitize(n)}async function Se(){try{if(m.value)throw new Error(s("errors.nft_class_id_required"));if(!V.value.length)throw new Error(s("errors.nft_class_id_required"));if(p.value)throw new Error(s("errors.add_moderator_wallet"));if(f.value)throw new Error(s("errors.add_notification_email"));if(v.value=!0,await Promise.all(V.value.map(async g=>{const d=(await J(g)).nft_meta_collection_id||"";if(!d.includes("nft_book")&&!d.includes("book_nft"))throw new Error(s("errors.not_nft_book_collection"))})),Number(r.value.price)!==0&&r.value.price<q)throw new Error(s("errors.price_validation",{minPrice:`$${q}`}));const n=I.value&&P.value?{[P.value]:100}:null,o=U.value.length?U.value.map(g=>({name:{en:g.name.en,zh:g.name.zh},priceInDecimal:Math.round(Number(g.price)*100),price:Number(g.price)})):void 0,G=Ve(r.value);await se({classIds:V.value,defaultPaymentCurrency:"USD",connectedWallets:n,moderatorWallets:R.value,notificationEmails:$.value,shippingRates:o,name:{en:me.value,zh:B.value},description:{en:ee(pe.value),zh:ee(N.value)},image:C.value,hideDownload:L.value,mustClaimToView:W.value,...G}),await Ke(de({name:"nft-book-store-collection"}))}catch(n){const o=n.data||n;console.error(o),w.value=o}finally{F.value=!1,v.value=!1}}function Ie(){return Se()}return(n,o)=>{const G=je,g=qe,z=lo,d=ao,_=Ge,y=Qe,c=no,Pe=so,H=Ye,X=ro,M=to,oe=mo,Me=po,De=fo;return h(),D(De,null,{default:a(()=>[e(w)?(h(),D(G,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${e(w)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:o[0]||(o[0]=t=>w.value="")},null,8,["title"])):T("",!0),e(v)?(h(),D(g,{key:1,animation:"carousel"},{indicator:a(()=>[E(x(e(s)("common.loading")),1)]),_:1})):T("",!0),e(Z).isAuthenticated?(h(),Y(Fe,{key:2},[l(y,{ui:{body:{base:"space-y-4"}}},{header:a(()=>[u("h2",ho,x(e(s)("collection.new_collection_info")),1)]),default:a(()=>[l(c,{label:e(s)("form.books_in_collection")},{default:a(()=>[l(y,{ui:{body:{padding:""}}},{default:a(()=>[l(z,{columns:[{key:"classId",label:"Class ID"},{key:"name",label:"Book Name"}],rows:e(V).map((t,Te)=>{var le;return{index:Te,classId:t,name:(le=e(ie)(t))==null?void 0:le.name}})},null,8,["rows"]),u("div",wo,[l(d,{modelValue:e(m),"onUpdate:modelValue":o[1]||(o[1]=t=>b(m)?m.value=t:null),class:"font-mono w-full",placeholder:"0x...."},null,8,["modelValue"]),l(_,{onClick:he},{default:a(()=>[E(x(e(s)("common.add")),1)]),_:1})])]),_:1})]),_:1},8,["label"]),l(c,{label:"Total number of packages available for sale"},{default:a(()=>[l(d,{modelValue:e(r).stock,"onUpdate:modelValue":o[2]||(o[2]=t=>e(r).stock=t),type:"number",step:"1",min:0,max:e(He)},null,8,["modelValue","max"])]),_:1})]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>[u("h3",xo,x(e(s)("form.pricing_availability")),1)]),default:a(()=>[l(c,{label:`Price(USD) of this collection (Minimal ${e(q)} or $0 (free)) / 版本定價（美金）`},{default:a(()=>[l(d,{modelValue:e(r).price,"onUpdate:modelValue":o[3]||(o[3]=t=>e(r).price=t),type:"number",step:"0.01",min:e(q),onInput:ye},null,8,["modelValue","min"])]),_:1},8,["label"]),l(Pe,{modelValue:e(r).deliveryMethod,"onUpdate:modelValue":o[4]||(o[4]=t=>e(r).deliveryMethod=t),disabled:e(r).isPhysicalOnly,legend:"Delivery method of this collection / 自動或手動發書",options:e(Xe)},null,8,["modelValue","disabled","options"]),e(r).deliveryMethod==="auto"?(h(),D(c,{key:0},{label:a(()=>[o[21]||(o[21]=E(" Memo of this collection / 自動發書留言 ")),l(X,null,{image:a(()=>o[20]||(o[20]=[u("img",{src:bo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(H,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(d,{modelValue:e(r).autoMemo,"onUpdate:modelValue":o[5]||(o[5]=t=>e(r).autoMemo=t)},null,8,["modelValue"])]),_:1})):(h(),D(c,{key:1,label:e(s)("collection.is_physical_only"),ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(M,{modelValue:e(r).isPhysicalOnly,"onUpdate:modelValue":o[6]||(o[6]=t=>e(r).isPhysicalOnly=t),name:"isPhysicalOnly",label:e(s)("collection.no_digital_files")},null,8,["modelValue","label"])]),_:1},8,["label"])),l(c,null,{label:a(()=>[o[23]||(o[23]=E(" Allow custom price / 開啟打賞功能 ")),l(X,{"image-style":{width:"300px"}},{image:a(()=>o[22]||(o[22]=[u("img",{src:_o,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(H,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(M,{modelValue:e(r).isAllowCustomPrice,"onUpdate:modelValue":o[7]||(o[7]=t=>e(r).isAllowCustomPrice=t),name:"isAllowCustomPrice",label:e(s)("form.allow_pay_more")},null,8,["modelValue","label"])]),_:1}),l(c,{label:e(s)("collection.unlist_edition")},{default:a(()=>[l(M,{modelValue:e(r).isUnlisted,"onUpdate:modelValue":o[8]||(o[8]=t=>e(r).isUnlisted=t),name:"isUnlisted",label:e(s)("form.pause_selling_edition")},null,8,["modelValue","label"])]),_:1},8,["label"])]),_:1}),l(y,{ui:{body:{base:"flex flex-col gap-[20px]"},base:"overflow-visible"}},{header:a(()=>[u("h3",ko,x(e(s)("form.product_information")),1)]),default:a(()=>[l(c,{ui:{container:"space-y-2 my-[20px]"}},{label:a(()=>[o[25]||(o[25]=E(" 產品名稱（中文） ")),l(X,{"image-style":{width:"250px"}},{image:a(()=>o[24]||(o[24]=[u("img",{src:vo,class:"object-cover",alt:""},null,-1)])),default:a(()=>[l(H,{name:"i-heroicons-question-mark-circle"})]),_:1})]),default:a(()=>[l(d,{modelValue:e(B),"onUpdate:modelValue":o[9]||(o[9]=t=>b(B)?B.value=t:null),placeholder:"產品中文名字"},null,8,["modelValue"]),o[26]||(o[26]=u("span",{class:"block text-[14px] text-[#374151] mt-[8px]"},"描述 (選填)",-1)),l(e(uo),{modelValue:e(N),"onUpdate:modelValue":o[10]||(o[10]=t=>b(N)?N.value=t:null),language:"en-US","editor-id":"zh",placeholder:e(ce).zh,toolbars:fe,sanitize:Ue,style:{height:"200px",width:"100%",marginTop:"0px"}},null,8,["modelValue","placeholder"])]),_:1,__:[26]}),l(c,{label:e(s)("form.cover_image"),ui:{container:"space-y-2"}},{default:a(()=>[l(d,{modelValue:e(C),"onUpdate:modelValue":o[11]||(o[11]=t=>b(C)?C.value=t:null),class:"font-mono",placeholder:"https://, ar://, ipfs://...."},null,8,["modelValue"]),e(C)?(h(),Y("img",{key:0,src:e(Ze)(e(C)),class:"w-1/3"},null,8,Co)):T("",!0)]),_:1},8,["label"]),l(oe,{modelValue:e(r).hasShipping,"onUpdate:modelValue":o[12]||(o[12]=t=>e(r).hasShipping=t),"is-show-physical-goods-checkbox":!0,"is-show-setting-modal-button":!0,"shipping-info":e(U)},null,8,["modelValue","shipping-info"])]),_:1}),l(Me,{"is-stripe-connect-checked":e(I),"onUpdate:isStripeConnectChecked":o[13]||(o[13]=t=>b(I)?I.value=t:null),"is-using-default-account":e(Q),"onUpdate:isUsingDefaultAccount":o[14]||(o[14]=t=>b(Q)?Q.value=t:null),"stripe-connect-wallet":e(P),"should-disable-setting":e(F),"login-address":e(S),onSave:Ce},null,8,["is-stripe-connect-checked","is-using-default-account","stripe-connect-wallet","should-disable-setting","login-address"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:""}}},{header:a(()=>[u("h4",Vo,x(e(s)("form.email_notifications"))+" / 欲收到銷售通知的電郵 ",1),u("div",Uo,[l(d,{modelValue:e(f),"onUpdate:modelValue":o[15]||(o[15]=t=>b(f)?f.value=t:null),placeholder:"abc@example.com"},null,8,["modelValue"]),l(_,{label:e(s)("common.add"),variant:e(f)?"outline":"solid",color:e(f)?"primary":"gray",disabled:!e(f),onClick:ke},null,8,["label","variant","color","disabled"])])]),default:a(()=>[l(z,{columns:[{key:"email",label:e(s)("common.email"),sortable:!0},{key:"action"}],rows:e(ge)},{"email-data":a(({row:t})=>[l(_,{label:t.email,to:`mailto:${t.email}`,variant:"link",padded:!1},null,8,["label","to"])]),"action-data":a(({row:t})=>[u("div",So,[l(_,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>e($).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"12px"}}},{default:a(()=>[u("div",Io,[u("h3",Po,x(e(s)("nft_book_form.advanced_settings")),1),l(_,{color:"gray",variant:"ghost",icon:e(O)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:o[16]||(o[16]=()=>{O.value=!e(O)})},null,8,["icon"])]),e(O)?(h(),Y("div",Mo,[l(oe,{"is-show-physical-goods-checkbox":!1,"shipping-info":e(U),"is-show-setting-modal-button":!0,onUpdateShippingRates:we},{header:a(()=>o[27]||(o[27]=[u("span",{class:"text-[14px] text-gray-500"}," (Includes physical good that requires shipping) ",-1)])),_:1},8,["shipping-info"]),l(y,{ui:{header:{base:"flex justify-between items-center"},body:{padding:"",base:"space-y-8"}}},{header:a(()=>[o[28]||(o[28]=u("h4",{class:"text-sm font-bold font-mono"}," Share sales data to wallets / 分享銷售數據給特定地址 ",-1)),u("div",Do,[l(d,{modelValue:e(p),"onUpdate:modelValue":o[17]||(o[17]=t=>b(p)?p.value=t:null),class:"font-mono",placeholder:"0x..."},null,8,["modelValue"]),l(_,{label:e(s)("common.add"),variant:e(p)?"outline":"solid",color:e(p)?"primary":"gray",disabled:!e(p),onClick:xe},null,8,["label","variant","color","disabled"])])]),default:a(()=>[l(z,{columns:e(_e),rows:e(ve)},{"wallet-data":a(({row:t})=>[l(_,{class:"font-mono",label:t.wallet,to:t.walletLink,variant:"link",padded:!1},null,8,["label","to"])]),"remove-data":a(({row:t})=>[u("div",To,[l(_,{icon:"i-heroicons-x-mark",variant:"soft",color:"red",onClick:()=>e(R).splice(t.index,1)},null,8,["onClick"])])]),_:1},8,["columns","rows"])]),_:1}),l(y,{ui:{body:{base:"space-y-8"}}},{header:a(()=>o[29]||(o[29]=[u("h3",{class:"font-bold font-mono"}," DRM Options / 數位版權管理選項 ",-1)])),default:a(()=>[u("div",Eo,[l(c,{label:e(s)("form.force_nft_claim"),ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(M,{modelValue:e(W),"onUpdate:modelValue":o[18]||(o[18]=t=>b(W)?W.value=t:null),name:"mustClaimToView",label:e(s)("form.must_claim_to_view")},null,8,["modelValue","label"])]),_:1},8,["label"]),l(c,{label:e(s)("form.disable_file_download"),ui:{label:{base:"font-mono font-bold"}}},{default:a(()=>[l(M,{modelValue:e(L),"onUpdate:modelValue":o[19]||(o[19]=t=>b(L)?L.value=t:null),name:"hideDownload",label:e(s)("form.disable_download")},null,8,["modelValue","label"])]),_:1},8,["label"])])]),_:1})])):T("",!0)]),_:1}),l(_,{label:e(be),loading:e(v),size:"lg",disabled:e(v),onClick:Ie},null,8,["label","loading","disabled"])],64)):T("",!0)]),_:1})}}}),Ko=oo(Ao,[["__scopeId","data-v-fa3e38ee"]]);export{Ko as default};
