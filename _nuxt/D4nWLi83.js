import{_ as me}from"./BGvLb1iv.js";import{bQ as ee,bR as q,bS as be,aQ as ve,a_ as H,aS as O,aT as u,bV as M,b3 as y,bi as F,bW as V,bn as te,bo as ae,bq as oe,c0 as ge,c1 as K,ba as b,b9 as $,b1 as se,b4 as l,bj as ye,b0 as he,a$ as ke,bw as Be,b8 as Ce,bh as we,bb as X,aX as I,b2 as Z,aW as z,bf as Ie,aY as Pe,bA as Le,bd as D,aV as x,aU as Y,be as Ne}from"./vhOorvi_.js";import{_ as _e}from"./C6p4kEcx.js";import{a as ne}from"./CRWWi9QV.js";import{_ as ze}from"./BsIYLJus.js";import{_ as $e}from"./jY7Aft3-.js";import{_ as Fe}from"./D5lxkC6t.js";import"./DOi_XibQ.js";import"./BC62ot0p.js";import"./CjATGvnq.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},h=new e.Error().stack;h&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[h]="cca091f5-59bc-4bc4-8ea9-07123e13e606",e._sentryDebugIdIdentifier="sentry-dbid-cca091f5-59bc-4bc4-8ea9-07123e13e606")}catch{}})();const Se={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},N=ee(q.ui.strategy,q.ui.pagination,Se),Ue=ee(q.ui.strategy,q.ui.button,be),Ve=H({components:{UButton:oe},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>N.default.size,validator(e){return Object.keys(Ue.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>N.default.activeButton},inactiveButton:{type:Object,default:()=>N.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>N.default.firstButton},lastButton:{type:Object,default:()=>N.default.lastButton},prevButton:{type:Object,default:()=>N.default.prevButton},nextButton:{type:Object,default:()=>N.default.nextButton},divider:{type:String,default:"â€¦"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:h}){const{ui:P,attrs:i}=ge("pagination",K(e,"ui"),N,K(e,"class")),d=b({get(){return e.modelValue},set(n){h("update:modelValue",n)}}),k=b(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(n,r)=>r+1)),g=b(()=>{const n=k.value.length,r=d.value,B=Math.max(e.max,5),c=Math.floor((Math.min(B,n)-5)/2),C=r-c,f=r+c,G=C-1>1,R=f+1<n,t=[];if(n<=B){for(let p=1;p<=n;p++)t.push(p);return t}if(t.push(1),G&&t.push(e.divider),!R){const p=r+c+2-n;for(let w=r-c-p;w<=r-c-1;w++)t.push(w)}for(let p=Math.max(2,C);p<=Math.min(n,f);p++)t.push(p);if(!G){const p=1-(r-c-2);for(let w=r+c+1;w<=r+c+p;w++)t.push(w)}return R&&t.push(e.divider),f<n&&t.push(n),t.length>=3&&t[1]===e.divider&&t[2]===3&&(t[1]=2),t.length>=3&&t[t.length-2]===e.divider&&t[t.length-1]===t.length&&(t[t.length-2]=t.length-1),t}),a=b(()=>d.value>1),_=b(()=>d.value<k.value.length);function S(){a.value&&(d.value=1)}function E(){_.value&&(d.value=k.value.length)}function W(n){typeof n!="string"&&(d.value=n)}function U(){a.value&&d.value--}function T(){_.value&&d.value++}return{ui:P,attrs:i,currentPage:d,pages:k,displayedPages:g,canGoLastOrNext:_,canGoFirstOrPrev:a,onClickPrev:U,onClickNext:T,onClickPage:W,onClickFirst:S,onClickLast:E}}});function Oe(e,h,P,i,d,k){const g=oe;return u(),O("div",V({class:e.ui.wrapper},e.attrs),[M(e.$slots,"first",{onClick:e.onClickFirst,canGoFirst:e.canGoFirstOrPrev},()=>{var a;return[e.firstButton&&e.showFirst?(u(),y(g,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),M(e.$slots,"prev",{onClick:e.onClickPrev,canGoPrev:e.canGoFirstOrPrev},()=>{var a;return[e.prevButton?(u(),y(g,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage-1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),(u(!0),O(te,null,ae(e.displayedPages,(a,_)=>{var S;return u(),y(g,V({key:`${a}-${_}`,to:typeof a=="number"?(S=e.to)==null?void 0:S.call(e,a):null,size:e.size,disabled:e.disabled,label:`${a}`},{ref_for:!0},a===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof a=="string","z-[1]":a===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(a)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),M(e.$slots,"next",{onClick:e.onClickNext,canGoNext:e.canGoLastOrNext},()=>{var a;return[e.nextButton?(u(),y(g,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage+1),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),M(e.$slots,"last",{onClick:e.onClickLast,canGoLast:e.canGoLastOrNext},()=>{var a;return[e.lastButton&&e.showLast?(u(),y(g,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.pages.length),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]})],16)}const Me=ve(Ve,[["render",Oe]]),Te=H({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(e){const h=ne(),P=e,i=$(!1);return se(async()=>{try{i.value=!0,await h.lazyFetchClassMetadataById(P.classId)}catch{}finally{i.value=!1}}),(d,k)=>M(d.$slots,"default",{isLoading:l(i)})}}),Ge={key:0,class:"flex justify-between items-center w-full"},Re={class:"flex gap-2 items-center"},je={class:"text-sm leading-5"},Ae={class:"flex gap-1"},De={key:1,class:"max-w-xs truncate"},xe=H({__name:"index",setup(e){const h=ye(),P=he(),{t:i}=ke(),d=Be(),k=ne(),{listingList:g,moderatedBookList:a,token:_}=Ce(d),{lazyFetchClassMetadataById:S}=k,{fetchBookListing:E,fetchModeratedBookList:W}=d,U=$(""),T=$(!1);we({title:()=>i("seo_titles.book_listing_management"),ogTitle:()=>i("seo_titles.book_listing_management")});const n=b(()=>[{label:i("bookstore.current_listing"),key:"current"},{label:i("bookstore.viewable_listing"),key:"viewable"}]),r=b({get(){const o=n.value.findIndex(s=>s.key===h.query.tab);return o===-1?0:o},set(o){Z(P({query:{tab:n.value[o].key}}),{replace:!0})}}),B=$(""),c=$({column:"pendingAction",direction:"desc"}),C=$(50),f=$(1),G=b(()=>(f.value-1)*C.value+1),R=b(()=>Math.min(f.value*C.value,t.value.length)),t=b(()=>(n.value[r.value].key==="viewable"?a:g).value.map(o=>{var s,m,L;return{classId:o.classId,className:(s=k.getClassMetadataById(o.classId))==null?void 0:s.name,priceInUSD:(m=o.prices)==null?void 0:m[0].price,prices:(L=o.prices)==null?void 0:L.map(Q=>Q.price),pendingAction:o.pendingNFTCount,sold:o.sold}}).filter(o=>{if(!B.value)return!0;const s=B.value.toLowerCase();return o.classId.toLowerCase().includes(s)||o.className.toLowerCase().includes(s)})),p=b(()=>{const{column:o,direction:s}=c.value;return t.value.sort((m,L)=>m[o]<L[o]?s==="asc"?-1:1:m[o]>L[o]?s==="asc"?1:-1:0)}),w=b(()=>p.value.slice((f.value-1)*C.value,f.value*C.value)),le=b(()=>[{key:"pendingAction",label:i("table.pending_action"),sortable:!0},{key:"className",label:i("table.class_name"),sortable:!0},{key:"priceInUSD",label:i("table.price_in_usd"),sortable:!0},{key:"sold",label:i("table.sold"),sortable:!0},{key:"classId",label:i("bookstore.class_id"),sortable:!0,class:"font-mono"}]);X(T,o=>{o&&(U.value="")}),X(r,()=>{B.value="",f.value=1}),X(C,()=>{f.value=1}),se(async()=>{const o=[E()];_.value&&o.push(W()),await Promise.all(o),new Set(g.value.map(m=>m.classId).concat(a.value.map(m=>m.classId))).forEach(m=>S(m))});async function ie(o){await Z(P({name:"my-books-status-classId",params:{classId:o.classId}}))}return(o,s)=>{const m=me,L=Ie,Q=Me,re=_e,ue=Ne,de=Te,ce=ze,J=Le,fe=$e,pe=Fe;return u(),y(pe,{ui:{constrained:""}},{default:I(()=>[l(U)?(u(),y(m,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${l(U)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:s[0]||(s[0]=j=>U.value="")},null,8,["title"])):F("",!0),l(T)?(u(),y(L,{key:1,animation:"carousel"},{indicator:I(()=>s[5]||(s[5]=[Pe(" Loading... ")])),_:1})):F("",!0),z(J,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:I(()=>[z(fe,{modelValue:l(r),"onUpdate:modelValue":s[4]||(s[4]=j=>D(r)?r.value=j:null),class:"w-full",items:l(n)},{item:I(({item:j})=>[(u(),y(J,{key:j.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:I(()=>[l(t).length>0?(u(),O("div",Ge,[Y("div",Re,[z(Q,{modelValue:l(f),"onUpdate:modelValue":s[1]||(s[1]=v=>D(f)?f.value=v:null),"page-count":l(C),total:l(t).length},null,8,["modelValue","page-count","total"]),Y("span",je,x(l(i)("table.showing_rows",{from:l(G),to:l(R),total:l(t).length})),1)]),z(re,{modelValue:l(B),"onUpdate:modelValue":s[2]||(s[2]=v=>D(B)?B.value=v:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:l(i)("table.search_placeholder")},null,8,["modelValue","placeholder"])])):F("",!0)]),default:I(()=>[z(ce,{sort:l(c),"onUpdate:sort":s[3]||(s[3]=v=>D(c)?c.value=v:null),columns:l(le),rows:l(w),onSelect:ie},{"priceInUSD-data":I(({row:v})=>[Y("ul",Ae,[(u(!0),O(te,null,ae(v.prices,A=>(u(),O("li",{key:A},[z(ue,{label:`$${A}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":I(({row:v})=>[z(de,{"class-id":v.classId},{default:I(({isLoading:A})=>[A||!v.className?(u(),y(L,{key:0})):(u(),O("div",De,x(v.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])]),_:1})]),_:1})}}});export{xe as default};
