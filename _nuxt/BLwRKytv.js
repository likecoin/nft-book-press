import{e as E}from"./BHv8MdEE.js";import{f4 as h,f5 as y,dE as p,f6 as m,e5 as g,f7 as L,f8 as O,f9 as x,fa as w,fb as M}from"./WyIghNlr.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="da43ff6d-a8a7-4a90-bb23-65f8783f1d2d",e._sentryDebugIdIdentifier="sentry-dbid-da43ff6d-a8a7-4a90-bb23-65f8783f1d2d")}catch{}})();function R(e,a){if(!h(e,{strict:!1}))throw new y({address:e});if(!h(a,{strict:!1}))throw new y({address:a});return e.toLowerCase()===a.toLowerCase()}class D extends p{constructor({callbackSelector:a,cause:s,data:o,extraData:d,sender:f,urls:r}){var c;super(s.shortMessage||"An error occurred while fetching for an offchain result.",{cause:s,metaMessages:[...s.metaMessages||[],(c=s.metaMessages)!=null&&c.length?"":[],"Offchain Gateway Call:",r&&["  Gateway URL(s):",...r.map(i=>`    ${m(i)}`)],`  Sender: ${f}`,`  Data: ${o}`,`  Callback selector: ${a}`,`  Extra data: ${d}`].flat(),name:"OffchainLookupError"})}}class S extends p{constructor({result:a,url:s}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${m(s)}`,`Response: ${g(a)}`],name:"OffchainLookupResponseMalformedError"})}}class $ extends p{constructor({sender:a,to:s}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${s}`,`OffchainLookup sender address: ${a}`],name:"OffchainLookupSenderMismatchError"})}}const q="0x556f1830",C={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function _(e,{blockNumber:a,blockTag:s,data:o,to:d}){const{args:f}=L({data:o,abi:[C]}),[r,c,i,u,n]=f,{ccipRead:t}=e,b=t&&typeof(t==null?void 0:t.request)=="function"?t.request:A;try{if(!R(d,r))throw new $({sender:r,to:d});const l=await b({data:i,sender:r,urls:c}),{data:k}=await E(e,{blockNumber:a,blockTag:s,data:O([u,x([{type:"bytes"},{type:"bytes"}],[l,n])]),to:d});return k}catch(l){throw new D({callbackSelector:u,cause:l,data:o,extraData:n,sender:r,urls:c})}}async function A({data:e,sender:a,urls:s}){var d;let o=new Error("An unknown error occurred.");for(let f=0;f<s.length;f++){const r=s[f],c=r.includes("{data}")?"GET":"POST",i=c==="POST"?{data:e,sender:a}:void 0,u=c==="POST"?{"Content-Type":"application/json"}:{};try{const n=await fetch(r.replace("{sender}",a.toLowerCase()).replace("{data}",e),{body:JSON.stringify(i),headers:u,method:c});let t;if((d=n.headers.get("Content-Type"))!=null&&d.startsWith("application/json")?t=(await n.json()).data:t=await n.text(),!n.ok){o=new w({body:i,details:t!=null&&t.error?g(t.error):n.statusText,headers:n.headers,status:n.status,url:r});continue}if(!M(t)){o=new S({result:t,url:r});continue}return t}catch(n){o=new w({body:i,details:n.message,url:r})}}throw o}export{A as ccipRequest,_ as offchainLookup,C as offchainLookupAbiItem,q as offchainLookupSignature};
//# sourceMappingURL=BLwRKytv.js.map
