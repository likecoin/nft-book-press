{"version":3,"file":"m6LNRSHE.js","sources":["../../../../stores/stripe.ts"],"sourcesContent":["import { defineStore, storeToRefs } from 'pinia'\n\nimport { useBookStoreApiStore } from '~/stores/book-store-api'\n\ninterface StripeConnectStatus {\n  hasAccount: boolean\n  isReady: boolean\n  email?: string\n  stripeConnectAccountId?: string\n}\n\nfunction getStripeConnectStatusDefault (): StripeConnectStatus {\n  return {\n    isReady: false,\n    hasAccount: false,\n    email: '',\n    stripeConnectAccountId: ''\n  }\n}\n\nexport const useStripeStore = defineStore('stripe-connect', () => {\n  const { LIKE_CO_API } = useRuntimeConfig().public\n\n  const bookStoreApiStore = useBookStoreApiStore()\n  const { token } = storeToRefs(bookStoreApiStore)\n\n  const stripeConnectStatusWalletMap = ref({} as Record<string, StripeConnectStatus>)\n\n  const getStripeConnectStatusByWallet = computed(() => (wallet: string) => {\n    return stripeConnectStatusWalletMap.value[wallet] || getStripeConnectStatusDefault()\n  })\n\n  async function fetchStripeConnectStatusByWallet (wallet: string) {\n    if (!stripeConnectStatusWalletMap.value[wallet]) {\n      stripeConnectStatusWalletMap.value[wallet] = getStripeConnectStatusDefault()\n    }\n    const data = await $fetch<StripeConnectStatus>(`${LIKE_CO_API}/likernft/book/user/connect/status`, {\n      headers: {\n        authorization: `Bearer ${token.value}`\n      },\n      query: {\n        wallet\n      }\n    })\n    if (!data) {\n      return stripeConnectStatusWalletMap.value[wallet]\n    }\n    stripeConnectStatusWalletMap.value[wallet] = data\n    return data\n  }\n\n  return {\n    stripeConnectStatusWalletMap,\n    getStripeConnectStatusByWallet,\n    fetchStripeConnectStatusByWallet\n  }\n})\n"],"names":["getStripeConnectStatusDefault","useStripeStore","defineStore","LIKE_CO_API","useRuntimeConfig","bookStoreApiStore","useBookStoreApiStore","token","storeToRefs","stripeConnectStatusWalletMap","ref","getStripeConnectStatusByWallet","computed","wallet","fetchStripeConnectStatusByWallet","data"],"mappings":"6XAWA,SAASA,GAAsD,CACtD,MAAA,CACL,QAAS,GACT,WAAY,GACZ,MAAO,GACP,uBAAwB,EAC1B,CACF,CAEa,MAAAC,EAAiBC,EAAY,iBAAkB,IAAM,CAChE,KAAM,CAAE,YAAAC,CAAA,EAAgBC,EAAA,EAAmB,OAErCC,EAAoBC,EAAqB,EACzC,CAAE,MAAAC,CAAA,EAAUC,EAAYH,CAAiB,EAEzCI,EAA+BC,EAAI,EAAyC,EAE5EC,EAAiCC,EAAS,IAAOC,GAC9CJ,EAA6B,MAAMI,CAAM,GAAKb,EAA8B,CACpF,EAED,eAAec,EAAkCD,EAAgB,CAC1DJ,EAA6B,MAAMI,CAAM,IACfJ,EAAA,MAAMI,CAAM,EAAIb,EAA8B,GAE7E,MAAMe,EAAO,MAAM,OAA4B,GAAGZ,CAAW,qCAAsC,CACjG,QAAS,CACP,cAAe,UAAUI,EAAM,KAAK,EACtC,EACA,MAAO,CACL,OAAAM,CAAA,CACF,CACD,EACD,OAAKE,GAGwBN,EAAA,MAAMI,CAAM,EAAIE,EACtCA,GAHEN,EAA6B,MAAMI,CAAM,CAG3C,CAGF,MAAA,CACL,6BAAAJ,EACA,+BAAAE,EACA,iCAAAG,CACF,CACF,CAAC"}