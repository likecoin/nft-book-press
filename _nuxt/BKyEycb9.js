import{a_ as P,b7 as D,a$ as L,bx as V,b8 as x,b9 as C,bb as j,b1 as z,ba as y,b3 as _,aX as p,aT as d,bi as f,b4 as t,bj as G,bB as W,aU as k,aS as K,aW as v,aV as T,br as M}from"./DJ8NSVhq.js";import{_ as X}from"./CMnkHwgU.js";import{_ as q}from"./U9SrZ7_f.js";import{u as F}from"./Cz5XNnMo.js";import"./DtO3XRyl.js";import"./DRd2XnLE.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c=new r.Error().stack;c&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[c]="d2896786-605b-4e1e-ad9e-794f21d1e91d",r._sentryDebugIdIdentifier="sentry-dbid-d2896786-605b-4e1e-ad9e-794f21d1e91d")}catch{}})();const H={class:"text-center font-bold font-mono"},J={class:"flex justify-center items-center gap-4"},Q=["textContent"],ae=P({__name:"index",setup(r){const{LIKE_CO_API:c}=D().public,{t:s}=L(),g=V(),b=F(),{token:S,wallet:m}=x(g),{getStripeConnectStatusByWallet:A}=x(b),a=C(""),n=C(!1);j(n,e=>{e&&(a.value="")}),z(async()=>{await b.refreshStripeConnectStatus(m.value)});const i=y(()=>A.value(m.value)),l=y(()=>{var e;return(e=i.value)==null?void 0:e.isReady}),B=y(()=>{var e,o,u;if(!((e=i.value)!=null&&e.hasAccount)&&!l.value)return s("user_settings.setup_stripe_connect");if((o=i.value)!=null&&o.hasAccount&&!l.value)return s("user_settings.resume_stripe_connect_setup");if((u=i.value)!=null&&u.hasAccount&&l.value)return s("user_settings.login_to_stripe")});async function E(){try{n.value=!0,await b.refreshStripeConnectStatus(m.value)}catch(e){a.value=e.toString()}finally{n.value=!1}}async function N(){try{n.value=!0;const o=(await $fetch(`${c}/likernft/book/user/connect/login`,{method:"POST",headers:{authorization:`Bearer ${S.value}`}})).url;if(o)window.open(o);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString()}finally{n.value=!1}}async function $(){try{n.value=!0;const o=(await $fetch(`${c}/likernft/book/user/connect/new`,{method:"POST",headers:{authorization:`Bearer ${S.value}`}})).url;if(o)window.open(o);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString()}finally{n.value=!1}}async function I(){n.value=!0;try{l.value?await N():await $()}catch(e){console.error(e),a.value=e.toString()}finally{n.value=!1}}return(e,o)=>{const u=G,w=M,R=X,O=W,U=q;return d(),_(U,null,{default:p(()=>[t(a)?(d(),_(u,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${t(a)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:o[0]||(o[0]=h=>a.value="")},null,8,["title"])):f("",!0),t(l)?f("",!0):(d(),_(u,{key:1,icon:"i-heroicons-exclamation-circle",color:"orange",variant:"soft",title:t(s)("user_settings.stripe_express_notice"),description:t(s)("user_settings.stripe_express_description")},null,8,["title","description"])),t(g).isAuthenticated?(d(),_(O,{key:2,ui:{header:{base:"flex justify-between items-center"},body:{padding:""},footer:{base:"text-center"}}},{header:p(()=>[k("h1",H,T(t(s)("user_settings.stripe_payout_status")),1),v(R,{text:"Refresh Status",popper:{placement:"left"}},{default:p(()=>[v(w,{icon:"i-heroicons-arrow-path",variant:"outline",disabled:t(n),onClick:E},null,8,["disabled"])]),_:1})]),footer:p(()=>{var h;return[k("div",J,[(h=t(i))!=null&&h.hasAccount&&t(l)?(d(),K("span",{key:0,class:"text-sm text-gray-500",textContent:T(t(i).email)},null,8,Q)):f("",!0),v(w,{label:t(B),size:"md",loading:t(n),disabled:t(n),color:"black",onClick:I},null,8,["label","loading","disabled"])])]}),_:1})):f("",!0)]),_:1})}}});export{ae as default};
