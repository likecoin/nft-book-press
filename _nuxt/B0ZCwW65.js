import{bI as ee,bJ as E,bK as be,aQ as me,a_ as K,aS as M,aT as d,bL as S,b3 as g,br as F,bM as V,bi as te,bj as ae,bg as se,bN as ve,bO as H,b9 as m,b8 as $,b1 as oe,b4 as l,bm as ge,b0 as ye,a$ as he,bk as ke,bn as Be,ba as J,aX as I,b2 as Z,aW as _,bs as Ce,bP as we,aY as Ie,bt as Pe,bf as D,aV as x,aU as q,bQ as Le}from"./CpgQQs4L.js";import{_ as Ne}from"./CSg-u3-0.js";import{u as ne}from"./BUPYE4wI.js";import{_ as ze}from"./vOOMTt3H.js";import{_ as $e}from"./DyvWIr8z.js";import{_ as Fe}from"./CPCnANDo.js";import"./DOm_rr3I.js";import"./CqXj1RE2.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},h=new e.Error().stack;h&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[h]="6906f40a-9627-44eb-8e1d-aa9e31a1a266",e._sentryDebugIdIdentifier="sentry-dbid-6906f40a-9627-44eb-8e1d-aa9e31a1a266")}catch{}})();const Oe={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},N=ee(E.ui.strategy,E.ui.pagination,Oe),Ue=ee(E.ui.strategy,E.ui.button,be),Ve=K({components:{UButton:se},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>N.default.size,validator(e){return Object.keys(Ue.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>N.default.activeButton},inactiveButton:{type:Object,default:()=>N.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>N.default.firstButton},lastButton:{type:Object,default:()=>N.default.lastButton},prevButton:{type:Object,default:()=>N.default.prevButton},nextButton:{type:Object,default:()=>N.default.nextButton},divider:{type:String,default:"â€¦"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:h}){const{ui:P,attrs:i}=ve("pagination",H(e,"ui"),N,H(e,"class")),r=m({get(){return e.modelValue},set(n){h("update:modelValue",n)}}),k=m(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(n,u)=>u+1)),y=m(()=>{const n=k.value.length,u=r.value,B=Math.max(e.max,5),c=Math.floor((Math.min(B,n)-5)/2),C=u-c,f=u+c,T=C-1>1,j=f+1<n,t=[];if(n<=B){for(let p=1;p<=n;p++)t.push(p);return t}if(t.push(1),T&&t.push(e.divider),!j){const p=u+c+2-n;for(let w=u-c-p;w<=u-c-1;w++)t.push(w)}for(let p=Math.max(2,C);p<=Math.min(n,f);p++)t.push(p);if(!T){const p=1-(u-c-2);for(let w=u+c+1;w<=u+c+p;w++)t.push(w)}return j&&t.push(e.divider),f<n&&t.push(n),t.length>=3&&t[1]===e.divider&&t[2]===3&&(t[1]=2),t.length>=3&&t[t.length-2]===e.divider&&t[t.length-1]===t.length&&(t[t.length-2]=t.length-1),t}),a=m(()=>r.value>1),z=m(()=>r.value<k.value.length);function O(){a.value&&(r.value=1)}function W(){z.value&&(r.value=k.value.length)}function Q(n){typeof n!="string"&&(r.value=n)}function U(){a.value&&r.value--}function G(){z.value&&r.value++}return{ui:P,attrs:i,currentPage:r,pages:k,displayedPages:y,canGoLastOrNext:z,canGoFirstOrPrev:a,onClickPrev:U,onClickNext:G,onClickPage:Q,onClickFirst:O,onClickLast:W}}});function _e(e,h,P,i,r,k){const y=se;return d(),M("div",V({class:e.ui.wrapper},e.attrs),[S(e.$slots,"first",{onClick:e.onClickFirst,canGoFirst:e.canGoFirstOrPrev},()=>{var a;return[e.firstButton&&e.showFirst?(d(),g(y,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),S(e.$slots,"prev",{onClick:e.onClickPrev,canGoPrev:e.canGoFirstOrPrev},()=>{var a;return[e.prevButton?(d(),g(y,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage-1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),(d(!0),M(te,null,ae(e.displayedPages,(a,z)=>{var O;return d(),g(y,V({key:`${a}-${z}`,to:typeof a=="number"?(O=e.to)==null?void 0:O.call(e,a):null,size:e.size,disabled:e.disabled,label:`${a}`},{ref_for:!0},a===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof a=="string","z-[1]":a===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(a)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),S(e.$slots,"next",{onClick:e.onClickNext,canGoNext:e.canGoLastOrNext},()=>{var a;return[e.nextButton?(d(),g(y,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage+1),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]}),S(e.$slots,"last",{onClick:e.onClickLast,canGoLast:e.canGoLastOrNext},()=>{var a;return[e.lastButton&&e.showLast?(d(),g(y,V({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.pages.length),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","to","disabled","class","onClick"])):F("",!0)]})],16)}const Se=me(Ve,[["render",_e]]),Me=K({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(e){const h=ne(),P=e,i=$(!1);return oe(async()=>{try{i.value=!0,await h.lazyFetchClassMetadataById(P.classId)}catch{}finally{i.value=!1}}),(r,k)=>S(r.$slots,"default",{isLoading:l(i)})}}),Ge={class:"flex justify-between items-center w-full"},Te={class:"flex gap-2 items-center"},je={class:"text-sm leading-5"},Re={class:"flex gap-1"},Ae={key:1,class:"max-w-xs truncate"},Ye=K({__name:"index",setup(e){const h=ge(),P=ye(),{t:i}=he(),r=ke(),k=ne(),{listingList:y,moderatedBookList:a,token:z}=Be(r),{lazyFetchClassMetadataById:O}=k,{fetchBookListing:W,fetchModeratedBookList:Q}=r,U=$(""),G=$(!1),n=m(()=>[{label:i("bookstore.current_listing"),key:"current"},{label:i("bookstore.viewable_listing"),key:"viewable"}]),u=m({get(){const s=n.value.findIndex(o=>o.key===h.query.tab);return s===-1?0:s},set(s){Z(P({query:{tab:n.value[s].key}}),{replace:!0})}}),B=$(""),c=$({column:"pendingAction",direction:"desc"}),C=$(50),f=$(1),T=m(()=>(f.value-1)*C.value+1),j=m(()=>Math.min(f.value*C.value,t.value.length)),t=m(()=>(n.value[u.value].key==="viewable"?a:y).value.map(s=>{var o,b,L;return{classId:s.classId,className:(o=k.getClassMetadataById(s.classId))==null?void 0:o.name,priceInUSD:(b=s.prices)==null?void 0:b[0].price,prices:(L=s.prices)==null?void 0:L.map(X=>X.price),pendingAction:s.pendingNFTCount,sold:s.sold}}).filter(s=>{if(!B.value)return!0;const o=B.value.toLowerCase();return s.classId.toLowerCase().includes(o)||s.className.toLowerCase().includes(o)})),p=m(()=>{const{column:s,direction:o}=c.value;return t.value.sort((b,L)=>b[s]<L[s]?o==="asc"?-1:1:b[s]>L[s]?o==="asc"?1:-1:0)}),w=m(()=>p.value.slice((f.value-1)*C.value,f.value*C.value)),le=m(()=>[{key:"pendingAction",label:i("table.pending_action"),sortable:!0},{key:"className",label:i("table.class_name"),sortable:!0},{key:"priceInUSD",label:i("table.price_in_usd"),sortable:!0},{key:"sold",label:i("table.sold"),sortable:!0},{key:"classId",label:i("bookstore.class_id"),sortable:!0,class:"font-mono"}]);J(G,s=>{s&&(U.value="")}),J(u,()=>{B.value="",f.value=1}),J(C,()=>{f.value=1}),oe(async()=>{const s=[W()];z.value&&s.push(Q()),await Promise.all(s),new Set(y.value.map(b=>b.classId).concat(a.value.map(b=>b.classId))).forEach(b=>O(b))});async function ie(s){await Z(P({name:"my-books-status-classId",params:{classId:s.classId}}))}return(s,o)=>{const b=Ce,L=we,X=Se,re=Ne,ue=Le,de=Me,ce=ze,Y=Pe,fe=$e,pe=Fe;return d(),g(pe,{ui:{constrained:""}},{default:I(()=>[l(U)?(d(),g(b,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${l(U)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:o[0]||(o[0]=R=>U.value="")},null,8,["title"])):F("",!0),l(G)?(d(),g(L,{key:1,animation:"carousel"},{indicator:I(()=>o[5]||(o[5]=[Ie(" Loading... ")])),_:1})):F("",!0),_(Y,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{default:I(()=>[l(r).isAuthenticated?(d(),g(fe,{key:0,modelValue:l(u),"onUpdate:modelValue":o[4]||(o[4]=R=>D(u)?u.value=R:null),class:"w-full",items:l(n)},{item:I(({item:R})=>[(d(),g(Y,{key:R.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:I(()=>[q("div",Ge,[q("div",Te,[_(X,{modelValue:l(f),"onUpdate:modelValue":o[1]||(o[1]=v=>D(f)?f.value=v:null),"page-count":l(C),total:l(t).length},null,8,["modelValue","page-count","total"]),q("span",je,x(l(i)("table.showing_rows",{from:l(T),to:l(j),total:l(t).length})),1)]),_(re,{modelValue:l(B),"onUpdate:modelValue":o[2]||(o[2]=v=>D(B)?B.value=v:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:l(i)("table.search_placeholder")},null,8,["modelValue","placeholder"])])]),default:I(()=>[_(ce,{sort:l(c),"onUpdate:sort":o[3]||(o[3]=v=>D(c)?c.value=v:null),columns:l(le),rows:l(w),onSelect:ie},{"priceInUSD-data":I(({row:v})=>[q("ul",Re,[(d(!0),M(te,null,ae(v.prices,A=>(d(),M("li",{key:A},[_(ue,{label:`$${A}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":I(({row:v})=>[_(de,{"class-id":v.classId},{default:I(({isLoading:A})=>[A||!v.className?(d(),g(L,{key:0})):(d(),M("div",Ae,x(v.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])):F("",!0)]),_:1})]),_:1})}}});export{Ye as default};
