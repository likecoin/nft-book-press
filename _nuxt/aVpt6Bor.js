import{bT as ae,bU as Y,bV as he,aQ as ke,a_ as K,aS as D,aT as f,bW as A,b3 as w,br as $,bX as S,bi as se,bj as ne,bg as x,bY as we,bZ as te,b9 as v,b8 as U,b1 as le,b4 as o,bm as Be,b0 as Ce,a$ as _e,bk as Ie,bn as Pe,ba as J,aX as h,b2 as oe,aW as k,bs as Le,bO as Ne,aY as ze,bt as Ue,bf as M,aU as C,aV as R,b_ as Ve}from"./BC5wLd9d.js";import{_ as $e}from"./C4DEQvJV.js";import{_ as Oe}from"./C-rD4RFJ.js";import{_ as Fe}from"./Bc1gobyi.js";import{u as ie}from"./Bv7EhMg2.js";import{_ as Se}from"./Bg6FkBkU.js";import{_ as Me}from"./BO7YLRKn.js";import{_ as Te}from"./DhNDZdWI.js";import"./B2XmGqJU.js";import"./BhpNCqcT.js";import"./BAl3pfog.js";import"./GGP8coJz.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_=new e.Error().stack;_&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[_]="5fcb9c89-2ac1-48b8-8c46-04e5efea61b0",e._sentryDebugIdIdentifier="sentry-dbid-5fcb9c89-2ac1-48b8-8c46-04e5efea61b0")}catch{}})();const je={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},z=ae(Y.ui.strategy,Y.ui.pagination,je),Ge=ae(Y.ui.strategy,Y.ui.button,he),Re=K({components:{UButton:x},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>z.default.size,validator(e){return Object.keys(Ge.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>z.default.activeButton},inactiveButton:{type:Object,default:()=>z.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>z.default.firstButton},lastButton:{type:Object,default:()=>z.default.lastButton},prevButton:{type:Object,default:()=>z.default.prevButton},nextButton:{type:Object,default:()=>z.default.nextButton},divider:{type:String,default:"â€¦"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:_}){const{ui:I,attrs:l}=we("pagination",te(e,"ui"),z,te(e,"class")),r=v({get(){return e.modelValue},set(i){_("update:modelValue",i)}}),P=v(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(i,u)=>u+1)),B=v(()=>{const i=P.value.length,u=r.value,y=Math.max(e.max,5),p=Math.floor((Math.min(y,i)-5)/2),T=u-p,m=u+p,g=T-1>1,E=m+1<i,n=[];if(i<=y){for(let d=1;d<=i;d++)n.push(d);return n}if(n.push(1),g&&n.push(e.divider),!E){const d=u+p+2-i;for(let L=u-p-d;L<=u-p-1;L++)n.push(L)}for(let d=Math.max(2,T);d<=Math.min(i,m);d++)n.push(d);if(!g){const d=1-(u-p-2);for(let L=u+p+1;L<=u+p+d;L++)n.push(L)}return E&&n.push(e.divider),m<i&&n.push(i),n.length>=3&&n[1]===e.divider&&n[2]===3&&(n[1]=2),n.length>=3&&n[n.length-2]===e.divider&&n[n.length-1]===n.length&&(n[n.length-2]=n.length-1),n}),a=v(()=>r.value>1),V=v(()=>r.value<P.value.length);function O(){a.value&&(r.value=1)}function Q(){V.value&&(r.value=P.value.length)}function Z(i){typeof i!="string"&&(r.value=i)}function F(){a.value&&r.value--}function q(){V.value&&r.value++}return{ui:I,attrs:l,currentPage:r,pages:P,displayedPages:B,canGoLastOrNext:V,canGoFirstOrPrev:a,onClickPrev:F,onClickNext:q,onClickPage:Z,onClickFirst:O,onClickLast:Q}}});function Ae(e,_,I,l,r,P){const B=x;return f(),D("div",S({class:e.ui.wrapper},e.attrs),[A(e.$slots,"first",{onClick:e.onClickFirst,canGoFirst:e.canGoFirstOrPrev},()=>{var a;return[e.firstButton&&e.showFirst?(f(),w(B,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]}),A(e.$slots,"prev",{onClick:e.onClickPrev,canGoPrev:e.canGoFirstOrPrev},()=>{var a;return[e.prevButton?(f(),w(B,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage-1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]}),(f(!0),D(se,null,ne(e.displayedPages,(a,V)=>{var O;return f(),w(B,S({key:`${a}-${V}`,to:typeof a=="number"?(O=e.to)==null?void 0:O.call(e,a):null,size:e.size,disabled:e.disabled,label:`${a}`},{ref_for:!0},a===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof a=="string","z-[1]":a===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(a)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),A(e.$slots,"next",{onClick:e.onClickNext,canGoNext:e.canGoLastOrNext},()=>{var a;return[e.nextButton?(f(),w(B,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.currentPage+1),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]}),A(e.$slots,"last",{onClick:e.onClickLast,canGoLast:e.canGoLastOrNext},()=>{var a;return[e.lastButton&&e.showLast?(f(),w(B,S({key:0,size:e.size,to:(a=e.to)==null?void 0:a.call(e,e.pages.length),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","to","disabled","class","onClick"])):$("",!0)]})],16)}const De=ke(Re,[["render",Ae]]),qe=K({__name:"NFTClassMetadataLoader",props:{classId:{type:String,required:!0}},setup(e){const _=ie(),I=e,l=U(!1);return le(async()=>{try{l.value=!0,await _.lazyFetchClassMetadataById(I.classId)}catch{}finally{l.value=!1}}),(r,P)=>A(r.$slots,"default",{isLoading:o(l)})}}),Ee={class:"text-xl font-bold font-mono"},We={class:"font-bold font-mono"},Xe={class:"flex justify-between items-center w-full px-4 py-3"},Ye={class:"flex items-center gap-1.5"},Qe={class:"text-sm"},Ze={class:"flex gap-1.5 items-center"},He={class:"flex flex-wrap justify-between items-center w-full px-4 py-3"},Je={class:"text-sm leading-5"},Ke={class:"flex gap-1"},xe={key:1,class:"max-w-xs truncate"},ft=K({__name:"index",setup(e){const _=Be(),I=Ce(),{t:l}=_e(),r=Ie(),P=ie(),{listingList:B,moderatedBookList:a,token:V}=Pe(r),{lazyFetchClassMetadataById:O}=P,{fetchBookListing:Q,fetchModeratedBookList:Z}=r,F=U(""),q=U(!1),i=v(()=>[{label:l("bookstore.current_listing"),key:"current"},{label:l("bookstore.viewable_listing"),key:"viewable"}]),u=v({get(){const s=i.value.findIndex(t=>t.key===_.query.tab);return s===-1?0:s},set(s){oe(I({query:{tab:i.value[s].key}}),{replace:!0})}}),y=U(""),p=U({column:"pendingAction",direction:"desc"}),T=[5,10,20,50],m=U(T[1]),g=U(1),E=v(()=>(g.value-1)*m.value+1),n=v(()=>Math.min(g.value*m.value,d.value.length)),d=v(()=>(i.value[u.value].key==="viewable"?a:B).value.map(s=>{var t,b,N;return{classId:s.classId,className:(t=P.getClassMetadataById(s.classId))==null?void 0:t.name,priceInUSD:(b=s.prices)==null?void 0:b[0].price,prices:(N=s.prices)==null?void 0:N.map(j=>j.price),pendingAction:s.pendingNFTCount,sold:s.sold}}).filter(s=>{if(!y.value)return!0;const t=y.value.toLowerCase();return s.classId.toLowerCase().includes(t)||s.className.toLowerCase().includes(t)})),L=v(()=>{const{column:s,direction:t}=p.value;return d.value.sort((b,N)=>b[s]<N[s]?t==="asc"?-1:1:b[s]>N[s]?t==="asc"?1:-1:0)}),re=v(()=>L.value.slice((g.value-1)*m.value,g.value*m.value)),H=v(()=>[{key:"classId",label:l("bookstore.class_id"),sortable:!0,class:"font-mono"},{key:"className",label:l("table.class_name"),sortable:!0},{key:"priceInUSD",label:l("table.price_in_usd"),sortable:!0},{key:"pendingAction",label:l("table.pending_action"),sortable:!0},{key:"sold",label:l("table.sold"),sortable:!0}]),W=U(H.value.slice(1,H.value.length));J(q,s=>{s&&(F.value="")}),J(u,()=>{y.value="",g.value=1}),J(m,()=>{g.value=1}),le(async()=>{const s=[Q()];V.value&&s.push(Z()),await Promise.all(s),new Set(B.value.map(b=>b.classId).concat(a.value.map(b=>b.classId))).forEach(b=>O(b))});async function ue(s){await oe(I({name:"nft-book-store-status-classId",params:{classId:s.classId}}))}return(s,t)=>{const b=Le,N=Ne,j=x,de=$e,ce=Oe,fe=Fe,pe=De,me=Ve,be=qe,ve=Se,ee=Ue,ge=Me,ye=Te;return f(),w(ye,{ui:{constrained:""}},{default:h(()=>[o(F)?(f(),w(b,{key:0,class:"mt-4",icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${o(F)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:t[0]||(t[0]=G=>F.value="")},null,8,["title"])):$("",!0),o(q)?(f(),w(N,{key:1,animation:"carousel"},{indicator:h(()=>t[8]||(t[8]=[ze(" Loading... ")])),_:1})):$("",!0),k(ee,{ui:{header:{base:"flex justify-between items-center gap-4"}}},{header:h(()=>[C("h2",Ee,R(o(l)("bookstore.liker_land_listing")),1),k(j,{icon:"i-heroicons-plus-circle",label:o(l)("bookstore.new_listing"),to:o(I)({name:"nft-book-store-new"})},null,8,["label","to"])]),default:h(()=>[o(r).isAuthenticated?(f(),w(ge,{key:0,modelValue:o(u),"onUpdate:modelValue":t[7]||(t[7]=G=>M(u)?u.value=G:null),class:"w-full",items:o(i)},{item:h(({item:G})=>[(f(),w(ee,{key:G.key,ui:{header:{base:"flex justify-between items-center gap-4"},body:{base:"divide-y divide-gray-200 dark:divide-gray-700",padding:""}}},{header:h(()=>[C("h2",We,R(G.label),1),k(de,{modelValue:o(y),"onUpdate:modelValue":t[1]||(t[1]=c=>M(y)?y.value=c:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:o(l)("table.search_placeholder")},null,8,["modelValue","placeholder"])]),default:h(()=>[C("div",Xe,[C("div",Ye,[C("span",Qe,R(o(l)("table.rows_per_page")),1),k(ce,{modelValue:o(m),"onUpdate:modelValue":t[2]||(t[2]=c=>M(m)?m.value=c:null),options:T,class:"me-2 w-20",size:"xs"},null,8,["modelValue"])]),C("div",Ze,[k(fe,{modelValue:o(W),"onUpdate:modelValue":t[3]||(t[3]=c=>M(W)?W.value=c:null),options:o(H),multiple:""},{default:h(()=>[k(j,{class:"min-w-[180px]",label:o(l)("table.columns"),icon:"i-heroicons-view-columns",color:"gray",size:"xs"},null,8,["label"])]),_:1},8,["modelValue","options"]),k(j,{icon:"i-heroicons-funnel",label:o(l)("table.reset"),color:"gray",size:"xs",disabled:!o(y),onClick:t[4]||(t[4]=c=>y.value="")},null,8,["label","disabled"])])]),C("div",He,[C("div",null,[C("span",Je,R(o(l)("table.showing_rows",{from:o(E),to:o(n),total:o(d).length})),1)]),k(pe,{modelValue:o(g),"onUpdate:modelValue":t[5]||(t[5]=c=>M(g)?g.value=c:null),"page-count":o(m),total:o(d).length},null,8,["modelValue","page-count","total"])]),k(ve,{sort:o(p),"onUpdate:sort":t[6]||(t[6]=c=>M(p)?p.value=c:null),columns:o(W),rows:o(re),onSelect:ue},{"priceInUSD-data":h(({row:c})=>[C("ul",Ke,[(f(!0),D(se,null,ne(c.prices,X=>(f(),D("li",{key:X},[k(me,{label:`$${X}`,variant:"solid",size:"xs",color:"gray",ui:{rounded:"rounded-full"}},null,8,["label"])]))),128))])]),"className-data":h(({row:c})=>[k(be,{"class-id":c.classId},{default:h(({isLoading:X})=>[X||!c.className?(f(),w(N,{key:0})):(f(),D("div",xe,R(c.className),1))]),_:2},1032,["class-id"])]),_:1},8,["sort","columns","rows"])]),_:2},1024))]),_:1},8,["modelValue","items"])):$("",!0)]),_:1})]),_:1})}}});export{ft as default};
