const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./o87GXkOL.js","./DumGTjYM.js","./entry.Cs3_OI5c.css","./aSwfBVgJ.js","./CxGu1Oix.js","./Select.qOczc23w.css"])))=>i.map(i=>d[i]);
import{a_ as j,a$ as H,b7 as K,bt as W,b9 as d,ba as X,bb as S,bh as Y,b1 as J,bn as Z,bu as ee,b3 as U,aT as u,aX as v,aU as _,aW as l,aV as R,b4 as t,bv as te,bw as oe,bx as ne,bd as h,bq as ae,be as le,aS as y,bp as q,bo as O}from"./DumGTjYM.js";import{_ as se}from"./DPKmFKMY.js";import{g as re,a as ce,_ as ie,d as de,D as ue,b as _e,c as pe}from"./o87GXkOL.js";import{_ as fe}from"./W3ygKMn8.js";import{p as me}from"./CUxdmJDi.js";import"./aSwfBVgJ.js";import"./CxGu1Oix.js";(function(){try{var p=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new p.Error().stack;a&&(p._sentryDebugIds=p._sentryDebugIds||{},p._sentryDebugIds[a]="c2f95688-19b4-46b5-aaa7-ad774606c9a4",p._sentryDebugIdIdentifier="sentry-dbid-c2f95688-19b4-46b5-aaa7-ad774606c9a4")}catch{}})();const be={class:"text-lg font-bold font-mono print:hidden"},ge={class:"print:hidden flex justify-center"},ve={class:"font-bold font-mono"},he={class:"flex justify-center items-center gap-2 print:hidden"},ye={class:"flex flex-col items-center gap-[2cm] print:gap-0"},Ce={class:"text-xs text-center font-mono"},w="key,url",T=12,Ie=j({__name:"batch-qrcode",setup(p){const{t:a}=H(),{BOOK3_URL:D}=K().public,B=W(),s=d(""),V=`${w}
example01,https://example01.com
example02,https://example02.com`,f=d(ue),C=d(_e),x=d(pe),m=d(!1),E=d(void 0),c=d([]),$=X(()=>{const o=[];for(let e=0;e<c.value.length;e+=T)o.push(c.value.slice(e,e+T));return o});S(s,()=>{c.value=[]}),S(f,()=>{c.value=[]}),Y({title:"Batch Create Book QR Codes",ogTitle:"Batch Create Book QR Codes"}),J(()=>{try{const o=sessionStorage.getItem("nft_book_press_batch_qrcode");o&&(s.value=o,sessionStorage.removeItem("nft_book_press_batch_qrcode")),Z(()=>{s.value&&Q()})}catch(o){console.error(o)}});function I(){return{image:f.value==="none"?void 0:ce(f.value),fillColor:C.value,dotStyle:x.value}}async function Q(){try{let e=s.value;e.includes(w)||(e=`${w}
${e}`),c.value=me(e,{columns:!0,skip_empty_lines:!0})}catch(e){console.error(e),B.add({icon:"i-heroicons-exclamation-circle",title:a("batch_qrcode.parse_csv_error"),timeout:0,color:"red",ui:{title:"text-red-400 dark:text-red-400"}})}const{default:o}=await ee(async()=>{const{default:e}=await import("./o87GXkOL.js").then(i=>i.q);return{default:e}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);c.value.forEach((e,i)=>{const b=new o(re({margin:0,data:e.url,...I()})),r=E.value?.[i];r&&(r.querySelector("svg")?.remove(),b.append(r),r.querySelector("svg")?.setAttribute("viewBox","0 0 300 300"))})}function A(o){if(!o?.length)return;const e=o[0];if(!e)return;const i=new FileReader;i.onload=b=>{const r=b.target?.result;typeof r=="string"&&(s.value=r)},i.readAsText(e)}function F(){s.value&&window.print()}function L(){de(c.value.map(o=>({filename:o.key,url:o.url})),{qrCodeOptions:{...I(),margin:40,width:1024,height:1024}})}return(o,e)=>{const i=te,b=oe,r=ne,P=se,g=ae,z=ie,M=le,G=fe;return u(),U(G,{class:"print:space-y-0 print:p-0"},{default:v(()=>[_("h1",be,R(t(a)("batch_qrcode.page_title")),1),l(b,{label:t(a)("batch_qrcode.upload_csv"),class:"print:hidden"},{default:v(()=>[l(i,{type:"file",accept:"csv",onChange:A})]),_:1},8,["label"]),l(r,{class:"print:hidden",label:t(a)("batch_qrcode.or_divider")},null,8,["label"]),l(b,{class:"print:hidden",label:t(a)("batch_qrcode.input_csv")},{default:v(()=>[l(P,{modelValue:t(s),"onUpdate:modelValue":e[0]||(e[0]=n=>h(s)?s.value=n:null),class:"font-mono",placeholder:V,resize:!0},null,8,["modelValue"])]),_:1},8,["label"]),_("div",ge,[l(g,{label:t(a)("batch_qrcode.qr_appearance"),variant:"outline",onClick:e[1]||(e[1]=n=>m.value=!0)},null,8,["label"])]),l(M,{modelValue:t(m),"onUpdate:modelValue":e[7]||(e[7]=n=>h(m)?m.value=n:null)},{default:v(()=>[l(z,{icon:t(f),"onUpdate:icon":e[3]||(e[3]=n=>h(f)?f.value=n:null),color:t(C),"onUpdate:color":e[4]||(e[4]=n=>h(C)?C.value=n:null),"dot-style":t(x),"onUpdate:dotStyle":e[5]||(e[5]=n=>h(x)?x.value=n:null),data:`${t(D)}/store`,width:500,height:500,mode:"config",onSave:e[6]||(e[6]=n=>m.value=!1)},{header:v(()=>[_("h3",ve,R(t(a)("batch_qrcode.qr_config")),1),l(g,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",onClick:e[2]||(e[2]=n=>m.value=!1)})]),_:1},8,["icon","color","dot-style","data"])]),_:1},8,["modelValue"]),_("nav",he,[t(c)?.length?(u(),y(q,{key:1},[l(g,{label:t(a)("batch_qrcode.print"),size:"lg",variant:"outline",onClick:F},null,8,["label"]),l(g,{label:t(a)("batch_qrcode.download"),size:"lg",variant:"outline",onClick:L},null,8,["label"])],64)):(u(),U(g,{key:0,label:t(a)("batch_qrcode.generate"),size:"lg",disabled:!t(s),onClick:Q},null,8,["label","disabled"]))]),_("div",ye,[(u(!0),y(q,null,O(t($),(n,N)=>(u(),y("ul",{key:N,class:"w-[20cm] grid grid-cols-3 items-center gap-[0.25cm] py-[0.5cm] break-before-page"},[(u(!0),y(q,null,O(n,k=>(u(),y("li",{key:k.key||k.url},[_("figure",{ref_for:!0,ref_key:"qrCodeRef",ref:E,class:"qrcode"},[_("figcaption",Ce,R(k.key||k.url),1)],512)]))),128))]))),128))])]),_:1})}}});export{Ie as default};
