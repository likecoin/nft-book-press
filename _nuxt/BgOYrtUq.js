import{a_ as D,b7 as P,a$ as L,bz as z,b8 as x,b9 as C,bb as V,b1 as j,ba as y,b3 as d,aX as f,aT as _,bi as p,b4 as t,bj as G,bD as W,aU as k,aS as K,aW as v,aV as T,br as M}from"./B-7B4l0H.js";import{_ as X}from"./-L8jsQb-.js";import{_ as q}from"./DBs9Y_4E.js";import{u as F}from"./CAYQDJ7O.js";import"./CtaZdrd4.js";import"./DcTDTBfk.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new r.Error().stack;l&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[l]="71393bab-ff04-4ba5-932f-7b1450c21171",r._sentryDebugIdIdentifier="sentry-dbid-71393bab-ff04-4ba5-932f-7b1450c21171")}catch{}})();const H={class:"text-center font-bold font-mono"},J={class:"flex justify-center items-center gap-4"},Q=["textContent"],ae=D({__name:"index",setup(r){const{LIKE_CO_API:l}=P().public,{t:s}=L(),g=z(),b=F(),{token:S,wallet:m}=x(g),{getStripeConnectStatusByWallet:A}=x(b),a=C(""),n=C(!1);V(n,e=>{e&&(a.value="")}),j(async()=>{await b.refreshStripeConnectStatus(m.value)});const i=y(()=>A.value(m.value)),c=y(()=>{var e;return(e=i.value)==null?void 0:e.isReady}),B=y(()=>{var e,o,u;if(!((e=i.value)!=null&&e.hasAccount)&&!c.value)return s("user_settings.setup_stripe_connect");if((o=i.value)!=null&&o.hasAccount&&!c.value)return s("user_settings.resume_stripe_connect_setup");if((u=i.value)!=null&&u.hasAccount&&c.value)return s("user_settings.login_to_stripe")});async function E(){try{n.value=!0,await b.refreshStripeConnectStatus(m.value)}catch(e){a.value=e.toString()}finally{n.value=!1}}async function N(){try{n.value=!0;const o=(await $fetch(`${l}/likernft/book/user/connect/login`,{method:"POST",headers:{authorization:`Bearer ${S.value}`}})).url;if(o)window.open(o);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString()}finally{n.value=!1}}async function $(){try{n.value=!0;const o=(await $fetch(`${l}/likernft/book/user/connect/new`,{method:"POST",headers:{authorization:`Bearer ${S.value}`}})).url;if(o)window.open(o);else throw new Error("CANNOT_GET_STRIPE_CONNECT_RUL")}catch(e){console.error(e),a.value=e.toString()}finally{n.value=!1}}async function I(){n.value=!0;try{c.value?await N():await $()}catch(e){console.error(e),a.value=e.toString()}finally{n.value=!1}}return(e,o)=>{const u=G,w=M,R=X,O=W,U=q;return _(),d(U,null,{default:f(()=>[t(a)?(_(),d(u,{key:0,icon:"i-heroicons-exclamation-triangle",color:"red",variant:"soft",title:`${t(a)}`,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"red",variant:"link",padded:!1},onClose:o[0]||(o[0]=h=>a.value="")},null,8,["title"])):p("",!0),t(c)?p("",!0):(_(),d(u,{key:1,icon:"i-heroicons-exclamation-circle",color:"orange",variant:"soft",title:t(s)("user_settings.stripe_express_notice"),description:t(s)("user_settings.stripe_express_description")},null,8,["title","description"])),t(g).isAuthenticated?(_(),d(O,{key:2,ui:{header:{base:"flex justify-between items-center"},body:{padding:""},footer:{base:"text-center"}}},{header:f(()=>[k("h1",H,T(t(s)("user_settings.stripe_payout_status")),1),v(R,{text:"Refresh Status",popper:{placement:"left"}},{default:f(()=>[v(w,{icon:"i-heroicons-arrow-path",variant:"outline",disabled:t(n),onClick:E},null,8,["disabled"])]),_:1})]),footer:f(()=>{var h;return[k("div",J,[(h=t(i))!=null&&h.hasAccount&&t(c)?(_(),K("span",{key:0,class:"text-sm text-gray-500",textContent:T(t(i).email)},null,8,Q)):p("",!0),v(w,{label:t(B),size:"md",loading:t(n),disabled:t(n),color:"black",onClick:I},null,8,["label","loading","disabled"])])]}),_:1})):p("",!0)]),_:1})}}});export{ae as default};
